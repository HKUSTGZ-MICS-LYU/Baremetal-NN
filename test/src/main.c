#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include "nn.h"

const float fc1_weight_data[150] = {0.3002157509326935, -0.1716018170118332, 0.2887745201587677, -0.11960187554359436, 0.019930899143218994, 0.10517990589141846, -0.13849614560604095, -0.2275184988975525, -0.02616220712661743, -0.2463778853416443, 0.03370043635368347, -0.10348716378211975, -0.30434131622314453, 0.1053352952003479, -0.07787053287029266, 0.2319948971271515, 0.023213237524032593, 0.11855918169021606, -0.04481005668640137, 0.29070982336997986, -0.10104875266551971, -0.2754552364349365, 0.19700506329536438, 0.20407447218894958, -0.3137390613555908, -0.14448092877864838, 0.11670655012130737, 0.03418877720832825, -0.16034993529319763, -0.20623493194580078, -0.04539114236831665, 0.2613837420940399, -0.08716540038585663, -0.06043002009391785, 0.21955665946006775, -0.1368296593427658, 0.16742560267448425, 0.1272430121898651, -0.22116726636886597, -0.30721423029899597, -0.15524707734584808, 0.30336084961891174, -0.05575418472290039, 0.07873466610908508, 0.1883912980556488, -0.30724623799324036, -0.2841796875, -0.22299212217330933, 0.13451316952705383, 0.14137130975723267, 0.15144670009613037, -0.3108389377593994, 0.24958398938179016, -0.16023340821266174, -0.19407565891742706, -0.0179995596408844, -0.09788492321968079, -0.051451146602630615, -0.09110137820243835, -0.11137758195400238, 0.22987565398216248, 0.06277847290039062, 0.05543088912963867, 0.21361663937568665, -0.250593900680542, -0.1284003108739853, -0.26679229736328125, 0.022502422332763672, -0.11372733116149902, 0.19534966349601746, 0.25271788239479065, -0.24024423956871033, -0.020471274852752686, 0.021038144826889038, 0.3097366392612457, -0.2545548677444458, -0.14420048892498016, -0.12561124563217163, -0.19840791821479797, -0.22320310771465302, -0.19106444716453552, 0.2828204333782196, -0.17458605766296387, -0.09251159429550171, -0.12697969377040863, 0.18754813075065613, -0.056879639625549316, -0.13519856333732605, 0.016883403062820435, 0.06317010521888733, -0.11508212983608246, 0.25786498188972473, -0.0007951557636260986, 0.1961219608783722, 0.22506526112556458, -0.13775700330734253, -0.1859748512506485, -0.062253087759017944, -0.236494243144989, 0.2645590603351593, 0.021056681871414185, 0.22759440541267395, 0.08212241530418396, 0.09109067916870117, -0.03053051233291626, 0.11800175905227661, -0.01864752173423767, -0.05580231547355652, 0.2523323595523834, 0.1695919930934906, -0.16305433213710785, -0.09477083384990692, 0.1788654923439026, -0.0490802526473999, -0.29862406849861145, 0.15410348773002625, 0.31427904963493347, -0.0279218852519989, -0.26886552572250366, -0.11080959439277649, 0.06690344214439392, 0.08836761116981506, -0.05778178572654724, -0.16978074610233307, -0.06673000752925873, 0.23166504502296448, 0.29077818989753723, -0.113112673163414, -0.05792078375816345, 0.267002671957016, 0.20522037148475647, 0.05451720952987671, -0.11690105497837067, -0.2597614526748657, 0.1961505115032196, 0.283420592546463, -0.013027548789978027, 0.07759863138198853, 0.0332566499710083, -0.14568644762039185, -0.03683176636695862, 0.2850574553012848, -0.30289778113365173, -0.19097860157489777, -0.16281141340732574, 0.09621286392211914, -0.03314891457557678, -0.018649667501449585, -0.2054666131734848, -0.31260308623313904};
const float fc1_bias_data[15] = {0.15360593795776367, -0.030596941709518433, 0.22259649634361267, -0.053015947341918945, -0.03951886296272278, -0.05234619975090027, -0.12683923542499542, -0.21943224966526031, -0.22814616560935974, -0.28288254141807556, -0.1349390596151352, 0.30265751481056213, -0.08887730538845062, 0.31184741854667664, -0.244392529129982};

const float fc2_weight_data[300] = {-0.12197043001651764, 0.0804978609085083, 0.1790056824684143, -0.0393124520778656, -0.09864267706871033, 0.21739718317985535, -0.17544050514698029, -0.08961018919944763, -0.19313597679138184, 0.16569164395332336, 0.08641040325164795, 0.24993416666984558, 0.20460382103919983, 0.18349003791809082, 0.05017468333244324, -0.21373328566551208, 0.040319472551345825, -0.180787593126297, 0.06199285387992859, -0.03482246398925781, -0.21013393998146057, 0.2090013027191162, 0.19838735461235046, -0.06839019060134888, 0.030026495456695557, -0.09558720886707306, 0.02388361096382141, -0.07656386494636536, -0.24073432385921478, -0.08743323385715485, -0.045342907309532166, 0.2509986460208893, -0.21515661478042603, 0.22537827491760254, 0.25736168026924133, -0.21513324975967407, 0.06104320287704468, -0.25457069277763367, -0.18364089727401733, -0.1788199543952942, 0.13947182893753052, -0.23227006196975708, 0.20533472299575806, 0.2250872254371643, -0.10685797035694122, 0.11842384934425354, -0.13239933550357819, -0.04438461363315582, -0.017776384949684143, -0.1966715157032013, 0.2523297369480133, -0.11484280228614807, 0.07452192902565002, 0.08696267008781433, 0.2467755377292633, 0.20850518345832825, -0.1932227462530136, 0.21668055653572083, -0.0644540935754776, 0.08802956342697144, 0.1349826157093048, 0.16457325220108032, 0.19828304648399353, 0.11328962445259094, 0.12689664959907532, -0.09928973019123077, 0.1958933174610138, 0.21857404708862305, -0.16841134428977966, -0.07859855890274048, 0.15060392022132874, -0.14697998762130737, 0.21651121973991394, 0.18298551440238953, -0.10005316138267517, 0.05018949508666992, 0.14330706000328064, -0.17401829361915588, -0.10553348064422607, 0.08753889799118042, -0.13385659456253052, -0.23967337608337402, -0.1349288821220398, -0.1932048499584198, -0.1339886486530304, 0.20928382873535156, -0.07440461218357086, -0.06900665163993835, 0.12764862179756165, -0.20793503522872925, 0.028678148984909058, 0.00721856951713562, 0.18492946028709412, 0.1582530438899994, -0.22845116257667542, -0.19255301356315613, 0.19308480620384216, -0.05710650980472565, -0.2515436112880707, 0.12878668308258057, 0.07416677474975586, 0.07283177971839905, -0.11764129996299744, 0.1839001476764679, 0.05813521146774292, -0.2178734689950943, 0.21171459555625916, -0.1842081993818283, -0.11319617927074432, -0.24580611288547516, 0.25162550806999207, -0.22562573850154877, 0.2287362813949585, -0.029628023505210876, 0.2580324113368988, -0.016312837600708008, -0.0047054290771484375, 0.15541517734527588, -0.041042640805244446, -0.02258644998073578, -0.1303485780954361, 0.05941593647003174, -0.21239514648914337, 0.0015499591827392578, 0.17118090391159058, -0.20532040297985077, 0.05749619007110596, -0.13547319173812866, 0.18202823400497437, 0.08320078253746033, 0.19545868039131165, 0.25126972794532776, -0.23608994483947754, -0.13134387135505676, 0.19054636359214783, -0.13941356539726257, 0.2227431833744049, 0.12685027718544006, -0.2367246299982071, -0.20185931026935577, -0.1535431444644928, 0.07101055979728699, 0.067035973072052, 0.22266611456871033, 0.2261500358581543, -0.15565559267997742, -0.03280934691429138, 0.047561705112457275, -0.09394402801990509, -0.1250714212656021, -0.2564825713634491, -0.19521492719650269, 0.05654987692832947, 0.2090652585029602, -0.14678047597408295, -0.12340575456619263, 0.15079236030578613, 0.10973632335662842, -0.14294467866420746, -0.028716444969177246, -0.23815400898456573, 0.24459001421928406, 0.05683541297912598, 0.01727244257926941, 0.054131537675857544, 0.1690351665019989, -0.0329764187335968, -0.04554946720600128, 0.07669451832771301, -0.031700700521469116, 0.0042382776737213135, -0.1590602844953537, -0.2319098711013794, -0.16800609230995178, 0.00027257204055786133, 0.06702819466590881, -0.23048576712608337, 0.23419097065925598, 0.08375027775764465, 0.2009984254837036, -0.1299261897802353, 0.11597386002540588, 0.21068602800369263, -0.1641848385334015, 0.15187066793441772, -0.23395460844039917, 0.1768551468849182, -0.10561074316501617, -0.13266794383525848, 0.23010507225990295, 0.16659677028656006, 0.12307363748550415, -0.03588326275348663, -0.07063695788383484, -0.21745607256889343, -0.16200309991836548, 0.04884570837020874, -0.029398992657661438, -0.17693477869033813, 0.04029780626296997, 0.12754225730895996, -0.19605238735675812, -0.016229957342147827, -0.2095089852809906, -0.18727180361747742, -0.13130135834217072, -0.1490936577320099, -0.07968536019325256, 0.15417179465293884, -0.18893426656723022, -0.1709534078836441, 0.23179367184638977, -0.031404465436935425, 0.04511180520057678, -0.08412875235080719, 0.17498049139976501, 0.19033023715019226, -0.17084473371505737, -0.16210049390792847, 0.13095906376838684, -0.1387653797864914, 0.2155209481716156, -0.011439487338066101, 0.031114965677261353, -0.1614111065864563, -0.2426874190568924, -0.09815596044063568, 0.12786364555358887, -0.09449544548988342, -0.17232060432434082, -0.1547996997833252, -0.1442769169807434, 0.1572646200656891, 0.1149667501449585, -0.1677207350730896, 0.039414405822753906, -0.1021614819765091, 0.03777730464935303, 0.0099295973777771, -0.08665776252746582, -0.05181802809238434, 0.05353561043739319, 0.18788358569145203, -0.05345901846885681, 0.17690101265907288, 0.24875971674919128, -0.07379372417926788, -0.2194501906633377, 0.25214681029319763, -0.06074889004230499, -0.06746834516525269, 0.1540481448173523, 0.12694036960601807, 0.02755880355834961, -0.13328972458839417, -0.1393187940120697, 0.17164671421051025, -0.17643305659294128, -0.028741836547851562, 0.036691874265670776, -0.22720526158809662, 0.21314209699630737, -0.1613481640815735, -0.031435683369636536, -0.062069714069366455, -0.15167728066444397, -0.23567749559879303, 0.1795697808265686, -0.1592044234275818, -0.09249110519886017, 0.07175207138061523, -0.16641072928905487, 0.2463570535182953, -0.2075095772743225, -0.1359429955482483, -0.23448072373867035, -0.03194469213485718, -0.08053578436374664, 0.05178040266036987, 0.25605711340904236, -0.13432830572128296, -0.07179030776023865, 0.08246329426765442, 0.19405171275138855, -0.07269437611103058, 0.03521525859832764, 0.15969878435134888, -0.1788163036108017, -0.19072186946868896, -0.24669796228408813, -0.12798383831977844, -0.00465768575668335, 0.11010095477104187, 0.2432723343372345, 0.19797518849372864, -0.09838615357875824, -0.1632077693939209, -0.15863081812858582, 0.2013912796974182, 0.086241215467453};
const float fc2_bias_data[20] = {0.11700403690338135, 0.21335089206695557, 0.18806660175323486, 0.16145315766334534, 0.10308945178985596, 0.15462347865104675, -0.24684976041316986, -0.05410577356815338, 0.08049914240837097, 0.13919195532798767, -0.15665361285209656, 0.01888313889503479, 0.1079869270324707, 0.13429754972457886, 0.16682356595993042, 0.13564243912696838, -0.13343483209609985, -0.07461927831172943, -0.09996850788593292, 0.08207741379737854};

const float fc3_weight_data[100] = {0.04956826567649841, 0.20224463939666748, 0.049671471118927, -0.009589076042175293, 0.029676884412765503, 0.17095091938972473, 0.21007409691810608, -0.12875902652740479, 0.02589687705039978, -0.029519349336624146, 0.15815606713294983, 0.21782797574996948, 0.0674121081829071, 0.13209810853004456, -0.0886622816324234, 0.20959436893463135, 0.22204169631004333, 0.08436763286590576, 0.03603404760360718, -0.18804869055747986, -0.07194182276725769, 0.10430175065994263, -0.07029105722904205, -0.16529704630374908, -0.18120159208774567, -0.006236225366592407, -0.09780539572238922, -0.22345206141471863, 0.0550176203250885, 0.013406366109848022, -0.1815318912267685, -0.046104609966278076, 0.027683347463607788, 0.06233358383178711, 0.05622479319572449, -0.08665129542350769, 0.11376678943634033, 0.21104511618614197, 0.0028600096702575684, 0.20793870091438293, 0.2147955298423767, 0.1738966405391693, 0.035457462072372437, -0.10322581231594086, 0.053149789571762085, -0.09823954105377197, -0.15976858139038086, -0.16325682401657104, -0.16005437076091766, 0.20117288827896118, 0.09375572204589844, -0.07838208973407745, 0.026484251022338867, -0.013929635286331177, -0.002033725380897522, 0.04579642415046692, -0.08253845572471619, 0.02467261254787445, -0.16472290456295013, -0.09559087455272675, -0.21702255308628082, 0.07156315445899963, -0.22280669212341309, -0.03858545422554016, -0.046665892004966736, -0.09793893992900848, -0.2083951234817505, 0.023907020688056946, -0.08858267962932587, -0.08392742276191711, 0.043019384145736694, -0.07770282030105591, 0.04483094811439514, 0.10628068447113037, -0.05359192192554474, 0.12421396374702454, 0.030942976474761963, -0.09041142463684082, -0.03770868480205536, 0.18500223755836487, 0.16176477074623108, 0.052802443504333496, 0.19430571794509888, 0.22157880663871765, -0.0618877112865448, 0.17161345481872559, 0.19333922863006592, -0.20966151356697083, 0.15572577714920044, 0.051158785820007324, 0.15422135591506958, 0.026135355234146118, 0.20873209834098816, -0.19996190071105957, -0.027682319283485413, 0.10008740425109863, -0.05272865295410156, -0.16755563020706177, 0.08871462941169739, 0.04495888948440552};
const float fc3_bias_data[5] = {-0.02634650468826294, -0.1155988946557045, 0.16878947615623474, -0.025923654437065125, 0.04112434387207031};

Tensor forward(float input_data[10]) {
  Tensor input = NN_tensor(2, (size_t[]){ 1, 10 }, DTYPE_F32, (float *)input_data);
  float fc1_out_data[10] = {0};
Tensor fc1_out = NN_tensor(2, (size_t[]){ 1, 15 }, DTYPE_F32, (float *)fc1_out_data);
Tensor fc1_weight = NN_tensor(2, (size_t[]){ 10, 15 }, DTYPE_F32, (float *)fc1_weight_data);
Tensor fc1_bias = NN_tensor(2, (size_t[]){ 1, 15 }, DTYPE_F32, (float *)fc1_bias_data);
  float fc2_out_data[15] = {0};
Tensor fc2_out = NN_tensor(2, (size_t[]){ 1, 20 }, DTYPE_F32, (float *)fc2_out_data);
Tensor fc2_weight = NN_tensor(2, (size_t[]){ 15, 20 }, DTYPE_F32, (float *)fc2_weight_data);
Tensor fc2_bias = NN_tensor(2, (size_t[]){ 1, 20 }, DTYPE_F32, (float *)fc2_bias_data);
  float fc3_out_data[20] = {0};
Tensor fc3_out = NN_tensor(2, (size_t[]){ 1, 5 }, DTYPE_F32, (float *)fc3_out_data);
Tensor fc3_weight = NN_tensor(2, (size_t[]){ 20, 5 }, DTYPE_F32, (float *)fc3_weight_data);
Tensor fc3_bias = NN_tensor(2, (size_t[]){ 1, 5 }, DTYPE_F32, (float *)fc3_bias_data);

  NN_linear_F32(&fc1_out, &input, &fc1_weight, &fc1_bias);
  NN_linear_F32(&fc2_out, &fc1_out, &fc2_weight, &fc2_bias);
  NN_linear_F32(&fc3_out, &fc2_out, &fc3_weight, &fc3_bias);
  return fc3_out;
}

int main() {
  float *input_data = (float[]){0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0};
  forward(input_data);
  return 0;
}
