
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <riscv.h>

#include "nn.h"
#include "unittest.h"

int main() {
  enable_accelerator_features();

  size_t cycles = 0;

  
  {
    printf("NN_add1d_f16:           ");
    
    // [-1.66   -2.27    3.07    0.9375 -0.923  -1.274   3.453 ]
    Tensor1D_F16 a = {
      .shape = { 7 },
      .data = (float16_t *)((uint8_t[]){ 0xa4,0xbe,0x8a,0xc0,0x24,0x42,0x80,0x3b,0x62,0xbb,0x19,0xbd,0xe8,0x42 })
    };
    // [ 1.753    0.04395  3.531   -3.648    3.682    3.926   -2.074  ]
    Tensor1D_F16 b = {
      .shape = { 7 },
      .data = (float16_t *)((uint8_t[]){ 0x3,0x3f,0xa0,0x29,0x10,0x43,0x4c,0xc3,0x5d,0x43,0xda,0x43,0x26,0xc0 })
    };

    
    // [ 0.0928 -2.227   6.6    -2.71    2.758   2.652   1.379 ]
    Tensor1D_F16 golden = {
      .shape = { 7 },
      .data = (float16_t *)((uint8_t[]){ 0xf0,0x2d,0x74,0xc0,0x9a,0x46,0x6c,0xc1,0x84,0x41,0x4e,0x41,0x84,0x3d })
    };
    // 
    Tensor1D_F16 actual = {
      .shape = { 7 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 7)
    };

    cycles = read_cycles();
    NN_add1d_f16(&actual, &a, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals1d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_add2d_f16:           ");
    
    // [[ 0.3418  2.305  -2.07    1.934  -3.467  -1.558   2.373 ]  [-2.309  -4.574  -4.
    Tensor2D_F16 a = {
      .shape = { 6, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x78,0x35,0x9c,0x40,0x24,0xc0,0xbc,0x3f,0xef,0xc2,0x3b,0xbe,0xbf,0x40,0x9e,0xc0,0x93,0xc4,0x26,0xc4,0xdc,0x41,0xd6,0xba,0x9c,0x42,0xc2,0xc0,0xfe,0xba,0xa6,0xc4,0xd3,0xbc,0x79,0x44,0x70,0xc4,0x80,0xb3,0x41,0xbd,0xec,0x42,0xfe,0x44,0x23,0x44,0x36,0x40,0xa0,0xc1,0xcc,0xba,0x84,0xc4,0xce,0x44,0xea,0x3a,0x41,0xbd,0x6f,0xbc,0x21,0xbf,0xbe,0x39,0x74,0xb8,0xde,0xc1,0xa0,0x3d,0xb1,0x44,0x2d,0x3d,0x63,0xbe,0x85,0xbf,0xb0,0xc0 })
    };
    // [[-2.348  -1.514  -3.809  -4.26   -1.704  -2.51    2.242 ]  [-0.6934  0.8936 -4.
    Tensor2D_F16 b = {
      .shape = { 6, 7 },
      .data = (float16_t *)((uint8_t[]){ 0xb2,0xc0,0xe,0xbe,0x9e,0xc3,0x43,0xc4,0xd1,0xbe,0x5,0xc1,0x7c,0x40,0x8c,0xb9,0x26,0x3b,0xdd,0xc4,0x56,0xbc,0x60,0xc4,0x60,0xc4,0x8d,0x44,0x24,0x34,0x66,0x44,0x5f,0x41,0xc4,0x40,0x3c,0xbd,0x56,0xc3,0xba,0xc2,0x36,0xc2,0x6,0x42,0x90,0x32,0x51,0x40,0xb2,0xc0,0x50,0xb9,0x7e,0xc3,0x45,0x3e,0xe1,0x44,0x93,0x44,0xb9,0xc4,0x28,0xc3,0x40,0x44,0xa6,0x38,0xc9,0xbc,0xcd,0xc1,0x68,0x36,0x8e,0xc4,0x60,0x44,0x1d,0xc2,0x8,0xc0 })
    };

    
    // [[-2.006    0.791   -5.88    -2.328   -5.17    -4.066    4.617  ]  [-3.002   -3.
    Tensor2D_F16 golden = {
      .shape = { 6, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x3,0xc0,0x54,0x3a,0xe1,0xc5,0xa8,0xc0,0x2c,0xc5,0x11,0xc4,0x9e,0x44,0x1,0xc2,0x5c,0xc3,0x82,0xc8,0x62,0x3f,0x3b,0xc5,0x48,0xbc,0x58,0x40,0xec,0xb8,0x0,0xb4,0xeb,0x3d,0xdb,0x46,0xbf,0xc5,0xce,0xc3,0xad,0xc4,0xb0,0x35,0x0,0x48,0x58,0x44,0x44,0x44,0x29,0xc5,0xe,0xbe,0x22,0xc8,0x5f,0x46,0xbe,0x45,0x86,0x42,0xd5,0xc5,0x5c,0xc5,0xf8,0x44,0x40,0x26,0x21,0xc4,0xfa,0xbd,0x18,0x45,0x86,0xc2,0x8e,0x41,0xf0,0xc4,0x5c,0xc4 })
    };
    // 
    Tensor2D_F16 actual = {
      .shape = { 6, 7 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 6*7)
    };

    cycles = read_cycles();
    NN_add2d_f16(&actual, &a, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_mm_f16:              ");
    
    // [[ 2.758  -0.5664 -1.909   4.58   -4.59   -4.008  -3.418 ]  [-1.221  -0.293   0.
    Tensor2D_F16 x = {
      .shape = { 6, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x84,0x41,0x88,0xb8,0xa3,0xbf,0x94,0x44,0x97,0xc4,0x2,0xc4,0xd6,0xc2,0xe2,0xbc,0xb0,0xb4,0x58,0x33,0x85,0xbf,0xf1,0x44,0x1e,0x39,0x10,0xb4,0x18,0xba,0x8,0x3b,0xe2,0x44,0x22,0x44,0x96,0x39,0x72,0x42,0x6f,0x3c,0x78,0xb5,0x8d,0xbc,0xf5,0xbd,0x7e,0xb8,0x5c,0xc2,0x2a,0x44,0x88,0xc0,0xf5,0x3d,0xac,0x41,0x2d,0xc4,0x98,0x42,0x60,0x40,0x6c,0x37,0xb2,0x3b,0xeb,0x41,0x80,0xc3,0x4d,0x44,0xbd,0x42,0xb4,0x3d,0x8a,0x44,0x10,0xbc })
    };
    // [[ 4.203  -3.11    2.979   2.705  -0.249  -3.203   4.88  ]  [-0.5225 -4.02   -3.
    Tensor2D_F16 w = {
      .shape = { 5, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x34,0x44,0x38,0xc2,0xf5,0x41,0x69,0x41,0xf8,0xb3,0x68,0xc2,0xe1,0x44,0x2e,0xb8,0x5,0xc4,0x42,0xc2,0x0,0x41,0x6c,0x44,0x63,0xc2,0x94,0xc0,0x78,0xb5,0x7b,0x3f,0xe3,0xc4,0xd4,0x42,0x5e,0xc4,0x52,0xc2,0x86,0xc4,0x9b,0x41,0x44,0xb7,0xaa,0xbd,0x66,0xc4,0xb4,0x44,0x33,0xc0,0x9a,0x44,0x91,0xbd,0xc8,0x39,0xf6,0xc3,0x83,0xc0,0x4,0x40,0xba,0xbc,0x68,0x32 })
    };

    
    // [[ 17.36   18.58   71.1   -38.34  -12.14 ]  [-13.14   16.78  -30.12   25.39   13
    Tensor2D_F16 golden = {
      .shape = { 6, 5 },
      .data = (float16_t *)((uint8_t[]){ 0x57,0x4c,0xa5,0x4c,0x72,0x54,0xcb,0xd0,0x12,0xca,0x92,0xca,0x32,0x4c,0x88,0xcf,0x59,0x4e,0xf7,0x4a,0x5a,0x4b,0x75,0xcc,0x86,0xce,0x81,0xce,0x50,0xcf,0xdd,0xce,0x15,0xcb,0x2a,0x4b,0x7f,0xcf,0xe9,0xc4,0xd5,0xc2,0x8f,0x4b,0x45,0x4d,0x5,0x48,0x99,0x4a,0x8b,0x4e,0x42,0x41,0x30,0xd0,0x9a,0xcc,0x48,0xd0 })
    };
    // 
    Tensor2D_F16 actual = {
      .shape = { 6, 5 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 6*5)
    };

    cycles = read_cycles();
    NN_mm_f16(&actual, &x, &w);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_addmm_f16:           ");
    
    // [[ 0.2832 -1.558   0.1758 -1.201  -4.58    0.21   -0.742 ]  [-4.945  -1.24   -3.
    Tensor2D_F16 x = {
      .shape = { 6, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x88,0x34,0x3b,0xbe,0xa0,0x31,0xce,0xbc,0x94,0xc4,0xb8,0x32,0xf0,0xb9,0xf2,0xc4,0xf6,0xbc,0x0,0xc3,0x40,0x36,0xd8,0xc4,0x1c,0x3b,0x0,0x39,0x42,0xbc,0x50,0xc3,0xcc,0x3a,0x69,0x41,0x3f,0x3f,0x30,0x3b,0xaa,0xc1,0x3c,0xc1,0xc0,0x41,0x35,0xc3,0x78,0x3d,0x8f,0xbf,0xf6,0xbc,0x8,0x41,0x8a,0xc4,0x6a,0x3c,0x46,0x44,0x41,0x3d,0x4c,0x44,0x1c,0xc3,0x68,0x3e,0xf0,0x2d,0x12,0xc0,0x1a,0x44,0x1,0x40,0x9b,0xc1,0xd8,0x3c,0x1f,0xc4 })
    };
    // [[-3.422   -0.09766  4.047    3.818    4.22     1.27     4.703  ]  [-1.343   -4.
    Tensor2D_F16 w = {
      .shape = { 5, 7 },
      .data = (float16_t *)((uint8_t[]){ 0xd8,0xc2,0x40,0xae,0xc,0x44,0xa3,0x43,0x38,0x44,0x14,0x3d,0xb4,0x44,0x5f,0xbd,0x52,0xc4,0x0,0xa5,0x29,0xc0,0x80,0x40,0x46,0xb9,0x10,0x42,0x12,0xbb,0x68,0xbe,0x28,0x41,0xf0,0x39,0xbc,0xb7,0x46,0xc4,0x4c,0x38,0xe1,0xc4,0x88,0x40,0x50,0xb5,0x57,0x44,0x64,0xb9,0x92,0x38,0x58,0x40,0xd0,0x41,0xdb,0xbe,0x42,0x44,0x80,0xb7,0x74,0x3c,0xf4,0x40,0x19,0xbd })
    };
    // [-4.41   1.592 -2.71  -3.598 -2.438]
    Tensor1D_F16 b = {
      .shape = { 5 },
      .data = (float16_t *)((uint8_t[]){ 0x69,0xc4,0x5e,0x3e,0x6c,0xc1,0x32,0xc3,0xe0,0xc0 })
    };

    
    // [[-3.164e+01 -2.252e+00  1.225e-02 -1.219e+01 -1.265e+00]  [-1.641e+01  3.256e+0
    Tensor2D_F16 golden = {
      .shape = { 6, 5 },
      .data = (float16_t *)((uint8_t[]){ 0xe9,0xcf,0x81,0xc0,0x46,0x22,0x18,0xca,0xf,0xbd,0x1a,0xcc,0x83,0x42,0x35,0xc6,0x6d,0x4e,0x38,0xd0,0x69,0x48,0x9,0x48,0x18,0x40,0x2d,0xc0,0x78,0x49,0xa0,0xc1,0xe6,0xc5,0xb7,0xc5,0x36,0x4f,0xeb,0xd0,0xcf,0x52,0x3e,0x4c,0x60,0x4e,0xf8,0x4d,0x0,0xc6,0xfa,0xc8,0xca,0xca,0x7e,0x46,0xb4,0xc7,0xbe,0x4d })
    };
    // 
    Tensor2D_F16 actual = {
      .shape = { 6, 5 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 6*5)
    };

    cycles = read_cycles();
    NN_addmm_f16(&actual, &x, &w, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_relu2d_f16:          ");
    
    // [[ 4.098     3.398     0.742    -2.113    -4.8      -3.662     2.695   ]  [ 2.13
    Tensor2D_F16 x = {
      .shape = { 7, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x19,0x44,0xcc,0x42,0xf0,0x39,0x3a,0xc0,0xcd,0xc4,0x53,0xc3,0x64,0x41,0x47,0x40,0xfa,0xc3,0xc9,0xbc,0x30,0xc4,0x75,0xc4,0xd1,0x3e,0xf7,0x44,0xa,0x39,0xa5,0xbd,0x54,0x44,0x24,0xbc,0xe4,0xc3,0x71,0x3f,0xe2,0xc4,0xac,0xc4,0x30,0xb3,0x50,0xad,0x88,0x43,0xb7,0xc3,0xfe,0x42,0xe0,0x44,0x28,0xc3,0x17,0x43,0x0,0xa1,0x4f,0xbe,0xec,0x42,0xcd,0xbd,0x94,0xc0,0xd8,0xc4,0xe0,0x2a,0x4,0x42,0xee,0xc3,0x64,0x39,0xc7,0x42,0xe6,0x44,0x1c,0x40,0x38,0x42,0x86,0x42,0xd5,0xbf,0xc4,0x40,0xf6,0xbc,0x44,0x41 })
    };

    
    // [[4.098  3.398  0.742  0.     0.     0.     2.695 ]  [2.139  0.     0.     0.   
    Tensor2D_F16 golden = {
      .shape = { 7, 7 },
      .data = (float16_t *)((uint8_t[]){ 0x19,0x44,0xcc,0x42,0xf0,0x39,0x0,0x0,0x0,0x0,0x0,0x0,0x64,0x41,0x47,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xd1,0x3e,0xf7,0x44,0xa,0x39,0x0,0x0,0x54,0x44,0x0,0x0,0x0,0x0,0x71,0x3f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x88,0x43,0x0,0x0,0xfe,0x42,0xe0,0x44,0x0,0x0,0x17,0x43,0x0,0x0,0x0,0x0,0xec,0x42,0x0,0x0,0x0,0x0,0x0,0x0,0xe0,0x2a,0x4,0x42,0x0,0x0,0x64,0x39,0xc7,0x42,0xe6,0x44,0x1c,0x40,0x38,0x42,0x86,0x42,0x0,0x0,0xc4,0x40,0x0,0x0,0x44,0x41 })
    };
    // 
    Tensor2D_F16 actual = {
      .shape = { 7, 7 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 7*7)
    };

    cycles = read_cycles();
    NN_relu2d_f16(&actual, &x);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_elu2d_f16:           ");
    
    // [[ 4.78    1.06   -1.763  -0.991  -3.5     0.8496  0.7227]  [-0.3662  2.64    2.
    Tensor2D_F16 x = {
      .shape = { 7, 7 },
      .data = (float16_t *)((uint8_t[]){ 0xc8,0x44,0x3d,0x3c,0xd,0xbf,0xee,0xbb,0x0,0xc3,0xcc,0x3a,0xc8,0x39,0xdc,0xb5,0x48,0x41,0xa8,0x41,0xa8,0xc0,0x3d,0xbc,0xad,0x3f,0xa5,0xc4,0x1a,0xc3,0x1a,0xb8,0x64,0x44,0xf3,0x43,0xbe,0xbd,0x9e,0x44,0xc8,0xb9,0x88,0x43,0xce,0x43,0xd3,0xbc,0xb2,0x3f,0x44,0x41,0xd0,0xc1,0x7,0xc4,0x22,0x40,0xc4,0x34,0xac,0xc2,0x36,0xba,0xe0,0x32,0x56,0xbc,0x8a,0x44,0xe0,0x36,0xd7,0xc4,0x67,0xbf,0xbc,0xc3,0x5,0xbd,0xd3,0xc4,0x80,0x43,0x7c,0x40,0x2b,0xc3,0xa,0xc4,0x14,0xb9,0xa2,0x44,0xf6,0x3c,0x40,0x36 })
    };

    
    // [[ 4.78    1.06   -0.8286 -0.629  -0.9697  0.8496  0.7227]  [-0.3066  2.64    2.
    Tensor2D_F16 golden = {
      .shape = { 7, 7 },
      .data = (float16_t *)((uint8_t[]){ 0xc8,0x44,0x3d,0x3c,0xa1,0xba,0x8,0xb9,0xc2,0xbb,0xcc,0x3a,0xc8,0x39,0xe8,0xb4,0x48,0x41,0xa8,0x41,0x38,0xbb,0x3a,0xb9,0xad,0x3f,0xec,0xbb,0xc5,0xbb,0x6b,0xb6,0x64,0x44,0xf3,0x43,0x19,0xba,0x9e,0x44,0x1e,0xb8,0x88,0x43,0xce,0x43,0x9b,0xb9,0xb2,0x3f,0x44,0x41,0x90,0xbb,0xdc,0xbb,0x22,0x40,0xc4,0x34,0xb7,0xbb,0x52,0xb8,0xe0,0x32,0x4b,0xb9,0x8a,0x44,0xe0,0x36,0xf0,0xbb,0xbe,0xba,0xd5,0xbb,0xb8,0xb9,0xf0,0xbb,0x80,0x43,0x7c,0x40,0xc7,0xbb,0xdc,0xbb,0x85,0xb7,0xa2,0x44,0xf6,0x3c,0x40,0x36 })
    };
    // 
    Tensor2D_F16 actual = {
      .shape = { 7, 7 },
      .data = (float16_t *)malloc(sizeof(float16_t) * 7*7)
    };

    cycles = read_cycles();
    NN_elu2d_f16(&actual, &x, 1.0);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f16(&golden, &actual, 1e-2) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_add1d_f32:           ");
    
    // [ 2.127341  -1.6991377  2.4378567 -3.4923549  1.129275  -3.3829594  -4.9326878]
    Tensor1D_F32 a = {
      .shape = { 7 },
      .data = (float *)((uint8_t[]){ 0x5b,0x26,0x8,0x40,0x58,0x7d,0xd9,0xbf,0xd8,0x5,0x1c,0x40,0xbe,0x82,0x5f,0xc0,0x15,0x8c,0x90,0x3f,0x68,0x82,0x58,0xc0,0x94,0xd8,0x9d,0xc0 })
    };
    // [-4.015279   3.9473505  2.7051783  4.6910787  4.005606  -4.465227  -3.4121556]
    Tensor1D_F32 b = {
      .shape = { 7 },
      .data = (float *)((uint8_t[]){ 0x2a,0x7d,0x80,0xc0,0x64,0xa1,0x7c,0x40,0xa4,0x21,0x2d,0x40,0x51,0x1d,0x96,0x40,0xed,0x2d,0x80,0x40,0x24,0xe3,0x8e,0xc0,0xc2,0x60,0x5a,0xc0 })
    };

    
    // [-1.8879378  2.2482128  5.143035   1.1987238  5.134881  -7.8481865  -8.344843 ]
    Tensor1D_F32 golden = {
      .shape = { 7 },
      .data = (float *)((uint8_t[]){ 0xf2,0xa7,0xf1,0xbf,0xb8,0xe2,0xf,0x40,0xbe,0x93,0xa4,0x40,0xc8,0x6f,0x99,0x3f,0xf2,0x50,0xa4,0x40,0x58,0x24,0xfb,0xc0,0x7a,0x84,0x5,0xc1 })
    };
    // 
    Tensor1D_F32 actual = {
      .shape = { 7 },
      .data = (float *)malloc(sizeof(float) * 7)
    };

    cycles = read_cycles();
    NN_add1d_f32(&actual, &a, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals1d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_add2d_f32:           ");
    
    // [[-0.80791295 -3.2471614   3.4719825  -3.7800388  -2.4395072  -4.8304567   -2.83
    Tensor2D_F32 a = {
      .shape = { 6, 7 },
      .data = (float *)((uint8_t[]){ 0x62,0xd3,0x4e,0xbf,0x7e,0xd1,0x4f,0xc0,0xf6,0x34,0x5e,0x40,0x28,0xec,0x71,0xc0,0xe3,0x20,0x1c,0xc0,0x1a,0x93,0x9a,0xc0,0xb8,0xad,0x35,0xc0,0xad,0x98,0x83,0x40,0x69,0x0,0x83,0x40,0x6d,0x11,0x65,0x40,0xaa,0x14,0x77,0x40,0x14,0x45,0x8e,0x40,0x5c,0xe1,0xa3,0xbf,0xf8,0xcc,0xc,0x40,0x82,0x8c,0x8e,0x40,0x59,0xb9,0xd3,0x3f,0xbe,0xf2,0x9f,0x40,0xde,0xf8,0x25,0x40,0x6e,0xed,0x46,0x40,0xb7,0xfe,0xdf,0xbf,0x78,0x8b,0x19,0x40,0x94,0x14,0x13,0x3f,0xd5,0xd7,0x98,0xbf,0x1c,0x63,0x34,0xc0,0xac,0x8e,0x33,0xc0,0xde,0x3b,0x76,0xc0,0x62,0xd3,0x56,0x40,0x7c,0x7f,0x63,0x40,0x24,0xae,0x11,0xbf,0xf5,0x2d,0x39,0xc0,0x6a,0x54,0x77,0x40,0xef,0xa2,0x4c,0x40,0x8c,0x4b,0xbe,0x3e,0x53,0x15,0x17,0xc0,0x33,0xc,0x93,0x40,0x6c,0xdc,0x2,0x40,0x30,0xed,0x72,0xc0,0x1d,0x22,0x99,0x40,0xe6,0xff,0x72,0x40,0x2f,0x46,0xe9,0xbf,0xb3,0xe3,0x33,0x40,0xc,0xd2,0x35,0xc0 })
    };
    // [[-0.7835716   4.245506    0.20659566 -3.5360909  -1.6711646  -1.3572258   -0.96
    Tensor2D_F32 b = {
      .shape = { 6, 7 },
      .data = (float *)((uint8_t[]){ 0x26,0x98,0x48,0xbf,0x2f,0xdb,0x87,0x40,0xd0,0x8d,0x53,0x3e,0x50,0x4f,0x62,0xc0,0xb9,0xe8,0xd5,0xbf,0x93,0xb9,0xad,0xbf,0xe8,0xf2,0x76,0xbf,0x5c,0xfe,0xf4,0x3e,0x5,0xf9,0x93,0x40,0x34,0x10,0x89,0x3e,0xaf,0x94,0x45,0xc0,0x0,0x36,0x83,0x3e,0x97,0x6f,0x19,0x40,0x9e,0xbb,0x1e,0x40,0xec,0x3a,0x92,0xc0,0xdc,0xb,0x65,0xbf,0x66,0xce,0x6d,0xc0,0x15,0x8a,0x8,0xc0,0x78,0x96,0xe6,0x3f,0xde,0x3d,0x63,0xc0,0xbb,0xe7,0xed,0x3f,0xf4,0xcd,0x87,0x40,0xfc,0xe7,0xa7,0x3e,0xac,0x46,0x55,0xc0,0x68,0x4d,0xe5,0xbf,0xc7,0xc0,0x8b,0x3f,0x18,0xf1,0x73,0xc0,0xb4,0xfa,0x1e,0x40,0x56,0x42,0x91,0xc0,0x93,0xce,0x99,0xc0,0x38,0x77,0x9b,0xc0,0x21,0xd5,0x81,0xbf,0xb4,0x2d,0x57,0x40,0xc7,0x6f,0x97,0xc0,0x6d,0xfd,0x84,0x40,0xe0,0x1,0x0,0xc0,0x22,0x72,0xbb,0x3f,0xa8,0x7c,0x69,0x3e,0x6a,0x46,0x90,0xc0,0x51,0xb1,0x84,0x40,0x4a,0x4d,0x2c,0x40,0x10,0xa,0x9f,0x40 })
    };

    
    // [[-1.5914845   0.9983444   3.6785781  -7.3161297  -4.110672   -6.1876826   -3.80
    Tensor2D_F32 golden = {
      .shape = { 6, 7 },
      .data = (float *)((uint8_t[]){ 0xc4,0xb5,0xcb,0xbf,0x80,0x93,0x7f,0x3f,0xd3,0x6d,0x6b,0x40,0xbc,0x1d,0xea,0xc0,0xa0,0x8a,0x83,0xc0,0x7f,0x1,0xc6,0xc0,0x72,0x6a,0x73,0xc0,0x93,0xe8,0x92,0x40,0xb7,0x7c,0xb,0x41,0x74,0x33,0x76,0x40,0xec,0xff,0x45,0x3f,0x74,0x78,0x96,0x40,0xd2,0xfd,0x8e,0x3f,0x4b,0xc4,0x95,0x40,0x80,0x9a,0xeb,0xbd,0xd6,0x66,0x42,0x3f,0x2c,0x2e,0xa4,0x3f,0x48,0x76,0xeb,0x3e,0x55,0x1c,0x9d,0x40,0x9d,0x9e,0xa9,0xc0,0xab,0x3f,0x88,0x40,0x86,0x30,0x9a,0x40,0xac,0xbb,0x5d,0xbf,0xe4,0xd4,0xc4,0xc0,0xb0,0x1a,0x93,0xc0,0x7a,0x5b,0x30,0xc0,0xb0,0xed,0xe8,0xbe,0x18,0x3d,0xc1,0x40,0x1a,0x78,0xa3,0xc0,0x8e,0x65,0xf6,0xc0,0x18,0x68,0x7e,0xbf,0x5e,0xb8,0xb,0x40,0x26,0xf7,0x6e,0x40,0x70,0xfa,0xe2,0xc0,0xd0,0x4,0xc,0x41,0x0,0xa3,0x36,0x3d,0x1f,0x34,0x15,0xc0,0x2,0x6e,0xa0,0x40,0xb8,0x33,0x36,0xbf,0x8a,0xbf,0x14,0x40,0x7e,0x18,0xb0,0x40,0x14,0x42,0x8,0x40 })
    };
    // 
    Tensor2D_F32 actual = {
      .shape = { 6, 7 },
      .data = (float *)malloc(sizeof(float) * 6*7)
    };

    cycles = read_cycles();
    NN_add2d_f32(&actual, &a, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_mm_f32:              ");
    
    // [[ 2.526061   -3.300345    4.172919    0.26872218  2.3710823  -4.0091457   -1.43
    Tensor2D_F32 x = {
      .shape = { 6, 7 },
      .data = (float *)((uint8_t[]){ 0xfc,0xaa,0x21,0x40,0xda,0x38,0x53,0xc0,0x8d,0x88,0x85,0x40,0xf4,0x95,0x89,0x3e,0xd0,0xbf,0x17,0x40,0xec,0x4a,0x80,0xc0,0xba,0x14,0xb8,0xbf,0xb4,0x19,0x9d,0xc0,0x74,0x46,0xf9,0xbf,0x64,0x11,0x8a,0x3f,0x73,0x40,0x7b,0xc0,0x54,0x2,0xcc,0x3f,0x37,0xc7,0x2b,0x40,0xde,0x50,0x32,0x3f,0x4f,0x1b,0x56,0xc0,0x30,0x1a,0x78,0xc0,0x5d,0x73,0xc5,0xbf,0x74,0x77,0xc,0x40,0xcc,0xd2,0x9d,0x40,0x60,0x2,0x38,0x40,0xce,0x23,0x10,0xbf,0x0,0x65,0xe0,0x3f,0x56,0xf8,0x9c,0xc0,0xfd,0xa7,0x88,0xc0,0x86,0x50,0x15,0x40,0xbc,0x40,0x35,0xc0,0x5c,0xf3,0x19,0x40,0xf6,0xe5,0x61,0xc0,0xde,0x7f,0x1e,0xc0,0x4d,0xca,0x83,0xc0,0x30,0xfd,0x26,0x40,0xfc,0x6c,0x2,0xbf,0xb9,0x45,0x76,0x40,0x2,0xa,0x46,0x40,0xd3,0x11,0x31,0x40,0xa8,0xa3,0x24,0x3e,0xb9,0xdf,0xc5,0xbf,0x1,0x28,0x8b,0xbf,0xde,0x1c,0x2a,0x3f,0x86,0xa0,0x1e,0x40,0x53,0x30,0x60,0xc0,0xd2,0x48,0x86,0x40 })
    };
    // [[-0.5436504  -4.189728   -2.7052891   4.4240885   4.5726357  -4.631398    3.526
    Tensor2D_F32 w = {
      .shape = { 5, 7 },
      .data = (float *)((uint8_t[]){ 0xac,0x2c,0xb,0xbf,0x40,0x12,0x86,0xc0,0x75,0x23,0x2d,0xc0,0x22,0x92,0x8d,0x40,0x8,0x53,0x92,0x40,0x6a,0x34,0x94,0xc0,0xa,0xb2,0x61,0x40,0xf6,0x5e,0x20,0x40,0xf6,0x69,0x3d,0x40,0xd6,0x71,0x87,0x40,0xd0,0x76,0x2c,0xc0,0xb3,0x18,0xca,0x3f,0x62,0xf4,0x2,0x40,0xa2,0x1d,0xbd,0xbf,0x92,0x2d,0xd6,0x3f,0xf7,0x22,0xb8,0xbf,0xf8,0xd7,0x45,0x40,0x2a,0x92,0xb1,0xbf,0xd9,0x96,0xee,0xbf,0x90,0x1e,0xa1,0x3f,0x2,0x1,0xe3,0x3f,0xca,0x57,0x1c,0xc0,0xbc,0x4c,0xe2,0x3e,0x91,0x73,0x39,0x40,0x2c,0xb6,0xfe,0xbe,0x12,0xc6,0xc2,0x3f,0x13,0x5c,0x9a,0xbf,0xdc,0x51,0xe0,0x3f,0x60,0xce,0x67,0xc0,0x52,0x2b,0x3c,0xc0,0xd1,0x6d,0x22,0xc0,0xb0,0xa,0x93,0x40,0xbd,0x36,0xac,0xbf,0x0,0xac,0x5f,0xbc,0xe0,0x9,0x1b,0xc0 })
    };

    
    // [[ 26.692635    11.165534     9.484898    10.251007    -8.453236  ]  [-12.144375
    Tensor2D_F32 golden = {
      .shape = { 6, 5 },
      .data = (float *)((uint8_t[]){ 0x84,0x8a,0xd5,0x41,0x7,0xa6,0x32,0x41,0x24,0xc2,0x17,0x41,0x20,0x4,0x24,0x41,0x74,0x40,0x7,0xc1,0x5c,0x4f,0x42,0xc1,0xdf,0xdd,0x81,0x40,0x84,0x55,0xa0,0x40,0xbf,0xf5,0x84,0x41,0x87,0xa2,0x91,0xbf,0x4,0xc7,0x1c,0x42,0xe5,0x61,0x8e,0xc1,0xf8,0x82,0x66,0xc1,0xbe,0xac,0x7c,0x40,0xf9,0xd0,0x0,0x42,0xf8,0xed,0x9d,0x40,0x45,0x93,0xe6,0xc1,0x80,0xd4,0x8c,0xc0,0x11,0x87,0x5,0xc2,0x8e,0xd6,0x27,0x42,0xf1,0x7a,0xb2,0x41,0xa2,0xda,0x15,0x40,0x4b,0xeb,0x42,0x41,0xf7,0x20,0x98,0x41,0x6c,0xa7,0x46,0x3e,0xf3,0x80,0x5a,0x42,0xa2,0x26,0xa0,0xc1,0xa6,0x1d,0x58,0xc0,0xd8,0xb0,0x2c,0x41,0x5a,0x56,0x6b,0xc0 })
    };
    // 
    Tensor2D_F32 actual = {
      .shape = { 6, 5 },
      .data = (float *)malloc(sizeof(float) * 6*5)
    };

    cycles = read_cycles();
    NN_mm_f32(&actual, &x, &w);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_addmm_f32:           ");
    
    // [[ 4.9914503   4.883351   -3.7709332  -4.0533495  -3.789965   -0.02411366   -1.2
    Tensor2D_F32 x = {
      .shape = { 6, 7 },
      .data = (float *)((uint8_t[]){ 0xf6,0xb9,0x9f,0x40,0x69,0x44,0x9c,0x40,0xf8,0x56,0x71,0xc0,0xa,0xb5,0x81,0xc0,0xc9,0x8e,0x72,0xc0,0x0,0x8a,0xc5,0xbc,0x75,0x23,0xa3,0xbf,0x62,0x74,0x51,0xc0,0xd8,0x8c,0xe5,0xbf,0xde,0xd4,0x71,0x3f,0x71,0x32,0x27,0xc0,0x15,0xd0,0x8d,0x3f,0x1d,0xc3,0x92,0xbf,0x6e,0xf,0x1b,0xc0,0x7a,0xda,0x2f,0x3f,0xb2,0x8f,0x83,0x40,0x6a,0x58,0x58,0xc0,0x80,0xbe,0x6d,0x3e,0xe8,0x2,0xec,0xbf,0x4e,0x2,0x9d,0x40,0x58,0xcd,0x97,0xc0,0xc3,0x62,0x99,0xc0,0x5e,0xa9,0x9d,0x40,0xf6,0x75,0x4a,0xc0,0xe8,0x67,0x75,0x3f,0x90,0xf1,0xdc,0xbe,0xb,0xd2,0x86,0xbf,0x4d,0xf1,0x8e,0xbf,0x4b,0x57,0x4b,0x40,0x70,0xb8,0x74,0x3e,0x41,0xc7,0x9b,0xc0,0x4e,0xea,0x3c,0xc0,0x1b,0x2d,0xda,0xbf,0x7c,0x7,0x21,0x40,0x32,0x15,0x4f,0xc0,0xfd,0xdd,0x96,0x40,0xf9,0x8b,0x8e,0xbf,0xde,0xd6,0x65,0xbf,0x12,0xbd,0x7a,0x40,0xa0,0xd5,0x20,0x40,0x2,0xb3,0x87,0x40,0x2a,0x1a,0x39,0x40 })
    };
    // [[-1.5167695  -3.317362   -0.37201524  4.138188   -1.678099   -4.63685    2.0496
    Tensor2D_F32 w = {
      .shape = { 5, 7 },
      .data = (float *)((uint8_t[]){ 0x81,0x25,0xc2,0xbf,0xa9,0x4f,0x54,0xc0,0xc8,0x78,0xbe,0xbe,0x9,0x6c,0x84,0x40,0xf3,0xcb,0xd6,0xbf,0x13,0x61,0x94,0xc0,0x56,0x2d,0x3,0x40,0x64,0xc1,0x9b,0x40,0x80,0x32,0xb6,0xbf,0xd8,0x7b,0x84,0xc0,0x2a,0x21,0x91,0xc0,0x34,0x62,0xa0,0x3f,0xac,0xd7,0xc1,0xbe,0x8e,0x98,0x21,0xc0,0x49,0x5d,0x81,0x3f,0xb0,0xb,0xf3,0x3f,0x88,0x80,0x7e,0x40,0x3b,0x71,0x78,0x40,0x5c,0x98,0x3f,0xbf,0x2f,0x15,0x8d,0xc0,0x67,0x94,0x90,0xc0,0xed,0x63,0x95,0x40,0x2a,0x75,0xd,0x40,0x88,0x7d,0xb,0x40,0x74,0x6f,0x8a,0xc0,0x9b,0x29,0x94,0x40,0x2c,0x93,0x97,0x40,0x28,0x75,0x90,0x40,0x3e,0xf9,0x86,0xc0,0xaa,0x7c,0xf1,0xbf,0x9c,0x15,0x5c,0xc0,0xb6,0x83,0x97,0x40,0x62,0x7f,0x9,0xc0,0xf2,0x18,0x12,0xc0,0xf2,0xa6,0x27,0x40 })
    };
    // [-2.3129618  -2.4626107  -0.43735743 -0.48059762 -3.8948922 ]
    Tensor1D_F32 b = {
      .shape = { 5 },
      .data = (float *)((uint8_t[]){ 0x91,0x7,0x14,0xc0,0x6a,0x9b,0x1d,0xc0,0x50,0xed,0xdf,0xbe,0xe4,0x10,0xf6,0xbe,0xea,0x45,0x79,0xc0 })
    };

    
    // [[-3.7594921e+01  4.7355175e+01 -8.1492195e+00  1.9515989e+01   -3.5527107e+01] 
    Tensor2D_F32 golden = {
      .shape = { 6, 5 },
      .data = (float *)((uint8_t[]){ 0x33,0x61,0x16,0xc2,0xb3,0x6b,0x3d,0x42,0x34,0x63,0x2,0xc1,0xbf,0x20,0x9c,0x41,0xc2,0x1b,0xe,0xc2,0x42,0x42,0x82,0xc0,0xc0,0xf4,0x19,0x3d,0x76,0x98,0xd1,0x3f,0xbe,0xce,0x8c,0xc1,0xb1,0xf5,0x6,0xc1,0xbc,0x9e,0x30,0xc2,0x0,0x7f,0x7c,0x41,0x35,0xff,0x52,0xc0,0xee,0x47,0x51,0xc0,0x24,0xed,0xab,0xc1,0xe7,0x23,0x3b,0xc0,0x9d,0x8,0xab,0xc1,0x9c,0x45,0xa7,0x40,0x50,0x27,0xc,0xc2,0x5d,0xcf,0xb6,0x41,0xb4,0x11,0x7,0xc2,0xde,0x23,0x4d,0x42,0x29,0x4d,0xb6,0xc1,0xe1,0xb0,0xce,0x40,0xc,0x53,0xcc,0xc1,0xc4,0x9a,0xe5,0xc0,0xbc,0x9c,0x10,0x40,0x4e,0x58,0x9e,0xc1,0x3d,0xc3,0x33,0x42,0x46,0x72,0xf1,0xc0 })
    };
    // 
    Tensor2D_F32 actual = {
      .shape = { 6, 5 },
      .data = (float *)malloc(sizeof(float) * 6*5)
    };

    cycles = read_cycles();
    NN_addmm_f32(&actual, &x, &w, &b);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_relu2d_f32:          ");
    
    // [[ 4.1683407  -2.2056084   1.7735744   4.348918    2.5215821   0.70789933    4.2
    Tensor2D_F32 x = {
      .shape = { 7, 7 },
      .data = (float *)((uint8_t[]){ 0xc,0x63,0x85,0x40,0xb0,0x28,0xd,0xc0,0x7c,0x4,0xe3,0x3f,0x56,0x2a,0x8b,0x40,0x9a,0x61,0x21,0x40,0xe4,0x38,0x35,0x3f,0x1a,0x23,0x88,0x40,0xca,0x10,0x2c,0x3f,0xd4,0xc,0x14,0xc0,0x24,0x5c,0x97,0x40,0xbc,0x79,0x97,0x3f,0xe3,0x1b,0x9c,0xc0,0xde,0x33,0xb6,0xbf,0x3e,0xf9,0x59,0xc0,0xcd,0x47,0x8c,0x40,0x0,0x63,0x53,0xbf,0xf,0xd8,0x91,0xc0,0x20,0xee,0xa0,0xbe,0xd1,0xf6,0x48,0x40,0xb4,0x45,0xa6,0x3f,0xef,0x5e,0xca,0x3f,0x64,0xc1,0xed,0x3e,0x9e,0x9a,0xee,0x3f,0xf1,0xef,0x9b,0xbf,0x96,0x97,0xfe,0xbf,0xa9,0x8d,0x95,0xc0,0x5c,0x11,0x71,0xc0,0x56,0xb0,0xa,0x40,0xee,0x79,0x3d,0xc0,0x18,0xa3,0x37,0x3f,0x54,0x48,0xcc,0x3f,0x8,0x42,0xb5,0x3e,0xd0,0x78,0x4f,0xc0,0x36,0x3,0x99,0x40,0x70,0x14,0x3a,0xc0,0xa0,0x99,0x83,0x40,0xa,0x90,0x7e,0xc0,0x77,0xf3,0x99,0xbf,0xec,0x11,0x2e,0x40,0xee,0xbe,0x2,0xc0,0x29,0x68,0x86,0x40,0xc8,0x35,0x5c,0xc0,0xa,0x5d,0x86,0xc0,0x4c,0x4b,0x10,0xc0,0x9c,0xe9,0x4e,0x3f,0x29,0x52,0x93,0x40,0xae,0xc4,0x18,0xc0,0xcf,0xe1,0xe4,0x3f,0xd7,0x73,0xa0,0xbf })
    };

    
    // [[4.1683407  0.         1.7735744  4.348918   2.5215821  0.70789933   4.254285  
    Tensor2D_F32 golden = {
      .shape = { 7, 7 },
      .data = (float *)((uint8_t[]){ 0xc,0x63,0x85,0x40,0x0,0x0,0x0,0x0,0x7c,0x4,0xe3,0x3f,0x56,0x2a,0x8b,0x40,0x9a,0x61,0x21,0x40,0xe4,0x38,0x35,0x3f,0x1a,0x23,0x88,0x40,0xca,0x10,0x2c,0x3f,0x0,0x0,0x0,0x0,0x24,0x5c,0x97,0x40,0xbc,0x79,0x97,0x3f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xcd,0x47,0x8c,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xd1,0xf6,0x48,0x40,0xb4,0x45,0xa6,0x3f,0xef,0x5e,0xca,0x3f,0x64,0xc1,0xed,0x3e,0x9e,0x9a,0xee,0x3f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x56,0xb0,0xa,0x40,0x0,0x0,0x0,0x0,0x18,0xa3,0x37,0x3f,0x54,0x48,0xcc,0x3f,0x8,0x42,0xb5,0x3e,0x0,0x0,0x0,0x0,0x36,0x3,0x99,0x40,0x0,0x0,0x0,0x0,0xa0,0x99,0x83,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xec,0x11,0x2e,0x40,0x0,0x0,0x0,0x0,0x29,0x68,0x86,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x9c,0xe9,0x4e,0x3f,0x29,0x52,0x93,0x40,0x0,0x0,0x0,0x0,0xcf,0xe1,0xe4,0x3f,0x0,0x0,0x0,0x0 })
    };
    // 
    Tensor2D_F32 actual = {
      .shape = { 7, 7 },
      .data = (float *)malloc(sizeof(float) * 7*7)
    };

    cycles = read_cycles();
    NN_relu2d_f32(&actual, &x);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

  {
    printf("NN_elu2d_f32:           ");
    
    // [[-1.0843116   3.676517   -3.8749294   0.53106666  4.702046   -0.68706095    3.8
    Tensor2D_F32 x = {
      .shape = { 7, 7 },
      .data = (float *)((uint8_t[]){ 0xb9,0xca,0x8a,0xbf,0xe,0x4c,0x6b,0x40,0xd8,0xfe,0x77,0xc0,0xfc,0xf3,0x7,0x3f,0x29,0x77,0x96,0x40,0x3a,0xe3,0x2f,0xbf,0xd0,0x75,0x78,0x40,0xa5,0x17,0xc5,0xbf,0x40,0xcb,0x80,0x40,0xda,0xc5,0x9a,0xc0,0x72,0x7a,0x38,0xbf,0xd2,0xd3,0x60,0xbf,0x16,0x6a,0xcf,0x3f,0xed,0x16,0xfb,0x3f,0x90,0xb3,0x75,0x40,0xba,0xb3,0x3e,0xbf,0xb8,0x8,0x4b,0xbe,0xbc,0x23,0x5b,0x40,0xb4,0x2a,0xad,0xbf,0xea,0x42,0x8c,0x40,0x54,0xf,0x55,0xc0,0x34,0x82,0xa,0xbf,0x0,0x80,0x89,0xbe,0x84,0xc9,0xe,0x40,0xc0,0xc6,0x5a,0x40,0x84,0xe2,0x4a,0xbf,0x91,0x8e,0x84,0xc0,0xb9,0x8e,0x1e,0x40,0xbf,0x71,0xbf,0x3f,0x35,0x8b,0x0,0x40,0xcc,0x65,0x45,0xc0,0x5a,0xf3,0x4d,0x40,0x78,0x8b,0x97,0x40,0x7c,0x22,0xde,0x3e,0xa0,0x72,0x95,0xc0,0x3,0xa3,0x60,0x40,0xb0,0x43,0x6d,0xc0,0x3f,0x1e,0x93,0x3f,0xbc,0x1,0x3a,0x3f,0x8e,0xc5,0x15,0xc0,0x5c,0xd8,0xde,0x3f,0xf6,0x1b,0x8f,0xc0,0x1d,0xc4,0x91,0x3f,0x43,0xdd,0x4a,0xc0,0x3e,0x69,0xa,0xbf,0x1a,0xa5,0x24,0x3f,0xa5,0x4f,0x88,0x40,0xb2,0xad,0x18,0xc0,0xe8,0x0,0x4d,0x40 })
    };

    
    // [[-0.66186553  3.676517   -0.9792442   0.53106666  4.702046   -0.4969476    3.88
    Tensor2D_F32 golden = {
      .shape = { 7, 7 },
      .data = (float *)((uint8_t[]){ 0x5,0x70,0x29,0xbf,0xe,0x4c,0x6b,0x40,0xbf,0xaf,0x7a,0xbf,0xfc,0xf3,0x7,0x3f,0x29,0x77,0x96,0x40,0xea,0x6f,0xfe,0xbe,0xd0,0x75,0x78,0x40,0x49,0x1b,0x49,0xbf,0x40,0xcb,0x80,0x40,0x11,0xf8,0x7d,0xbf,0xec,0x77,0x3,0xbf,0xb0,0xa0,0x15,0xbf,0x16,0x6a,0xcf,0x3f,0xed,0x16,0xfb,0x3f,0x90,0xb3,0x75,0x40,0xa2,0x75,0x6,0xbf,0x30,0x2c,0x38,0xbe,0xbc,0x23,0x5b,0x40,0xc,0xd3,0x3d,0xbf,0xea,0x42,0x8c,0x40,0xf,0xd4,0x76,0xbf,0x20,0xf2,0xd5,0xbe,0x34,0x2b,0x71,0xbe,0x84,0xc9,0xe,0x40,0xc0,0xc6,0x5a,0x40,0xa7,0x1b,0xc,0xbf,0xfc,0xee,0x7b,0xbf,0xb9,0x8e,0x1e,0x40,0xbf,0x71,0xbf,0x3f,0x35,0x8b,0x0,0x40,0xd,0x49,0x74,0xbf,0x5a,0xf3,0x4d,0x40,0x78,0x8b,0x97,0x40,0x7c,0x22,0xde,0x3e,0xee,0x99,0x7d,0xbf,0x3,0xa3,0x60,0x40,0x6f,0xb7,0x79,0xbf,0x3f,0x1e,0x93,0x3f,0xbc,0x1,0x3a,0x3f,0x3a,0x58,0x67,0xbf,0x5c,0xd8,0xde,0x3f,0x69,0x13,0x7d,0xbf,0x1d,0xc4,0x91,0x3f,0x94,0x3e,0x75,0xbf,0xe,0xd5,0xd5,0xbe,0x1a,0xa5,0x24,0x3f,0xa5,0x4f,0x88,0x40,0x7c,0x70,0x68,0xbf,0xe8,0x0,0x4d,0x40 })
    };
    // 
    Tensor2D_F32 actual = {
      .shape = { 7, 7 },
      .data = (float *)malloc(sizeof(float) * 7*7)
    };

    cycles = read_cycles();
    NN_elu2d_f32(&actual, &x, 1.0);                          
    cycles = read_cycles() - cycles;
    printf("%s  (%lu cycles)\n", NN_equals2d_f32(&golden, &actual, 1e-4) ? "PASS" : "FAIL", cycles);

    
      // NN_free_tensor_data(actual);
  }

}