
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <rv.h>

#include "nn.h"
#include "unittest.h"

int main() {
  enableAcceleratorFeatures();

  size_t cycles;

  
  {
    printf("abs:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 270.78546, -342.30972, -346.894, -277.83466, -312.47675, 38.64157, -385.70117, 450.95782, 323.79, 396.93256, 64.317825, -399.80017, -425.97968, 131.9303, -133.14676, 178.21658, -417.45465, -353.41824, 230.87204, -177.59508, -369.2398, 420.13324, 122.92027, 40.424168, 374.45386, 165.95369, -30.198336, -464.07962, -7.2573423, 144.39774, 455.37454, -458.8446, 495.75104, -180.2013, -318.14838, -142.82239, -465.22534, -22.005379, -298.34085, 147.7505, -325.45197, 239.75063, 249.79228, 102.69195, 499.33344, 162.11516, 379.8337, 194.10866, 253.49236 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 270.78546, 342.30972, 346.894, 277.83466, 312.47675, 38.64157, 385.70117, 450.95782, 323.79, 396.93256, 64.317825, 399.80017, 425.97968, 131.9303, 133.14676, 178.21658, 417.45465, 353.41824, 230.87204, 177.59508, 369.2398, 420.13324, 122.92027, 40.424168, 374.45386, 165.95369, 30.198336, 464.07962, 7.2573423, 144.39774, 455.37454, 458.8446, 495.75104, 180.2013, 318.14838, 142.82239, 465.22534, 22.005379, 298.34085, 147.7505, 325.45197, 239.75063, 249.79228, 102.69195, 499.33344, 162.11516, 379.8337, 194.10866, 253.49236 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_abs(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 271.7216, 38.44422, 405.03348, 415.46143, -412.38766, 33.480167, -233.796, -185.89104, 352.96393, 76.57212, 176.74196, 77.93414, -325.15292, -433.2037, 199.35555, -414.66302, -266.473, -497.1075, -230.42363, -274.7704, 107.44983, 173.85501, -378.15656, -320.86145, 52.718224, -318.29178, 122.94328, 173.99841, 274.11264, -188.7027, -260.94687, -30.882597, -30.0799, 282.62775, 99.25401, 353.4572, -173.52867, -405.24585, -140.94019, -107.96416, -323.19067, -267.03806, -297.5699, -204.44072, 109.12597, -215.86043, -145.5937, 205.24, 281.4678 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -134.97377, 219.42615, -221.13513, 2.2319555, 184.19171, 218.74434, -262.257, 496.8455, -162.606, 141.17145, 240.31108, 453.44733, -153.16641, -487.5955, 280.20602, -87.38571, 39.499046, -385.14322, 13.4676695, -278.71155, 161.0977, -47.22202, -474.42276, -372.41174, -469.98083, 411.33554, 300.7653, 274.92136, -108.522415, -86.840454, -394.65033, -99.12991, 450.99615, 6.638229, 492.17343, 183.35014, 204.64569, 43.587326, -104.35528, -188.26556, -129.26096, 279.1289, 383.8576, -151.3316, -386.0041, 327.2206, -381.47742, 40.894985, -370.00632 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 136.74782, 257.87036, 183.89835, 417.6934, -228.19595, 252.2245, -496.05298, 310.95447, 190.35793, 217.74356, 417.05304, 531.3815, -478.31934, -920.7992, 479.56158, -502.04874, -226.97394, -882.25073, -216.95596, -553.48193, 268.54755, 126.632996, -852.57935, -693.2732, -417.2626, 93.04376, 423.70856, 448.91977, 165.59023, -275.54315, -655.59717, -130.01251, 420.91626, 289.26596, 591.4274, 536.8074, 31.11702, -361.6585, -245.29547, -296.22974, -452.45163, 12.090851, 86.28772, -355.77234, -276.8781, 111.36018, -527.0711, 246.135, -88.53851 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("addInplace:             ");

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -27.260662, 239.37457, -238.2108, -342.7368, 401.54504, -105.928894, -275.93613, 294.04688, 104.31909, 106.93949, 29.67, 398.8725, 470.13837, 3.6094189, -313.45517, -474.19934, 32.62359, 22.483707, 464.61194, -404.25824, -356.94086, -467.40692, -53.18862, -39.08932, -343.74255, -76.35248, 479.35086, -328.7642, -220.82, 186.94734, 247.29228, 244.38715, 204.83952, -86.96848, -115.64827, -15.296102, 76.557816, -376.2995, 14.632643, -100.29012, 338.4465, 338.0835, 198.55893, -436.02652, -310.36264, 204.20862, 321.72476, 288.5011, 213.51164 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -27.260662, 239.37457, -238.2108, -342.7368, 401.54504, -105.928894, -275.93613, 294.04688, 104.31909, 106.93949, 29.67, 398.8725, 470.13837, 3.6094189, -313.45517, -474.19934, 32.62359, 22.483707, 464.61194, -404.25824, -356.94086, -467.40692, -53.18862, -39.08932, -343.74255, -76.35248, 479.35086, -328.7642, -220.82, 186.94734, 247.29228, 244.38715, 204.83952, -86.96848, -115.64827, -15.296102, 76.557816, -376.2995, 14.632643, -100.29012, 338.4465, 338.0835, 198.55893, -436.02652, -310.36264, 204.20862, 321.72476, 288.5011, 213.51164 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_addInplace(actual, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 93.112885, 371.0463, 62.76685, 52.273335, 147.00383, -355.98355, -391.41382, 404.48987, 203.76653, 427.8432, -347.43607, 430.36176, -467.92896, 0.20945072, 9.782732, -347.71085, -47.37747, 242.13547, -244.63046, -305.50217, 306.55765, -324.80682, 54.39955, 457.56186, 71.67322, -23.632288, 244.05199, 465.94537, 409.26135, 296.5936, 14.5054455, -395.21545, 423.97977, -403.7655, -246.30844, -178.84589, -192.21646, 201.28781, -69.75526, -68.65293, 76.87187, -287.50348, 261.8544, 418.04636, -439.9857, -265.19214, -420.2473, 147.67819, 350.8879 });

    float v = 0.23665990917833257;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 93.34954, 371.28296, 63.00351, 52.509995, 147.2405, -355.7469, -391.17715, 404.72653, 204.00319, 428.07986, -347.1994, 430.59842, -467.6923, 0.44611064, 10.019392, -347.47418, -47.14081, 242.37213, -244.3938, -305.2655, 306.7943, -324.57016, 54.63621, 457.79852, 71.909874, -23.395628, 244.28865, 466.18204, 409.49802, 296.83026, 14.7421055, -394.9788, 424.21643, -403.52884, -246.07178, -178.60922, -191.9798, 201.52448, -69.5186, -68.416275, 77.10853, -287.2668, 262.09106, 418.28302, -439.74902, -264.95547, -420.01065, 147.91486, 351.12457 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("clip:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 406.5059, 466.06458, 355.08484, 487.33932, -465.37607, 426.18597, 128.28893, 313.7896, 315.20642, 107.45424, -263.35764, 267.51572, 25.552929, 364.26706, -290.88135, 418.62756, 417.6385, 364.40082, -170.63695, -248.92664, -207.6078, 217.93997, 479.84277, 426.14746, -210.43437, 205.81221, -268.3248, -45.86023, 66.280426, 432.85352, -166.3587, -233.46407, 172.32704, -193.40884, -303.32452, -429.59845, 445.8521, 156.33374, 43.275475, 393.7108, -1.1419654, -212.14967, 148.60153, -64.91655, 137.78186, -110.195335, -218.66292, -209.5117, -135.85628 });

    float v_min = -0.7025261875880071;
    float v_max = 0.9500099369496466;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.95000994, 0.95000994, 0.95000994, 0.95000994, -0.7025262, 0.95000994, 0.95000994, 0.95000994, 0.95000994, 0.95000994, -0.7025262, 0.95000994, 0.95000994, 0.95000994, -0.7025262, 0.95000994, 0.95000994, 0.95000994, -0.7025262, -0.7025262, -0.7025262, 0.95000994, 0.95000994, 0.95000994, -0.7025262, 0.95000994, -0.7025262, -0.7025262, 0.95000994, 0.95000994, -0.7025262, -0.7025262, 0.95000994, -0.7025262, -0.7025262, -0.7025262, 0.95000994, 0.95000994, 0.95000994, 0.95000994, -0.7025262, -0.7025262, 0.95000994, -0.7025262, 0.95000994, -0.7025262, -0.7025262, -0.7025262, -0.7025262 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_clip(actual, a, v_min, v_max);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("div:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 351.51654, -223.51015, 121.82742, 26.446045, 462.60535, -211.79741, 291.47446, 186.60658, -96.60548, -222.71638, 216.05807, 397.4328, -18.286884, -255.4422, -342.85443, 96.99995, 385.6098, -85.24102, -211.3527, -331.18494, -57.463108, 105.86262, 366.42743, -180.07713, -74.404236, 394.1419, 84.11229, 277.23788, -271.89297, -247.44446, -316.88666, 206.14558, -371.5555, -416.60022, -206.1984, -456.39093, -293.44238, -471.7793, 68.786385, -251.36316, -166.56082, -310.2495, 159.19763, 124.79448, -387.9171, 303.10452, 22.05336, 94.97738, 349.25223 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -404.99002, 432.28836, -159.57898, -10.339319, 425.84097, 82.21626, -330.75815, -483.06482, 446.1715, 403.52255, 11.558056, 412.542, 157.49484, 253.05498, -87.25232, -85.67857, -11.059046, 480.3288, 44.78961, 397.63177, -8.426607, 370.19937, 179.39282, -481.75812, 191.0398, 415.51154, -455.39206, -161.52913, -464.5078, -145.60693, 82.40145, 256.25867, -143.28825, 111.09179, -63.33506, -20.814777, 337.14468, 414.33835, 327.59488, 155.75684, -348.1027, 313.4645, 96.66973, -419.2168, 130.15205, -359.0365, 126.60557, 303.1612, -353.60355 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.86796343, -0.5170395, -0.7634303, -2.557813, 1.0863336, -2.576101, -0.88123137, -0.3862972, -0.21652095, -0.5519304, 18.693289, 0.9633754, -0.116111, -1.0094336, 3.9294593, -1.1321378, -34.86827, -0.1774639, -4.7187886, -0.83289355, 6.8192463, 0.2859611, 2.042598, 0.3737916, -0.38946983, 0.9485703, -0.18470302, -1.7163336, 0.5853356, 1.6994002, -3.8456442, 0.80444336, 2.5930634, -3.7500541, 3.2556753, 21.926294, -0.8703752, -1.1386329, 0.20997393, -1.6138178, 0.47848186, -0.98974365, 1.6468198, -0.29768482, -2.9804916, -0.84421647, 0.1741895, 0.31329003, -0.9876944 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_div(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("fill:                   ");

    float v = 0.7923560563192711;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561, 0.7923561 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_fill(actual, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmulT:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -406.0452, 244.0452, -131.05714, 13.126432, -164.5314, 267.07632, 259.55713, 192.9617, 91.12114, 97.12732, 400.3676, -198.5634, 314.2839, -253.50076, 84.10555, 457.61896, -99.621895, 205.11806, 312.69104, 78.760864, -207.04085, 60.070694, -289.39987, 163.83386, 25.435389, 216.61276, -313.97815, 163.5468, 56.45895, -485.76062, 484.02487, -65.02348, -99.80982, 229.8215, 373.6723, 112.79464, 1.804471, 314.578, 381.51144, 17.284752, 127.051476, 153.00185 });

    Tensor *b = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ -68.10468, -212.90248, 112.20211, -341.7259, -330.9537, -418.16656, -414.6245, -422.67578, -38.652897, -299.349, 168.8158, 68.24553, 228.83308, 42.665718, -484.81738, -258.21024, 52.780926, -250.4704, -288.1444, 369.83627, -134.94998, -135.3606, 211.65413, -438.92896, 432.56058, -492.56616, -291.64218, -405.94907, 419.918, 343.7363, -466.81207, 28.690279, 463.46915, 113.321365, -175.89188 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -208343.64, 264601.75, 234793.77, 67603.336, -116706.6, -119059.68, 982.786, -4574.9204, 232773.56, 66671.984, -235005.36, 41740.516, -248603.28, 124982.32, 435272.03, 59009.285, -109041.78, -152727.72, -211811.48, -113956.01, -41901.586, -99234.94, 203218.72, -520589.3, -457020.66, -225429.48, -40727.637, -112744.19, -95615.02, -92421.57 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmulT(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmul:                 ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ 39.224445, -402.96722, 171.50116, -41.907787, -440.5789, -357.76056, 136.0777, -426.35388, 11.959017, 282.13394, -0.69510937, 78.06504, -329.34357, 398.07416, -4.139304, 141.11131, 288.5446, -104.20513, -174.67302, -325.06992, -496.20987, -178.3684, 30.57021, -168.23894, -154.64848, -356.8731, -350.5366, 238.1972, 80.38616, 44.725597, 141.45428, -290.71622, -341.17682, -495.4213, 258.43936, 430.18646, 389.20398, -412.1484, -253.8324, -390.09775, -117.688354, -219.38545 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 5 }, DTYPE_F32, (float[]){ -340.32108, 323.86417, -214.5254, 11.61921, -367.1249, 265.9081, 385.3472, 106.508255, -72.40778, -376.8882, -425.5697, -393.19647, -272.60583, 238.57838, -93.868614, 396.2158, 406.22003, 417.88965, -136.5767, 185.4906, 398.25772, 382.4658, -218.06895, -475.14832, 484.59286, 132.00444, 359.85147, 401.26862, 194.68529, 162.26547, -349.7461, 150.87735, 83.812, -387.31808, -154.20955 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -480373.97, -503752.34, -151675.6, 163258.06, -178936.81, -123675.54, -273286.0, -100279.766, -193805.97, 48407.29, -64080.3, -361398.84, -240225.61, 284707.16, -158950.53, -192553.78, -269351.66, -20115.154, -14237.554, -225481.98, -482511.47, -400218.88, -275266.4, 36708.652, -399147.0, -62249.17, 123594.47, -25095.922, 160568.97, -487318.28 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("max:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -30.954956, -361.59308, 211.63284, 136.73514, -71.764946, 26.892721, 381.61807, 312.74365, 59.544147, -139.35828, -313.58176, 281.3558, -142.63362, -194.83226, 1.4913082, 290.23044, 216.30591, 86.9689, -67.72637, 306.85092, -412.9505, -95.85315, -490.29224, 482.27472, 9.67288, 306.212, -222.18156, -63.35747, -422.22958, -467.97418, 425.58688, -85.11978, 317.4005, 405.4007, 9.23115, 183.4526, -89.7857, -124.970375, -443.62933, 23.221016, 98.849, 467.96423, 35.56025, -332.9547, -185.05544, -28.439404, 359.1603, 409.3945, 337.124 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ 482.27472 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_max(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("maximum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 15.326082, -496.3664, -251.71577, -289.68085, 296.91284, -145.15573, -185.47011, 137.94923, 152.13751, -311.19476, -305.96487, -448.64816, -112.537025, 437.90555, 3.8016438, 491.20242, -11.300921, 317.71832, 171.22209, 325.25677, -72.48575, -266.613, 324.34702, -280.30307, 248.80869, 5.1492453, -388.89056, 447.95053, 417.1735, 36.5749, 307.56442, 419.25113, 278.8261, -235.37749, -345.51303, 209.49454, -134.87416, -318.3191, 99.14923, 400.46085, -463.50623, -440.68033, -376.66602, -121.07086, 496.5749, -134.54187, -7.989943, 30.207932, 235.09438 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 408.35428, 180.88579, 170.56816, -295.06885, -284.43384, 242.83308, 35.337685, -37.15092, -104.02113, -305.94553, -111.137985, -40.881393, -61.851086, -420.72635, 233.05684, -287.9391, -423.87878, 19.729256, -93.144356, -305.58597, 235.28784, 467.52637, -422.71848, 213.84602, 104.81328, 83.600105, -495.10367, -90.80398, 306.74, -195.56296, -400.17188, 382.2508, -248.99136, -369.11374, 384.21075, -113.530876, 355.31622, 420.79218, -268.84293, -306.01532, 28.371275, -200.9067, 77.454506, -259.4737, -63.053787, 278.15222, 462.20972, -339.06244, 130.07771 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 408.35428, 180.88579, 170.56816, -289.68085, 296.91284, 242.83308, 35.337685, 137.94923, 152.13751, -305.94553, -111.137985, -40.881393, -61.851086, 437.90555, 233.05684, 491.20242, -11.300921, 317.71832, 171.22209, 325.25677, 235.28784, 467.52637, 324.34702, 213.84602, 248.80869, 83.600105, -388.89056, 447.95053, 417.1735, 36.5749, 307.56442, 419.25113, 278.8261, -235.37749, 384.21075, 209.49454, 355.31622, 420.79218, 99.14923, 400.46085, 28.371275, -200.9067, 77.454506, -121.07086, 496.5749, 278.15222, 462.20972, 30.207932, 235.09438 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_maximum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("min:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -497.69574, -492.2893, -97.11009, -252.03229, 75.72347, 498.29602, -58.478832, -346.8349, -432.6198, 249.68141, 294.4948, -418.81116, 241.95706, -347.43237, 104.49964, 145.53242, 318.85297, 240.34143, -27.720093, -302.30255, 189.91565, 136.89857, 38.02216, -10.210096, -176.64362, 72.4479, -308.84872, -495.4781, 290.80255, 20.699203, 176.83089, 30.77358, -277.8281, -89.78623, -361.55838, 223.73546, 165.03954, -391.72614, -364.907, -449.46228, 227.01228, 58.996796, -245.05984, 336.37082, 375.6106, -183.83527, -226.29588, -456.3501, 436.84412 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -497.69574 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_min(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("minimum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 442.33942, -331.25067, 278.4906, -94.01012, -63.10141, -364.41153, 245.19492, -259.94403, 80.72173, -480.0293, 454.91104, 161.06963, -167.77325, 305.7068, 250.53365, -131.97243, 60.874878, 362.855, -442.25406, 476.12112, -75.67573, -412.43863, -354.40182, 420.2962, 11.761546, -301.83978, 215.73561, -416.91138, -332.35855, -220.34824, -414.59442, -135.19424, -172.34433, 173.31624, 480.6029, -24.615229, 96.37553, -385.34714, 174.87604, -427.91443, 312.1381, -205.27286, -48.914074, -340.58148, -137.5919, -406.49664, -190.53156, 279.76804, -185.36908 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -422.99463, 49.940765, 495.61566, -486.00958, 188.27254, -79.706726, 271.46524, 246.06264, 402.91095, -21.744133, -478.18155, 304.95746, -158.3181, 466.1567, 285.95966, -215.49022, -389.40244, -335.06332, 211.67398, 385.43063, -182.7135, -492.1313, 226.21918, -283.6805, -150.39098, -468.5722, -215.97522, -144.24158, -77.99828, 492.27054, -415.15213, -497.03662, -273.0791, 251.31398, -313.67773, -239.13818, -48.743607, -427.89722, -79.965294, 37.285923, 35.084427, 158.06454, -463.38873, -174.03268, -302.04565, -196.60931, -352.26886, -39.020477, 492.82117 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -422.99463, -331.25067, 278.4906, -486.00958, -63.10141, -364.41153, 245.19492, -259.94403, 80.72173, -480.0293, -478.18155, 161.06963, -167.77325, 305.7068, 250.53365, -215.49022, -389.40244, -335.06332, -442.25406, 385.43063, -182.7135, -492.1313, -354.40182, -283.6805, -150.39098, -468.5722, -215.97522, -416.91138, -332.35855, -220.34824, -415.15213, -497.03662, -273.0791, 173.31624, -313.67773, -239.13818, -48.743607, -427.89722, -79.965294, -427.91443, 35.084427, -205.27286, -463.38873, -340.58148, -302.04565, -406.49664, -352.26886, -39.020477, -185.36908 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_minimum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -471.30334, -60.792507, -162.47505, -208.96959, 1.8541813, 155.65575, 247.92921, 354.40402, 432.9687, -494.81015, -481.97092, -426.7891, -40.75724, -264.4672, -223.03099, -45.64744, -137.7759, 499.96292, 486.2122, -45.125008, 186.3296, -467.99405, 303.57068, 401.2358, 40.307343, 324.41855, -433.67236, 234.70378, 481.4954, 144.11801, -161.48723, -176.73714, 270.0327, -23.27627, 235.58504, 401.92776, -392.05014, 402.55988, -457.8556, -450.2449, -440.91742, 194.7115, 489.39026, 465.24072, -18.153429, 488.52872, -57.4888, -370.9942, -317.13992 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 314.65506, 345.00784, -456.79224, -408.7575, 345.22403, 336.41302, -405.54166, -232.43004, 20.94847, -15.188276, 80.07836, -139.61804, -345.98972, -250.90933, -478.92368, -166.92883, -175.24313, -449.47565, -42.360188, 112.499596, 136.30414, 339.8647, 362.705, 70.01096, 144.34964, -167.04547, -279.04218, 321.62238, 479.59937, -69.91911, -402.6193, -420.2913, 18.021345, -299.12686, 396.6312, 340.6511, -27.382015, 121.36436, -145.40154, 396.92694, -172.7445, -210.30717, 392.65503, -321.34158, -388.70294, 332.05365, 132.90173, 357.38403, -399.60635 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -148297.98, -20973.893, 74217.34, 85417.89, 640.1079, 52364.62, -100545.625, -82374.14, 9070.031, 7515.3135, -38595.44, 59587.457, 14101.586, 66357.29, 106814.82, 7619.874, 24144.28, -224721.16, -20596.04, -5076.545, 25397.496, -159054.66, 110106.6, 28090.906, 5818.3506, -54192.65, 121012.88, 75485.984, 230924.89, -10076.604, 65017.875, 74281.08, 4866.3525, 6962.5576, 93440.375, 136917.12, 10735.123, 48856.42, 66572.91, -178714.33, 76166.06, -40949.227, 192161.55, -149501.19, 7056.2915, 162217.75, -7640.3613, -132587.4, 126731.125 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -210.28513, -341.28757, -102.45341, -10.852873, 277.63046, -81.240654, -257.22897, -166.57347, 323.45813, 408.5167, -412.40393, -314.08774, -439.58752, 361.8409, -404.54388, 152.9147, 192.92212, 406.04025, -473.75195, 114.55148, -285.8042, 201.75206, -355.72372, 222.59843, 131.61671, -17.975748, 262.54886, -246.17636, 386.06757, 336.03613, -87.697266, 297.35483, -139.27531, 223.19966, -130.04297, -105.28833, 446.97238, 410.18015, 251.56569, -71.66046, 119.0083, -52.224754, -25.98536, -250.72563, -395.05713, 309.2069, -17.891586, -497.13803, -466.4229 });

    float v = 0.23148290276697314;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -48.677414, -79.002235, -23.716213, -2.5122545, 64.26671, -18.805822, -59.54411, -38.55891, 74.87503, 94.56463, -95.46446, -72.70594, -101.756996, 83.75999, -93.645, 35.39714, 44.658173, 93.99138, -109.66548, 26.51671, -66.15879, 46.702152, -82.34396, 51.527733, 30.46702, -4.1610785, 60.775574, -56.98562, 89.36804, 77.78662, -20.300419, 68.83256, -32.239853, 51.66691, -30.102724, -24.372448, 103.46647, 94.94969, 58.23316, -16.588173, 27.548388, -12.089138, -6.0151663, -58.0387, -91.448975, 71.57611, -4.1415963, -115.07896, -107.96893 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("neg:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 294.01028, 450.80734, 431.76675, 367.0501, -80.10906, 10.561705, 484.6072, -114.74425, -246.79303, -456.4199, 47.39815, 396.56372, 395.73306, 376.43057, 328.80832, -135.83208, 301.21524, -246.46872, -429.50534, 276.83447, 236.59753, 130.09262, 484.67572, 66.37842, 103.230896, -36.594868, 343.9924, 21.783888, -411.50516, 49.367607, -246.90169, 344.92694, 95.04354, -396.88416, -306.31644, -40.235638, 412.64862, -472.42218, -450.16522, -163.58989, -322.65848, 177.52463, 204.69165, -454.14377, -464.36835, 439.69876, 161.75908, -110.34888, 110.86279 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -294.01028, -450.80734, -431.76675, -367.0501, 80.10906, -10.561705, -484.6072, 114.74425, 246.79303, 456.4199, -47.39815, -396.56372, -395.73306, -376.43057, -328.80832, 135.83208, -301.21524, 246.46872, 429.50534, -276.83447, -236.59753, -130.09262, -484.67572, -66.37842, -103.230896, 36.594868, -343.9924, -21.783888, 411.50516, -49.367607, 246.90169, -344.92694, -95.04354, 396.88416, 306.31644, 40.235638, -412.64862, 472.42218, 450.16522, 163.58989, 322.65848, -177.52463, -204.69165, 454.14377, 464.36835, -439.69876, -161.75908, 110.34888, -110.86279 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_neg(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sub:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 305.92197, 406.96924, 277.26947, -374.33813, -273.20093, 434.3794, -58.66629, -494.62747, 315.91116, 65.240265, 479.3077, -236.11325, -316.7398, 166.82166, 156.75569, -226.8064, -319.6265, -330.8936, 434.0529, -319.17252, -460.13492, 362.49078, 367.71457, -14.796376, 149.6166, 413.1887, 79.61303, -451.42722, 162.90659, 360.3979, 304.96466, -167.66911, -14.459968, 137.75278, 464.13922, 295.91315, 5.107343, -284.56558, -301.43768, 236.4949, 298.16412, -439.8583, -308.49545, 270.09244, -334.20557, 52.787483, -407.2764, 286.02237, -325.6287 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 152.98808, -5.7484508, -172.49954, 44.747173, -108.38467, 411.61942, -388.86868, -19.250095, -237.27864, 243.87073, 418.86038, 448.49265, 102.42265, 88.86337, 495.07355, 441.80423, 341.0831, 374.17673, -385.2024, -391.9791, 272.17126, -439.74905, -445.40244, 469.37662, -92.675804, 274.56064, -276.1876, -37.997723, 244.48795, 13.167262, 329.13895, -425.20975, -301.65656, -408.22845, -51.285564, -279.06223, -361.239, -194.05359, 198.01921, -481.62674, -378.75516, -160.3371, -339.11472, -345.41064, 234.78096, 191.83981, -137.12645, -192.10666, -52.702366 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 152.93388, 412.71768, 449.769, -419.0853, -164.81625, 22.75998, 330.2024, -475.37738, 553.1898, -178.63046, 60.447327, -684.6059, -419.16248, 77.95828, -338.31787, -668.6106, -660.7096, -705.0703, 819.25525, 72.80658, -732.30615, 802.23987, 813.117, -484.173, 242.29239, 138.62805, 355.80063, -413.4295, -81.58136, 347.23062, -24.174286, 257.54065, 287.1966, 545.9812, 515.4248, 574.97534, 366.34634, -90.51199, -499.4569, 718.12164, 676.9193, -279.5212, 30.619263, 615.50305, -568.9865, -139.05234, -270.14996, 478.12903, -272.92633 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sub(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sum:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 82.102, 135.49911, -29.208422, 498.88904, 202.56508, -464.80865, -76.00445, -99.74265, -253.98236, -338.3839, -158.87827, 387.94302, -205.45322, -397.32297, -159.61212, -431.69202, 158.12993, 289.9434, -228.02425, -424.59805, -383.66992, 438.5411, 336.77603, -279.43588, -267.99725, 42.331577, -5.6610107, 490.65982, 315.22183, -413.1933, -167.4921, 344.76102, 368.274, -487.48862, -427.95258, -75.93077, -377.32596, -272.7623, 354.79825, 180.64671, 92.725395, 263.0776, 267.907, -497.9225, -432.10745, 170.47429, -234.92116, -244.6456, 146.3154 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -2268.6362 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sum(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Linear:                 ");

    Tensor *x = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ 453.36594, 486.242, 188.13843, 313.97302, 345.9934, -257.30878, 24.731636, 43.34241, 347.35025, -444.1362, -385.6104, -96.024155, 455.57617, -205.14584, -480.85208, 442.11017, -356.34406, 285.48038, -280.68942, 326.9582, -471.29053, 497.6664, -407.81046, 378.713, -135.3106, 456.29413, 363.4013, -453.32336, -319.0362, 37.30452, -333.37247, 257.08002, 128.87979, -118.46447, 483.61475, 152.95833, -247.30032, 349.618, -408.92834, -325.198, -261.00552, 174.25763 });

    Tensor *w = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ 190.33295, -401.14462, 205.73795, 468.44302, 104.873535, -389.83517, -270.15454, -106.77683, -12.281418, -309.80325, -100.542305, 199.28938, -472.41873, 67.92021, -312.23785, -362.85626, -358.1047, -369.67343, -401.68826, -101.64535, -17.379045, 275.98883, -253.57056, -208.02516, 100.804565, -121.20682, 24.062157, 155.2775, 425.7368, 183.1662, 432.34723, -459.06894, 115.034164, -248.23726, 400.65176 });

    Tensor *b = NN_tensor(2, (size_t[]){ 1, 5 }, DTYPE_F32, (float[]){ 367.9917, -51.772354, -286.16428, 282.2085, -75.21045 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ 207302.98, 47904.113, -614977.94, -49666.023, 332791.78, -534981.3, -80873.555, 157569.48, -31566.957, -139328.28, -237661.73, -114853.71, 99212.04, -172919.48, -711206.94, 301865.53, -263437.44, -305645.78, 31666.893, 143609.89, -94432.66, 225484.64, 62006.527, 54660.02, -153223.83, 29622.236, -10214.173, 221788.78, 51448.04, 455829.44 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Linear(actual, x, w, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU:                   ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -438.8588, 243.51323, 210.84607, 335.06268, -442.24448, -65.816284, 430.8173, 491.51022, -35.06416, -316.4633, 309.64465, 279.68024, 479.00623, -75.66744, 397.77774, -130.74338, 495.0434, -483.04688, 358.62302, -249.19366, 1.4958978, 166.87119, -221.51375, -195.11914, 2.1055937, 254.77881, -219.19525, -484.44916, 50.388992, -13.210058, 239.48204, 13.10581, 296.76593, -299.52734, 402.04633, -54.551422, 61.99795, 3.0269027, -148.53412, -424.3905, 489.9808, -447.61996, -369.95023, -84.87403, -367.29544, 442.16837, -220.30849, -21.587254, 2.0916462 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.0, 243.51323, 210.84607, 335.06268, 0.0, 0.0, 430.8173, 491.51022, 0.0, 0.0, 309.64465, 279.68024, 479.00623, 0.0, 397.77774, 0.0, 495.0434, 0.0, 358.62302, 0.0, 1.4958978, 166.87119, 0.0, 0.0, 2.1055937, 254.77881, 0.0, 0.0, 50.388992, 0.0, 239.48204, 13.10581, 296.76593, 0.0, 402.04633, 0.0, 61.99795, 3.0269027, 0.0, 0.0, 489.9808, 0.0, 0.0, 0.0, 0.0, 442.16837, 0.0, 0.0, 2.0916462 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU6:                  ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -490.93097, 189.7347, -382.17975, 401.83334, 453.5122, 211.41959, -362.08392, 13.859391, 362.57028, -180.0267, 191.48755, 458.74976, -488.87766, 123.56186, -288.37704, 372.67673, 170.41832, 256.05624, -318.5134, -257.70312, -274.07156, -119.35669, -386.15387, 94.72591, -232.86372, -221.97646, -491.90228, 230.07977, -291.36227, 22.92043, 107.59854, -281.96274, -297.55438, -321.7908, 56.819557, 195.72974, -473.48267, -33.805252, -439.11774, 416.18015, 228.83534, -327.358, -76.75904, -106.636345, 95.04223, -56.043686, 53.42245, -456.12766, 194.97693 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.0, 6.0, 0.0, 6.0, 6.0, 6.0, 0.0, 6.0, 6.0, 0.0, 6.0, 6.0, 0.0, 6.0, 0.0, 6.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 6.0 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU6(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

}