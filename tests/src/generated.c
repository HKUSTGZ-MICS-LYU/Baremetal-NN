
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <rv.h>

#include "nn.h"
#include "unittest.h"

int main() {
  enableAcceleratorFeatures();

  size_t cycles;

  
  {
    printf("abs:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 313.66675, 225.77042, 49.330593, -220.51758, 227.3664, -24.21111, -456.00717, 365.35382, 134.44925, -158.56517, 203.13388, 25.55597, 442.78143, 197.371, -96.87406, 292.777, 69.86904, 113.20841, -264.1225, 378.63898, 151.21747, -243.22343, 406.21884, 383.9005, 269.73987, 161.78888, -366.1366, -222.66888, 116.19615, -405.16663, 311.46442, -153.36758, -236.66423, 306.03854, -294.2484, 328.94135, 244.73912, 181.21779, -369.3003, 140.97989, 145.3516, -48.393906, -493.8953, -153.59288, -209.2787, -54.612816, -244.05139, -87.81999, -171.8297 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 313.66675, 225.77042, 49.330593, 220.51758, 227.3664, 24.21111, 456.00717, 365.35382, 134.44925, 158.56517, 203.13388, 25.55597, 442.78143, 197.371, 96.87406, 292.777, 69.86904, 113.20841, 264.1225, 378.63898, 151.21747, 243.22343, 406.21884, 383.9005, 269.73987, 161.78888, 366.1366, 222.66888, 116.19615, 405.16663, 311.46442, 153.36758, 236.66423, 306.03854, 294.2484, 328.94135, 244.73912, 181.21779, 369.3003, 140.97989, 145.3516, 48.393906, 493.8953, 153.59288, 209.2787, 54.612816, 244.05139, 87.81999, 171.8297 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_abs(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 404.2272, -111.72742, -192.47353, -236.75638, 208.6435, -19.40614, -434.98175, -88.26315, -9.816944, -406.58243, 293.00302, -325.8649, 214.07568, 52.882313, 28.660477, 264.3636, -229.61438, 37.337364, -111.556114, 394.70642, 329.86908, 104.14213, 6.7182183, 115.780655, -189.3537, -437.3698, 155.04175, 207.27354, 334.99997, -159.16705, 341.63065, 220.87723, -304.3502, 497.18707, -155.02107, 9.322823, -24.558306, 177.57082, 193.18402, 90.471146, -71.195305, 47.829212, -396.26062, 136.79945, -64.15838, 433.46124, 385.03558, -214.04416, -336.4852 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -357.06424, 65.68444, 433.52063, 30.412256, -82.50374, -319.2911, 411.71216, 471.96185, -188.78471, 55.10682, 286.79733, 136.99585, 255.14484, -460.52502, 336.37582, -185.09245, -137.83067, 306.13773, 331.4389, -368.10803, -182.35838, 233.65831, -4.1912794, 381.48492, 371.0649, 220.76566, 179.50743, 423.71576, -319.80145, -350.60394, 80.441956, -85.1416, 211.07774, 234.70444, 399.09406, 214.72198, -46.715736, -198.59117, 93.96392, 447.41064, 318.53992, -90.243576, 291.24902, 355.1761, -90.98625, 299.06534, -136.95801, -424.4988, 408.69678 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 47.162964, -46.042976, 241.0471, -206.34412, 126.139755, -338.69724, -23.269592, 383.6987, -198.60165, -351.47562, 579.80035, -188.86905, 469.22052, -407.6427, 365.03632, 79.27113, -367.44507, 343.4751, 219.88278, 26.598389, 147.5107, 337.80045, 2.526939, 497.26556, 181.71121, -216.60416, 334.5492, 630.9893, 15.198517, -509.771, 422.0726, 135.73563, -93.272446, 731.8915, 244.07298, 224.0448, -71.27404, -21.020355, 287.14795, 537.8818, 247.3446, -42.414364, -105.0116, 491.97552, -155.14462, 732.5266, 248.07758, -638.54297, 72.21158 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("addInplace:             ");

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 427.7318, -384.1275, 368.19995, -466.51865, -169.63696, 1.7852187, 361.30112, 485.62247, -286.85153, 405.34805, 200.66559, -337.6274, -292.07693, 148.82266, -21.879137, -40.98153, -28.908073, 215.52039, -366.23978, -38.76084, -132.39354, -197.59203, 233.83885, -434.7703, -200.39314, 483.36642, -302.71548, 185.99535, 79.268394, 409.75784, 296.40555, 389.16486, 245.44942, -408.70636, -102.0658, -51.499783, 386.90918, -28.519451, 342.89026, 209.75238, -36.07887, 75.68777, 472.38098, 207.13246, 197.6173, -468.665, -139.24342, 258.93234, 434.61777 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 427.7318, -384.1275, 368.19995, -466.51865, -169.63696, 1.7852187, 361.30112, 485.62247, -286.85153, 405.34805, 200.66559, -337.6274, -292.07693, 148.82266, -21.879137, -40.98153, -28.908073, 215.52039, -366.23978, -38.76084, -132.39354, -197.59203, 233.83885, -434.7703, -200.39314, 483.36642, -302.71548, 185.99535, 79.268394, 409.75784, 296.40555, 389.16486, 245.44942, -408.70636, -102.0658, -51.499783, 386.90918, -28.519451, 342.89026, 209.75238, -36.07887, 75.68777, 472.38098, 207.13246, 197.6173, -468.665, -139.24342, 258.93234, 434.61777 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_addInplace(actual, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -259.38504, 153.04356, -433.5471, 194.50348, 346.69858, 201.45703, 377.5034, 320.66113, -280.0001, 173.3368, -244.02737, 251.53148, -364.84457, 143.5594, -258.6484, 491.33463, 178.6105, -367.77185, -4.247427, -423.22385, 320.64633, 214.6241, -33.297302, 89.66255, 492.44266, 389.46985, -328.4235, -473.81485, -187.4981, -369.12482, 187.28673, -471.80377, -492.20593, -194.89307, 232.3606, 376.8705, 421.78214, 170.85278, -53.748547, 57.98644, 306.64194, -158.55634, -161.9848, -56.517185, -44.256805, -334.9895, -107.27656, 154.60443, 443.13895 });

    float v = 0.13505457144788113;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -259.25, 153.17862, -433.41205, 194.63853, 346.83362, 201.59209, 377.63843, 320.79617, -279.86505, 173.47186, -243.89232, 251.66653, -364.70953, 143.69446, -258.51337, 491.46967, 178.74556, -367.6368, -4.1123724, -423.0888, 320.78137, 214.75916, -33.162247, 89.79761, 492.5777, 389.6049, -328.28845, -473.6798, -187.36304, -368.98978, 187.42178, -471.66873, -492.0709, -194.75801, 232.49565, 377.00555, 421.91718, 170.98784, -53.61349, 58.121494, 306.77698, -158.42128, -161.84975, -56.38213, -44.12175, -334.85446, -107.1415, 154.73949, 443.274 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("clip:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -3.356874, 333.06778, -106.64832, -212.09877, 99.53815, -256.81592, 432.39307, -253.36873, 285.05795, -278.36996, 383.6385, -223.8707, -305.81784, 320.71005, 314.43344, -399.66507, -489.93826, 190.5868, 499.01135, -155.35199, 439.77487, 283.5812, 386.0138, 197.8802, 303.35486, 24.385988, -375.0105, 49.414276, 90.02161, 81.672966, -330.98047, 352.5136, -335.53946, 29.052437, -0.65898895, -407.6256, 476.462, -377.63214, 220.22617, 332.51434, 291.674, 298.71313, -34.516273, 491.9197, -310.548, 178.81203, 87.54683, -97.12881, -432.271 });

    float v_min = -0.2706361292088919;
    float v_max = 0.034938328986876654;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.27063614, 0.034938328, -0.27063614, -0.27063614, 0.034938328, -0.27063614, 0.034938328, -0.27063614, 0.034938328, -0.27063614, 0.034938328, -0.27063614, -0.27063614, 0.034938328, 0.034938328, -0.27063614, -0.27063614, 0.034938328, 0.034938328, -0.27063614, 0.034938328, 0.034938328, 0.034938328, 0.034938328, 0.034938328, 0.034938328, -0.27063614, 0.034938328, 0.034938328, 0.034938328, -0.27063614, 0.034938328, -0.27063614, 0.034938328, -0.27063614, -0.27063614, 0.034938328, -0.27063614, 0.034938328, 0.034938328, 0.034938328, 0.034938328, -0.27063614, 0.034938328, -0.27063614, 0.034938328, 0.034938328, -0.27063614, -0.27063614 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_clip(actual, a, v_min, v_max);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("div:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -181.25713, 282.96613, -110.255775, 64.47506, 86.936356, -428.48892, 273.61615, -259.16528, 295.05634, -466.5029, 272.5854, 389.04047, -270.98138, -156.05139, -437.36053, -37.703575, 199.7984, 101.62282, -180.77379, 440.7993, -381.91974, -318.5179, 421.70273, -251.9731, -484.48993, -239.04759, -449.45044, 74.789345, -25.780201, 233.7588, 38.81842, -386.82193, 151.99828, 283.9641, 387.44348, -126.79994, -494.6801, -161.8052, -145.85054, 467.16916, -248.51949, -139.88966, -384.56143, 24.375618, -232.29712, 364.63696, 39.286198, -58.002293, -495.6482 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -392.48514, 188.54047, -409.99554, 461.16556, 198.25769, -373.68643, -331.33197, 401.8855, -286.85587, 462.3251, 175.05424, -27.776003, -458.7285, 78.91971, -143.42386, -225.79706, -302.34952, -308.13962, -281.72696, 457.33463, -18.61441, -458.6932, -33.20873, 109.570984, -100.05075, -485.06372, 448.455, 364.19247, 254.11647, 264.11676, -106.66466, -283.4419, 201.12944, 287.55493, 4.0093064, -476.731, -12.92789, 448.26483, 245.10384, 271.54596, -27.3512, -205.44392, 30.068933, 188.50983, -468.64886, 482.0097, -460.3402, -339.16318, 22.034824 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.46181908, 1.5008243, 0.26891944, 0.13980892, 0.4385018, 1.1466537, -0.8258067, -0.64487344, -1.0285875, -1.0090365, 1.5571481, -14.006351, 0.5907228, -1.9773438, 3.0494266, 0.16697992, -0.6608193, -0.3297947, 0.6416631, 0.9638441, 20.517424, 0.69440293, -12.698551, -2.2996335, 4.8424416, 0.4928169, -1.0022198, 0.20535664, -0.10145033, 0.8850586, -0.36392954, 1.364731, 0.75572366, 0.9875126, 96.63604, 0.26597798, 38.26457, -0.36095896, -0.5950561, 1.7204055, 9.086237, 0.6809141, -12.789328, 0.12930688, 0.49567413, 0.756493, -0.08534166, 0.17101589, -22.493856 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_div(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("fill:                   ");

    float v = 0.026815483852072997;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483, 0.026815483 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_fill(actual, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmulT:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ 344.25604, -79.271255, 270.84607, 14.381826, 324.48917, 165.811, -201.80452, 134.06157, 468.89685, -247.9074, -441.55496, 419.69962, 441.89017, 144.1177, -99.13373, 372.0261, 407.98383, -47.47212, -250.13763, 290.09723, -69.89479, -441.67227, -129.14288, -200.89752, 2.0812154, -492.69174, -139.40335, -446.40906, -99.29401, -338.2651, -40.681183, 406.59775, -276.18546, 61.970234, 93.6231, 271.49332, 412.2474, 16.33954, 82.199814, -192.78455, 285.392, -378.85278 });

    Tensor *b = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ -491.78983, 305.40247, -490.8222, 40.329395, -453.73535, 475.87885, 3.239274, 177.63919, -344.9266, -490.40417, 475.7112, -63.06988, 94.82825, -345.65503, -159.40857, 379.31992, -176.86784, -490.1566, -392.43723, -491.3414, -406.72397, 261.64682, -147.41992, 68.62348, 163.98526, -203.1532, 129.77975, -69.77266, -282.47653, 14.061392, 418.77414, -475.6527, -285.266, -49.67892, 130.18352 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -394848.47, 27526.506, -266632.53, 92382.805, -118851.0, 201463.4, -260780.02, -23671.562, -161439.11, -47983.203, 211529.62, -301146.66, 92083.64, 32772.21, 274512.34, 432224.8, 237755.72, 499342.56, 3178.4028, 127184.01, 136998.55, 303345.7, -264725.56, 145389.53, -99247.9, 209736.95, 107297.65, 159434.02, 127499.17, -111653.19 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmulT(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmul:                 ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -357.51944, -258.30817, 399.87915, 74.494, -263.15646, 274.6834, 32.868267, -301.5859, -238.14552, 249.34422, -330.96832, 72.10749, 70.16337, 417.59253, 85.22588, 140.49739, -363.30063, 442.64078, -22.219776, 289.2354, -418.38098, 52.690567, 289.87646, 256.6194, 104.937256, 60.89729, -64.65518, -480.1864, 29.698074, -281.98825, 267.62927, 401.10266, -217.83347, -362.7343, 376.16037, -335.5592, 493.77985, 329.35153, -378.35782, -400.08246, -380.8887, 369.1769 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 5 }, DTYPE_F32, (float[]){ -93.06532, -158.18834, 389.34207, -29.39433, -494.10498, 79.78022, 494.478, 271.26144, -299.76035, -105.215965, -369.0966, 310.03577, 107.16778, 187.23917, 190.80168, -394.30093, 23.399235, -157.85551, -318.24387, -349.93286, 223.85323, -357.01196, 179.85797, 107.77581, 199.21082, 10.999322, 469.24634, -26.371538, 381.1369, -363.19406, 88.500084, -472.95172, -388.32562, -150.12247, -417.0975 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -217280.56, 261846.73, -245509.73, 210501.19, 88163.73, 101407.12, -190809.56, -254096.03, 204090.42, 152168.67, -75982.65, 295241.78, 113330.2, -82860.62, -216075.4, -147447.1, 392043.88, 309209.97, -19781.162, 191606.44, -301659.47, -322123.03, -275250.8, -212080.58, -142846.58, 37170.03, 180003.02, -106956.37, -199786.22, 213741.61 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("max:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 22.763908, -158.8136, -69.246414, 39.64335, 89.24633, -239.66968, 94.11496, -415.49664, -292.7214, 288.5462, -60.182392, 461.30002, -275.928, -38.763702, -310.07272, -116.07522, -271.9481, -46.50265, 297.4275, 58.041214, -139.71979, 224.88248, -154.44649, 361.96732, 148.02283, 56.676983, -287.59354, -74.91076, -122.56724, -237.50246, -105.72404, 426.80276, 301.12857, -59.80903, -388.153, -127.570984, -347.3277, 4.500985, -154.40976, 247.40988, 166.11815, -248.22498, 42.45752, 349.11047, 464.6793, 223.33449, -371.27972, 386.70938, -404.08212 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ 464.6793 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_max(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("maximum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 238.38675, 201.5304, -454.8365, -449.10873, 74.46134, 498.27512, -358.7733, 84.79303, 293.46384, 270.7833, 424.96234, -380.2597, -262.11053, 452.66437, -145.76108, -290.29007, 422.50906, 431.42618, -315.11307, 255.54245, -126.195076, -310.53912, 337.92566, 1.9252896, 214.86086, -102.00441, 422.78128, -136.58679, 362.0788, -82.731544, -487.74344, -498.50076, 96.499504, -405.48163, 318.78757, -92.670975, 174.42888, -161.67676, -354.6862, -151.69907, 102.105736, -305.59088, -101.901474, 178.64502, 24.54716, 365.57452, 30.068577, 210.73573, -70.4602 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 124.242546, 81.11596, -482.51993, 138.41176, 447.4264, 100.37965, 360.89282, -432.90918, 310.44687, 319.38547, 281.94452, 436.03802, 489.37927, -99.753914, 15.535652, -169.58678, 259.3502, 65.640686, 275.0156, -403.16718, 194.20415, 232.48572, -190.99355, -361.40674, -303.59125, 135.85138, -128.68906, -159.22343, -161.49074, -260.7453, 156.82048, 79.141975, -283.4071, 267.0627, 194.66132, -392.10397, -482.78778, -92.8179, 170.24016, -213.84824, -422.49036, 463.11987, -187.47401, 337.22073, 0.34928322, 215.38109, 416.57062, 357.73306, 446.37686 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 238.38675, 201.5304, -454.8365, 138.41176, 447.4264, 498.27512, 360.89282, 84.79303, 310.44687, 319.38547, 424.96234, 436.03802, 489.37927, 452.66437, 15.535652, -169.58678, 422.50906, 431.42618, 275.0156, 255.54245, 194.20415, 232.48572, 337.92566, 1.9252896, 214.86086, 135.85138, 422.78128, -136.58679, 362.0788, -82.731544, 156.82048, 79.141975, 96.499504, 267.0627, 318.78757, -92.670975, 174.42888, -92.8179, 170.24016, -151.69907, 102.105736, 463.11987, -101.901474, 337.22073, 24.54716, 365.57452, 416.57062, 357.73306, 446.37686 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_maximum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("min:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 359.71118, 181.40721, 70.73814, -111.53746, -370.57996, 100.85631, 479.89975, -438.0532, -30.223787, 177.67102, -499.08054, -364.46005, 391.71576, -365.77386, -315.42392, 370.45343, 350.07166, 234.18665, 100.112495, -200.85776, 416.6957, 367.94955, -142.30728, 362.8236, -313.80338, -487.17224, -209.25194, -398.3477, 139.65225, 312.02173, 231.86737, 343.04108, 481.71692, -303.61252, -94.22481, -337.0056, 118.95275, -451.02774, -413.7696, 241.14102, 69.118324, -93.61595, 47.874035, 49.57336, -311.78235, -400.7607, -6.6400766, -102.24402, -278.9309 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -499.08054 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_min(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("minimum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 145.82706, 188.56746, 465.3204, 470.12128, 164.93541, -342.28665, -211.90709, -121.723595, 368.96545, -144.7671, -79.241875, -184.63057, 469.57898, 350.0588, 382.9782, 166.25696, -110.03512, -497.2989, -227.48369, 293.8093, 476.3757, -270.01126, 37.359238, -255.05722, -247.26254, 226.06242, 128.02034, -153.52225, 13.134062, -179.22241, 362.76556, -76.08617, -49.161255, 325.57285, -184.84259, -365.7416, 68.48162, -88.91201, 168.75189, 328.13846, 100.21448, -223.09464, -295.3083, 38.766144, -50.164818, 485.7918, 350.5807, 105.11309, -255.42372 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -482.66928, 128.73369, 451.71362, 264.2587, 170.96913, 400.2301, 230.91238, -268.09866, 207.3847, -22.926092, 392.4287, 170.98123, -83.76223, -214.98936, 463.94717, 388.4181, 170.06267, 47.982277, 420.134, 51.81235, -17.406284, 472.667, 214.5968, 144.48285, -410.15475, 310.70972, -417.74356, 241.01263, 277.01755, 108.2772, 259.38034, 10.38444, 164.30408, 345.91705, 340.99127, 495.36908, -167.01674, -285.41653, 209.74922, 290.0241, -122.126816, -92.12029, -246.09518, -74.69201, 166.17293, -113.38246, -168.67972, -270.72214, 240.59326 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -482.66928, 128.73369, 451.71362, 264.2587, 164.93541, -342.28665, -211.90709, -268.09866, 207.3847, -144.7671, -79.241875, -184.63057, -83.76223, -214.98936, 382.9782, 166.25696, -110.03512, -497.2989, -227.48369, 51.81235, -17.406284, -270.01126, 37.359238, -255.05722, -410.15475, 226.06242, -417.74356, -153.52225, 13.134062, -179.22241, 259.38034, -76.08617, -49.161255, 325.57285, -184.84259, -365.7416, -167.01674, -285.41653, 168.75189, 290.0241, -122.126816, -223.09464, -295.3083, -74.69201, -50.164818, -113.38246, -168.67972, -270.72214, -255.42372 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_minimum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -495.27072, 403.4061, 94.85173, -432.0488, -312.86807, 304.79492, 468.99634, 292.63086, 324.2609, -476.05234, -271.71112, 31.877876, -52.225292, -390.2718, -420.4476, 454.31714, 224.8587, -150.34914, -125.56201, -385.4931, 491.014, -292.78732, 353.6691, -170.71956, -283.97363, -113.568184, -94.33359, -99.58714, 316.36047, -442.3172, -382.85666, 358.36597, -485.7015, 329.22412, 173.61653, -22.591532, -185.14687, -111.28956, 79.27996, -157.58508, 325.0131, -51.488995, 281.7164, 86.483, 309.17126, 461.45062, -212.94284, -28.083384, -377.1909 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 190.88185, 387.36557, -439.51904, -120.71675, -359.73584, -107.75125, -118.385254, -218.32156, 190.99605, 217.65428, 389.92065, 42.606712, 53.572117, 372.34653, 138.93372, 210.8621, -146.40027, -141.50554, -14.690638, 22.889019, 393.03094, -77.018265, 295.6918, 393.0427, 262.6207, -398.26178, 172.36913, 135.04648, 121.305046, 374.05402, 81.52908, 224.13223, -449.5909, -401.11905, 174.26013, 253.49992, 141.09647, -460.1803, 331.59326, -467.4933, -391.38217, 343.9463, 215.27118, -496.0053, 468.80066, 7.0921183, -321.1736, 197.46136, -314.12418 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -94538.195, 156265.64, -41689.14, 52155.527, 112549.86, -32842.035, -55522.25, -63887.625, 61932.55, -103614.83, -105945.78, 1358.2115, -2797.8193, -145316.34, -58414.348, 95798.266, -32919.375, 21275.236, 1844.586, -8823.559, 192983.7, 22549.97, 104577.055, -67100.08, -74577.35, 45229.867, -16260.198, -13448.893, 38376.12, -165450.53, -31213.953, 80321.37, 218366.98, -132058.06, 30254.44, -5726.9517, -26123.568, 51213.26, 26288.701, 73669.97, -127204.33, -17709.45, 60645.42, -42896.027, 144939.69, 3272.6624, 68391.625, -5545.3833, 118484.77 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -17.394424, -353.5078, -470.2206, 492.3713, 219.22649, -300.1694, -87.75061, 442.40427, -288.34958, 205.70332, 298.05655, 234.19852, -139.59468, 466.12173, -225.18509, -381.32077, 215.14523, -451.4915, -483.68347, 304.8439, 330.61743, -271.95978, 175.62097, -207.5125, -381.29218, -264.8378, 250.43976, 490.40216, -275.78348, 73.559105, -343.2065, 159.69855, -151.72417, -382.89636, 207.77768, -236.83649, 221.28499, -266.99167, 42.699516, 233.12259, 192.91656, -352.99652, -194.38315, 105.41678, 313.60846, 164.06113, -58.806004, 351.55804, 52.076458 });

    float v = 0.14573218687796663;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -2.5349276, -51.517467, -68.52628, 71.75435, 31.948357, -43.744347, -12.788089, 64.47254, -42.021816, 29.977596, 43.436436, 34.130264, -20.34344, 67.92894, -32.816715, -55.570713, 31.353586, -65.796844, -70.48825, 44.42557, 48.181602, -39.633297, 25.59363, -30.241251, -55.566544, -38.595394, 36.497135, 71.467384, -40.190533, 10.71993, -50.01624, 23.27322, -22.111095, -55.800327, 30.279898, -34.5147, 32.24835, -38.909283, 6.2226944, 33.973465, 28.114155, -51.44296, -28.327883, 15.362618, 45.70285, 23.908987, -8.569928, 51.233326, 7.5892167 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("neg:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -404.52646, -342.06247, -42.944492, 305.57025, -466.476, -263.0183, -2.877295, 99.78676, 284.98352, 339.4143, 470.0163, -456.97128, -314.19366, -452.4733, -151.73042, 312.53146, 204.25558, -390.72787, -136.58452, -241.15634, -484.44824, -493.1062, -288.46295, -333.91864, -493.185, 468.9151, 492.83624, -41.512966, 2.3565292, -12.594461, 92.535194, 245.76115, -185.90099, 235.51208, 413.1462, 406.08853, -247.6337, 204.59425, -234.37137, 271.88086, 457.71283, -97.08297, -353.21307, -461.3528, -128.32141, -440.11874, 399.30988, -348.16885, 283.21387 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 404.52646, 342.06247, 42.944492, -305.57025, 466.476, 263.0183, 2.877295, -99.78676, -284.98352, -339.4143, -470.0163, 456.97128, 314.19366, 452.4733, 151.73042, -312.53146, -204.25558, 390.72787, 136.58452, 241.15634, 484.44824, 493.1062, 288.46295, 333.91864, 493.185, -468.9151, -492.83624, 41.512966, -2.3565292, 12.594461, -92.535194, -245.76115, 185.90099, -235.51208, -413.1462, -406.08853, 247.6337, -204.59425, 234.37137, -271.88086, -457.71283, 97.08297, 353.21307, 461.3528, 128.32141, 440.11874, -399.30988, 348.16885, -283.21387 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_neg(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sub:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 97.592476, 187.8209, 271.4877, -375.1427, -455.30487, 422.52612, -454.90182, -372.98502, 411.50348, -92.75919, 75.04815, 266.98172, 251.37686, -488.1261, 225.21985, -75.977684, -279.45203, -389.83453, -394.7086, -29.865147, 331.5269, 279.01733, 133.11201, 160.12823, 160.22736, -331.56516, 260.23447, 489.75784, -343.51712, 210.56795, 288.01483, -124.56483, 281.99405, -82.62211, -201.85036, 214.26607, 156.82077, 242.98828, 312.04163, -465.9896, 300.77057, -307.02466, -198.6745, -286.87674, -495.96805, 237.45221, 410.37686, -482.8251, -440.0925 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -383.83514, -416.00217, -226.06569, -327.2046, -382.59186, -366.12726, -122.59519, 44.75832, 75.57827, -9.144664, -154.83922, -278.50128, 24.148882, -263.64423, -403.13608, 355.2447, 461.23367, 147.98111, -41.59999, -204.3317, -294.08258, -473.79684, -222.54527, -283.16177, 187.38759, 72.351456, -98.325195, 460.17004, -102.89586, -241.41377, -378.62033, -130.52565, -389.65082, -370.3766, -202.51709, 154.9248, 69.890854, -242.79428, 310.23383, -182.77847, 249.37927, -449.8278, -436.21582, 382.11716, 429.4293, -89.37645, 38.409412, -336.949, 357.769 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 481.4276, 603.82306, 497.5534, -47.93811, -72.71301, 788.6534, -332.30664, -417.74335, 335.9252, -83.61453, 229.88736, 545.48303, 227.22798, -224.48187, 628.35596, -431.22238, -740.68567, -537.8157, -353.10858, 174.46655, 625.6095, 752.8142, 355.6573, 443.29, -27.160233, -403.91663, 358.55966, 29.5878, -240.62126, 451.98172, 666.63513, 5.960823, 671.6449, 287.7545, 0.6667328, 59.341263, 86.92992, 485.78256, 1.8078003, -283.21112, 51.391296, 142.80313, 237.54132, -668.9939, -925.39734, 326.82867, 371.96744, -145.8761, -797.8615 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sub(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sum:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 494.28503, -322.77954, -272.0537, -445.9424, -350.59708, 327.47745, 420.22406, 490.80984, 223.08516, -438.76184, 460.53253, 256.0972, 173.40123, 68.26168, 415.02823, 493.27637, -386.9041, 391.87766, -403.14984, -272.60696, 229.78687, -434.6146, 40.423332, 190.9321, -317.06387, -475.08908, 63.50827, -458.29837, -198.74876, -118.8761, 329.02063, -347.03415, -44.780014, -374.8119, 335.9814, 130.78546, -229.44307, -30.181767, -227.1697, -217.37718, 483.80298, -442.41428, -196.90561, -434.85974, -490.37595, -308.38925, -352.2647, -135.4245, -394.7407 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -3103.061 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sum(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Linear:                 ");

    Tensor *x = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -183.20036, 405.0787, 117.10566, 357.85794, 109.52526, -415.6653, 199.47112, 283.97644, 301.68552, 281.5391, -376.5227, 251.63222, -450.65344, 233.21693, -421.8071, -133.80688, -281.07416, 209.58078, -196.90811, 403.49115, -241.15163, 48.875927, 121.64646, 75.59043, 369.97623, -296.91434, -192.4876, 239.79037, 72.963776, 137.56699, 346.79388, 382.14517, -361.0783, 353.25342, 308.93802, -153.49435, 161.03513, -125.82129, -499.14575, -67.02334, 472.9703, -254.24635 });

    Tensor *w = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ 189.17299, -22.055387, -431.4853, -139.65201, 215.45482, 177.35196, 495.8174, 297.822, -239.10785, 410.03342, 495.4958, 461.79526, 188.31706, 240.2417, -317.55585, -473.63763, -360.61752, 220.72495, -334.05304, 231.14288, -399.09674, -394.55496, -424.0924, 135.11223, -71.37627, -170.1439, 183.9391, 156.4806, 291.13632, -391.57278, -261.13492, 97.53144, 383.2355, -308.73727, 154.57219 });

    Tensor *b = NN_tensor(2, (size_t[]){ 1, 5 }, DTYPE_F32, (float[]){ 347.61874, 339.53662, 8.123577, -231.2001, 147.1703 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -94968.12, 94477.93, -309191.8, -173338.34, -6346.8535, 68440.8, 29018.875, -698995.75, -264516.44, 126065.47, -74916.77, -177574.67, 600236.06, 239990.69, -213732.33, -56590.86, 84370.836, -59731.863, -34664.39, -34206.797, -53856.535, 294723.97, -50054.67, 106974.66, -285454.06, 35137.613, -385758.03, 140860.27, 69280.875, -334432.38 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Linear(actual, x, w, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU:                   ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -247.89207, -419.45786, -284.18546, -483.8959, -133.9711, -108.237206, -323.04572, 131.03217, -420.02887, 353.52713, 115.66037, -274.83557, 72.625336, 463.1796, 307.0743, 397.53473, 257.96634, 249.62682, -115.08346, 81.263245, 420.17484, -123.96872, -92.217926, 299.15173, -311.3665, 416.33655, -485.45206, -137.28416, -451.95847, 223.59091, 16.715944, 110.400856, -320.49393, 214.06776, -27.442276, -86.83378, 374.51004, -313.86746, -241.8496, -423.74503, -93.52398, 3.9846897, 191.10138, 6.608546, 294.33328, -86.93939, -45.774162, 188.56984, 389.8304 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 131.03217, 0.0, 353.52713, 115.66037, 0.0, 72.625336, 463.1796, 307.0743, 397.53473, 257.96634, 249.62682, 0.0, 81.263245, 420.17484, 0.0, 0.0, 299.15173, 0.0, 416.33655, 0.0, 0.0, 0.0, 223.59091, 16.715944, 110.400856, 0.0, 214.06776, 0.0, 0.0, 374.51004, 0.0, 0.0, 0.0, 0.0, 3.9846897, 191.10138, 6.608546, 294.33328, 0.0, 0.0, 188.56984, 389.8304 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU6:                  ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -30.683517, -32.387554, -323.2934, 186.359, 233.18935, 175.66734, 42.736828, -234.21938, -322.55103, 123.939156, -114.25781, 16.977728, 385.8173, 27.282536, -332.82153, 249.76581, -300.9615, -14.153481, -288.4257, 63.955666, 487.5931, -472.13644, -239.64613, -450.71198, -413.643, -253.99423, -278.13632, 104.539154, 111.49633, 363.4665, 491.7462, -447.75684, 323.19183, -370.98544, -468.90002, -406.6931, -253.66092, 188.63834, 94.8959, -261.82736, -180.39828, 173.14714, -337.8939, 200.26964, -368.2735, 260.26285, 396.18134, -45.75485, -373.7933 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.0, 0.0, 0.0, 6.0, 6.0, 6.0, 6.0, 0.0, 0.0, 6.0, 0.0, 6.0, 6.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 6.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 6.0, 6.0, 0.0, 0.0 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU6(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Conv2d:                 ");

    Tensor *x = NN_tensor(4, (size_t[]){ 1, 16, 16, 3 }, DTYPE_F32, (float[]){ 273.54626, 460.63037, 272.7012, 54.285706, -258.69644, -392.55344, -419.18082, -252.43205, -376.82404, 266.19995, 83.78512, 244.42416, 395.46072, -31.929314, 246.81557, 386.0011, 417.28412, 169.81834, -250.08714, -328.28397, 143.73373, 445.10495, 371.45645, 92.95076, 161.88919, -363.74564, -282.70334, 196.94566, 217.31085, -208.02129, 50.998806, 271.72775, -1.6553998, -298.37375, -485.1445, 368.77866, 260.97357, -419.0176, 335.6582, -62.15799, -336.43793, 1.5038252, 197.20619, -489.03607, 155.70706, 425.04913, -60.182095, -318.76154, -108.185646, 63.509106, -307.11328, 131.55144, 494.09164, 384.19778, 23.053528, -340.12616, -43.6427, -65.153656, 262.85214, -402.5485, 434.3802, -221.65102, 464.75156, -280.69806, -239.2087, 393.82202, 345.29538, -350.1819, 120.449005, -157.3426, 482.89722, -77.18652, 134.84598, 158.65929, 477.94772, 38.593292, -359.19858, -419.5344, -203.61423, 149.86801, -436.52545, 92.872086, -58.66021, -330.14642, 353.50586, 494.0554, 58.57712, -218.8319, 246.62024, -181.07259, 343.5028, -473.88834, -197.48438, -293.06262, 335.25015, 95.70974, -336.09564, 272.81445, -483.62946, -165.0368, -247.8789, -478.9298, 178.06184, -253.66121, 488.0722, -184.36516, -252.95955, -64.96781, -396.50607, 358.6089, -126.165985, 369.0223, -328.56052, 264.3863, -242.52159, 398.3168, 441.15012, 216.52037, -455.15292, -495.44055, 42.85312, 496.6871, 273.67877, 193.15248, 375.24622, 155.07066, 125.74088, 254.11868, 402.45956, 50.437035, -315.76675, 416.59332, -493.6362, 34.66946, -321.32446, 255.77426, 423.46524, 347.42743, -436.67697, -481.8393, 140.0634, 420.19534, 259.7797, -487.06412, -248.62993, -359.83215, -21.524847, -247.98012, -490.81088, -73.41796, -455.7088, -129.83209, 260.30023, 250.72414, 150.5338, -470.92206, 110.294815, 157.46135, -178.39265, -464.73682, -219.36285, 342.4688, -85.403206, 27.269184, 262.55942, 312.37473, 35.019638, 173.52576, 33.006847, 127.34419, -138.14432, -413.23, 172.44136, -476.23248, -380.1282, 187.54672, -98.12349, 325.14178, 323.10968, 452.21585, -4.0743947, -174.69406, -443.80743, -450.8021, 194.30852, -2.0202398, -189.4257, 320.17642, 148.93097, -197.53557, 338.6929, 38.57231, 19.194662, 285.12643, 40.451706, -487.14383, -105.84467, 151.21895, -139.23233, -147.15326, -454.2908, 116.68926, -144.6334, -322.2087, 425.45938, -122.34825, -378.87448, 134.26309, 168.671, 448.86493, 292.33914, 498.1203, 7.452011, 233.44034, 21.59196, -394.79834, 421.86005, 71.40118, -377.1034, 295.35507, -70.87928, -277.71533, 23.074091, 270.45358, 488.58374, 207.42322, -85.643234, 121.28681, -75.85794, 360.18402, -312.2958, -156.89647, 187.3451, -209.72102, -241.42813, 147.46481, -386.36566, -372.24216, -339.8288, -161.52382, 98.58441, -340.62784, 205.29396, -140.00237, -168.47586, -317.55222, 253.86464, -88.47052, 194.07266, -303.933, 378.816, -382.63528, 301.93793, -274.3576, -406.66568, 425.7807, -42.084755, -455.65594, -49.672604, 115.525665, -332.78876, -359.13412, 238.46513, 219.68883, -438.76373, -496.8279, 258.6329, 306.1993, 270.2915, 407.92548, -455.75137, -465.0635, -337.08752, -14.560759, 243.17848, -383.9199, 326.7113, 23.862898, 135.56993, -473.7996, 423.37222, 463.16953, -354.95828, -185.91362, -234.08234, 272.98694, 262.11768, -122.28381, 144.3994, 324.5784, 348.30045, 207.26991, 111.498055, 47.702312, -457.7326, 212.8734, -419.16187, 64.84121, 168.22034, 72.888435, -172.74278, -201.06274, 122.48438, -135.58882, -236.12398, 252.41136, 176.04375, -400.13742, -25.493443, 137.4476, 294.62247, 400.30307, 173.64233, 59.02314, -337.4151, -351.10992, 457.6221, 263.08673, -32.90981, -425.5907, -272.2991, 5.3254366, -422.6985, -419.14798, 444.05377, -220.45529, -344.28973, -126.44893, -221.79872, -427.80887, 488.41583, -335.2267, -111.6606, 260.61575, 55.686356, 420.38846, 471.6947, 255.74094, -150.53111, -49.736797, 360.82523, -300.38953, 282.3674, 35.70229, -106.46295, 158.33182, 440.32098, -245.97597, -115.03023, 291.3457, -426.07056, 227.71, 115.48638, 254.19623, 411.90488, 192.61473, -207.41338, 74.33849, -454.06848, 52.50448, 168.80292, 493.3296, -17.649412, 394.43863, -18.965424, -330.13202, -373.09564, -216.53688, -422.62805, 96.51131, -231.14217, -3.4982562, 370.74994, -486.16385, 396.40726, 361.05316, 322.2151, -220.59644, -87.50993, 406.00406, 435.2026, 240.47757, 201.10065, 152.48346, -89.826164, 246.42087, -373.1116, 317.3015, -1.5029311, 320.81152, 327.8005, 162.41515, -232.76389, -375.74417, 293.62024, -448.3772, -122.33651, -443.5333, 242.91629, 317.30426, -168.39319, 397.6531, 60.004173, 321.72263, -171.07088, 349.33853, -316.97977, -486.98843, -398.19656, -487.67178, -311.00534, -236.08827, -378.99792, 408.3112, -234.94637, 214.07246, -356.79852, 175.09329, -312.9769, 79.474686, 150.77681, -30.9937, 416.47708, 95.88695, -468.5645, 325.9073, -16.97713, -487.98584, 476.28845, -439.0801, -292.27966, 353.25253, 394.1719, 455.18225, 284.91528, -7.92104, 141.42227, 266.80856, -159.8578, 263.48907, 434.77362, -250.90361, 196.92015, 420.12036, 395.585, -122.35677, -232.47015, -97.890495, -454.81522, 3.1044483, 163.10585, -345.68423, 455.1149, -350.87143, 340.30252, 451.1109, 67.72262, 466.21753, 238.0705, -266.34454, -66.724, -78.995705, -381.719, 469.37775, -19.111515, -329.72217, -386.5174, -35.72869, -317.33865, 0.32764673, -291.9411, -494.17245, -397.84885, -105.90875, 200.7674, 426.84, -327.4895, 440.82703, 386.87164, 321.91043, 459.11337, -471.4002, 441.67633, 297.79227, -498.152, 112.12718, 333.3059, 397.90274, 368.28983, 410.9307, 239.36856, 182.18869, -255.7909, -84.12099, -469.68396, -88.82052, -151.3725, 356.50092, 400.94382, 370.91147, 224.94794, -108.55675, -46.646236, -411.111, 359.25043, 369.01926, -362.90503, -469.491, 270.73364, 320.849, -473.62186, 6.23101, -44.606327, -188.93802, 327.3538, 231.75793, -250.98645, 187.99603, 21.717728, -496.13596, -113.974335, -443.73773, -308.98346, -75.81234, 278.80597, 15.684843, -485.18927, -289.05005, -343.80258, 114.72368, -191.11174, 42.46801, -139.59206, -300.4256, -421.58264, 143.7217, 261.91724, -189.84444, 142.33142, -399.97913, 150.54852, -202.31772, -135.25128, -151.75366, 342.22482, 410.86252, 439.0584, 467.7825, 211.766, 113.78479, -289.19165, 54.35759, 333.12802, -428.3716, -116.68092, -155.36339, 331.42328, -433.1792, 255.32025, -133.9668, -93.554436, -445.75888, 326.37256, -36.174477, 219.09433, -315.68604, 82.41278, -297.6467, -84.075035, -177.24693, 137.05516, -136.648, 387.8448, 171.9206, 187.074, 116.436005, -270.8969, 160.17801, 102.80633, 110.32844, -215.80524, 150.50423, 473.86807, 116.478386, -388.87848, -449.21112, -237.06114, -95.97456, -359.94196, -419.576, -247.41977, 171.43434, -267.37326, 39.48432, 153.9433, -461.25217, -363.09827, -357.6777, 218.02681, 154.97774, -470.3824, -212.85385, 70.89186, -122.52492, 299.43085, 296.9568, 314.14252, 453.97705, 484.4907, 263.59515, 451.13712, -131.566, -263.90558, 198.57556, -418.02203, -370.90652, -450.54233, -6.8866014, 78.7074, -193.63934, 460.15585, 399.5821, 70.59371, 95.521034, 238.12335, 228.43051, -414.6529, 471.30603, -6.760478, -437.76633, 17.044008, 469.96744, 398.79227, -205.72513, 177.78618, 75.68025, 391.49582, 310.58472, -385.66553, -165.699, 196.57022, 300.89658, 420.4276, -201.6924, -478.14728, -444.68796, 170.7462, 451.83463, 309.58444, -115.31484, 466.67932, 232.98676, -96.0654, 83.61482, -381.95688, 325.01114, -204.2151, 283.73523, -254.80783, 360.10318, -353.441, 371.06097, 41.771233, 344.6222, 333.74036, -169.8286, 282.35452, 418.4643, 213.99814, -488.4184, 177.7556, -408.77307, 296.5004, -402.04352, 406.1197, -203.89265, -177.75626, -398.90576, 237.46878, -89.59371, 42.223392, -46.909153, 50.269962, -215.8826, 396.28964, 352.2227, -133.08621, -146.75922, -269.24402, 421.7819, -332.65305, -271.63327, 6.533563, -97.782135, 75.16104, -237.26648, -346.04126, -409.54147, -429.34097, -485.7412, 307.46173, -205.09195, 108.432945, -7.9084635, 488.48724, 385.06223, -160.63512, -29.16515, -11.447609, -86.47007, -357.9927, -411.43906, 440.6392, 228.97041, -143.06534, 357.08298, -87.14282, 303.37512, 497.3823, 116.970535, -5.2449703, -472.31985, -345.4892, 91.216866, -282.11862, 207.37808, -214.51694, 86.18039, -363.64108, 465.60986, -150.05714, -355.1058, 223.25337, 161.10057, 283.6346, 165.24696, -111.25255, 327.62915, -414.33527, -236.49126, 216.01642, -366.09244, 323.18115, -358.9562, -21.12019, -151.22383, -104.59834, 307.99973, 65.77468, -336.06512, 89.520035, 345.33005, -359.54828, 256.08127, -373.06552, -211.54816, -447.37143, -184.32474, -222.26227, 271.90186, -313.79355, -255.07831, -94.05202, -214.62225, 435.9374, -187.07622, -269.0438, -230.20142 });

    Tensor *w = NN_tensor(4, (size_t[]){ 3, 3, 3, 6 }, DTYPE_F32, (float[]){ -353.10632, -443.32016, 292.93018, -103.94162, 477.53262, 313.82697, 265.72412, -5.259812, 443.6159, -495.35132, -127.71189, -94.65486, -110.91351, -182.09106, -245.67867, 117.48463, -94.71083, 80.58882, -399.91443, 14.907778, -14.022886, 361.88812, -381.53146, -233.8897, 315.92566, 217.34059, 260.7472, -331.06583, 461.8474, -479.3499, -272.51984, -100.11953, -437.93582, 383.56, -494.37643, -361.9463, 93.447205, 215.61426, -60.21398, -295.15564, 134.35083, 70.07205, -96.48079, 189.12709, -425.20905, -476.99368, 381.63126, -165.81839, 62.335133, 30.791998, 459.85437, -386.45654, 263.37665, 260.1593, 232.49548, 269.74313, 8.211315, 192.03561, -384.96344, 85.073944, -186.81442, 350.98285, -282.8772, 22.953808, 109.065414, 256.11777, -96.88681, 168.85048, 145.51741, -253.38239, 489.37064, -308.05624, -192.6217, 43.25038, 48.216583, 0.45973063, 490.9336, 84.89108, -143.02194, 0.2887845, 69.031715, 362.4018, 429.54898, 127.59614, -470.40063, -151.40521, -430.09122, 251.69832, -230.03375, -251.74988, 238.87665, -417.19986, -56.115868, 34.484684, 66.383064, -106.553375, 106.48036, -215.09564, 335.1772, 77.12388, 308.39062, -88.36418, 476.2323, -450.82056, -219.13087, 159.91312, 145.16055, 89.81353, -6.16014, 147.97371, 418.0087, -475.7303, 183.7253, -489.40384, -358.41357, 394.84625, -122.79195, 60.865284, -343.02615, 168.5267, -294.34674, 393.95166, -37.688194, 459.42657, -435.99133, -341.88443, -298.8338, 220.31796, -316.95032, -147.02809, -204.6163, -50.09973, -147.74722, 382.40195, 244.38889, -283.5754, -286.28885, 144.39105, -495.7156, 460.44772, 18.605412, -29.990614, -456.39996, 53.83992, 341.33322, -63.28285, 128.17233, -16.915798, 360.26852, -186.87332, 207.41487, -38.856625, 400.86203, -482.988, -371.33157, -451.24353, -359.14444, -199.5886, 255.74362, -87.940155, 65.70786, -396.75452 });

    Tensor *b = NN_tensor(1, (size_t[]){ 6 }, DTYPE_F32, (float[]){ 79.79792, 299.9898, 226.7828, -83.07737, 334.89157, -449.14407 });


    Tensor *golden = NN_tensor(4, (size_t[]){ 1, 14, 14, 6 }, DTYPE_F32, (float[]){ -171734.06, -949793.94, -140356.08, 561541.9, 394569.1, 544497.9, -154085.25, 430315.16, -14267.785, -585166.8, 643236.8, 727552.75, 625753.7, -77237.78, 93300.62, 232992.44, -313102.0, -524673.8, -326849.94, -299381.03, -517039.8, 128482.78, 284040.3, 203231.44, -564362.25, -306514.8, -93593.31, 178598.81, -801600.44, -505926.3, -240195.3, 209578.34, 306235.84, -639136.6, 621370.06, 96034.21, 336509.6, -323998.53, -151307.47, 980415.44, -375917.2, -778124.06, -634630.4, 35519.324, 224269.64, -857250.1, 128493.67, 113492.41, -639017.7, 1072172.0, 522851.53, -651151.6, -3332.9443, -393493.12, -336117.56, 332470.5, 991732.94, -37519.453, -469482.16, 91348.5, -147690.16, -31394.586, 126098.32, 307370.5, -738478.9, 518734.84, -237590.05, -353167.1, 118968.35, 1112496.1, -375261.3, -374766.75, -758674.06, 261357.61, -573237.0, 624944.25, -534065.75, 1311206.6, -42434.926, 215923.9, -335432.5, 482533.88, -347011.53, 14470.541, 622385.1, -618537.6, -162832.6, 377609.22, -117869.96, -66227.41, 117112.37, -511888.53, -430297.38, 133819.72, -456564.2, 165552.02, 486658.34, 253015.69, 506130.06, -314991.3, 462119.03, 101077.47, -149020.08, -547696.06, 205019.83, 87430.01, -437769.12, -1242.2542, -482547.2, -637764.9, -122969.01, 231607.08, 240428.83, 338846.1, -761010.25, 245190.6, -803911.56, 796188.8, -805199.44, -391492.2, 127933.97, 280504.16, 352083.2, -698236.3, 960360.5, 44707.207, 245864.48, -222696.31, 65202.984, 597650.5, -893609.5, -425095.53, 115225.305, -490591.34, -142873.83, 185622.77, 540048.25, 397602.2, 296785.34, -214155.33, -100173.586, -1555.3141, 625729.6, 191447.05, -584770.1, 1314032.4, -441177.8, -570313.3, -244275.02, 363431.5, 358078.62, -130600.695, 373505.88, -40176.08, 129744.24, -942204.8, 76576.1, -417379.94, 578027.56, -471254.84, 420417.72, 280707.94, -335972.62, 428635.7, 4909.749, -243533.55, -1019419.4, 24490.398, 657060.4, 295327.34, 527804.0, -432473.6, -286850.03, 567848.7, 51607.77, -552233.9, -433245.66, 1009141.25, -671507.44, -177802.75, 340067.56, -662954.94, -212779.55, -114343.3, 1283607.5, 432346.44, 683062.9, -34038.3, 211218.05, -375319.56, 474982.1, 145012.8, 38823.145, 162498.48, 70806.1, -690006.5, -957840.2, -520371.28, -293312.8, -44819.53, -301235.66, 374200.0, -119110.58, -486041.06, 13336.197, 296707.38, 19523.871, -615992.94, 432127.6, 86008.6, 40079.84, 567376.3, 90638.234, -552533.06, 911747.9, -182703.83, 287787.3, 75035.72, 811205.1, -1113341.6, 350981.22, -447532.16, 159449.11, -470867.88, 536305.9, -240490.12, -46386.77, 8445.874, -1180168.2, 206950.08, -606987.44, 621711.6, -880777.44, -284274.53, 449394.3, 640043.44, 340386.12, -944886.5, 791771.7, 332524.4, 538319.56, -20771.7, 219674.05, 463463.5, -847362.1, -43355.26, -163291.28, -408889.78, -557392.6, 76796.086, 401920.56, 683335.3, -51431.35, -70731.67, -110053.03, 378504.25, -200534.23, -7452.2637, 135632.97, 160529.61, -576485.4, -338177.97, -176803.61, 18329.79, 644087.8, 248298.94, 74442.19, -65179.375, 133960.5, 31635.379, 950922.8, -602072.6, 364885.16, 14073.439, 681994.3, 668341.5, 523067.53, -688600.6, -6854.96, -175088.86, 248357.86, 101847.54, -71741.1, 178116.9, 110545.48, -431394.78, 514187.56, -370323.62, -455625.06, 331355.38, -175551.72, 192042.72, -40832.74, 396292.5, -92797.336, -253946.28, 123474.6, 460203.0, 36378.645, -91261.63, 439552.06, 195189.77, -189463.69, 196462.45, 112647.71, 880631.5, 780619.44, 218941.06, 47037.22, -210489.86, 200235.0, -322028.38, 222124.17, -82411.14, -89290.555, 186199.4, 228318.38, -632238.06, -410253.56, -64574.305, 647586.2, -629711.1, 49502.125, 233729.2, -248008.33, 923639.8, 338341.6, -358340.44, 85002.81, 338509.03, 408567.78, 630723.2, -212298.34, 88647.55, -329774.03, -131070.766, 285015.25, 176342.55, -54452.008, -94604.05, -792253.5, -80072.25, 241312.48, 93319.72, 347935.56, -11096.147, -15777.421, -131342.77, -845.3183, 394148.3, -79843.01, 110217.055, -128737.22, 559503.25, -424314.38, 211668.88, 335220.4, -252849.97, 333142.4, 407503.03, -168891.67, 131141.75, -74377.98, 186962.2, 400045.06, 123447.99, 320646.38, -156664.42, 118421.8, 242351.92, -154626.73, -485997.2, 14256.008, 342167.34, -5157.0864, -393727.8, -320026.03, 215822.34, -115339.9, -182508.17, 181598.45, -314674.44, -337163.06, -638116.3, -806816.6, 322000.84, 493134.1, -580331.6, 754334.56, 461393.2, 52732.902, 403899.94, -285247.22, 365956.38, -90018.43, 167596.97, 843612.06, -1158371.0, -327230.12, 181202.23, 780117.94, -22717.309, 494661.28, -475946.22, -386022.97, -26480.656, 1060557.0, 464957.3, 528096.56, -27506.633, 66548.05, -146656.52, 675886.06, -361228.12, 485375.88, -420804.5, 421315.5, -557787.0, 773703.94, -251907.0, -237544.88, 607852.75, 475431.0, -485509.88, 708893.75, 266408.6, 270786.28, 196841.53, -283712.12, 7127.57, -403990.7, -172366.4, 260036.62, 87008.94, 107215.64, -465587.47, 311483.62, 298279.8, 339554.44, 235092.12, 81721.06, -409718.25, -316410.34, -113009.86, -250653.31, 18518.287, -176272.94, -260624.23, -93473.8, 57419.863, 17544.115, -189000.86, 338619.9, -388864.94, 863578.2, -27318.346, 190289.06, -262794.8, 733670.8, -156942.23, -22375.47, -641714.44, 568505.06, 415449.72, 123550.0, -565135.1, 464985.4, 300359.8, -559607.94, 416756.5, -1066366.8, 1307975.5, -1263097.9, -47378.07, 197106.56, -261774.3, -38806.625, -768497.56, 850021.8, 399080.12, 666938.9, -146541.52, -30593.512, -202417.23, 510526.4, 163757.08, -15579.0, 219537.94, 400253.25, -534055.9, -174846.03, -344364.94, 413283.78, -264328.0, 466161.8, -322107.03, -559171.25, -802238.0, 463061.34, 126345.984, 175312.92, -894432.06, -244958.64, -11806.419, 40507.34, 153357.84, -169825.62, 69130.51, -267136.25, 145252.88, 209683.5, 371316.94, 417606.7, -721448.8, 491126.0, 213300.7, 253628.64, 349973.97, 721840.5, 45572.105, 370456.44, -11125.515, 300163.97, -480277.66, 39469.668, 351183.66, 264422.1, 723425.44, -271539.9, -101645.74, -388138.06, 591538.94, -642378.7, -18786.502, -42367.547, 550723.7, -302760.12, 103509.18, 321271.62, 329376.3, -63661.363, -130277.94, -913746.6, 594578.75, -34299.23, 118927.234, 197447.52, -933478.5, 538215.5, -343325.7, 1364599.8, -118154.73, 228826.36, 326693.06, 146270.39, -6674.9526, 185690.8, 354456.66, 809061.3, -121665.5, 28343.021, 588688.25, -888120.25, 338773.16, 64745.336, -638619.0, -561238.94, 252251.73, -96452.01, 444310.44, -685749.6, -139155.78, -106100.26, 613803.0, -186771.02, -307519.75, -164126.9, -211971.5, 524889.44, 484707.06, 914867.3, 166360.86, -666583.7, 7212.1265, -287452.94, 808793.44, -254934.86, 30468.803, -663893.7, 325602.28, 610050.2, -594127.4, 67641.66, -348935.03, -706280.2, 1041940.5, 602857.06, -460202.8, -179048.78, -438904.62, 157364.11, 720209.06, -82688.52, 269776.12, -231869.03, 194742.23, 183346.6, -73315.65, -331722.3, -246580.33, 148548.56, 346790.03, -152315.06, -325197.6, 156180.94, -265605.6, 633348.56, -950208.44, -435542.47, -43400.883, 685297.25, -48788.645, -157622.11, -371598.6, -555005.06, 738530.0, 455547.16, -714981.5, -426462.66, -9990.938, 575.87695, 667585.5, -516162.03, 379673.56, -1304487.8, 184363.84, -442595.6, -186862.27, 529613.0, -9717.251, -1101291.6, -488943.4, 247748.25, -240342.27, 531468.8, -182657.58, 615422.75, 839317.7, 271108.12, -138725.75, -388861.56, 593384.3, -511992.5, 698088.8, -339420.22, -592174.06, -1188940.9, 877449.06, -312476.22, 266040.8, 381258.66, -548304.94, -311342.16, -250185.19, 635127.3, 21768.014, 330597.62, -375547.62, 155203.14, -762350.8, 97761.54, -675153.75, -14783.086, 133275.6, -38175.945, 33869.145, -27238.275, -1214719.5, -432868.47, -66721.734, 30325.404, -94185.08, 216585.56, -690332.7, -407812.75, 641961.3, 428902.97, -396760.0, 96307.36, 145596.64, 8289.664, 297814.9, 318362.75, -399569.2, 255561.61, -152541.98, 187768.6, -423808.84, -815297.2, 238999.7, -780392.5, -205680.48, -245923.75, -9200.836, -281964.72, 315021.34, -352218.2, -85546.34, 381994.3, -420452.22, 724894.2, 374571.06, -141024.92, -472847.62, -575432.1, -214079.05, 444608.88, -355474.38, 700542.0, 682593.8, -433320.34, 619883.56, -398992.78, 163667.06, -518181.56, 71798.97, -21254.447, 201385.11, 36765.832, 401019.0, -261741.05, 227092.42, -369257.0, 557241.25, 102644.7, -336599.6, -821507.5, 384800.44, -457801.2, 288672.06, -51571.92, 540288.8, -859523.5, 526930.6, -122278.31, -869416.4, 235892.92, 523239.44, -600959.25, 392601.1, 9778.5625, -1223208.1, -333062.2, 1165893.8, 456716.66, 991294.0, 288613.88, -852409.2, 299177.12, -472817.94, 287328.3, -198522.98, 312270.75, -458150.66, 212536.64, -66070.164, 301048.38, -136732.36, -198724.7, 612474.0, -466136.06, 432132.6, 80413.07, 54466.01, 435145.12, -197547.23, 239482.22, 4295.8867, -535483.1, 156985.61, 13801.761, -745572.7, 714829.6, -254615.98, -195057.3, 113420.63, -1500831.5, 777852.6, -545415.94, 569164.94, -311531.7, -5255.1694, -107542.18, 540274.75, -277865.94, -110360.72, 633399.9, -165800.16, 617651.06, -110215.15, 30897.967, 113947.82, 85737.7, -287218.56, 406261.1, -32544.596, 19718.691, -321140.34, 212822.47, 92713.53, 344242.88, -79273.54, 108193.766, -321223.03, 120830.945, -73600.8, 133926.27, -174021.73, 149225.66, 55790.49, 155165.34, -13841.506, -466974.38, 586681.25, -445737.84, 591586.7, -300844.06, 527261.1, 634401.7, -27868.982, -117947.14, -383211.7, 375137.06, -94264.99, -122303.2, 439274.2, -412958.72, -464890.94, -192622.19, -210863.88, -354137.12, -130496.8, -526732.56, 216310.33, 191044.5, 690785.56, -651051.94, 144425.0, -486125.47, 235550.81, -150491.56, -208229.95, -66416.42, -369646.78, 119508.766, -7684.4287, 471494.47, -35572.67, 755125.56, -1025461.8, 364435.34, 80811.836, 1040931.56, 919459.2, 436254.6, -489940.66, -771844.3, 490056.78, 423730.03, 208104.75, -399128.94, -270489.4, -525818.3, 462195.78, 473417.6, -764306.0, 53545.098, 63296.625, -44818.953, -789765.3, 416673.28, 402027.03, -58535.113, 243088.48, 798127.7, -278636.16, 98503.836, -391469.78, 437866.7, -269875.25, 860772.5, -266640.44, -136665.02, -285174.06, -124376.586, 1009205.06, 40303.688, -595938.2, -634774.8, 101966.51, 170903.14, 856310.06, -265867.44, -12661.838, -998387.5, -424359.4, -227915.05, 173138.31, -215846.83, -34293.086, 34453.527, 81715.79, 928715.4, -651773.75, 314601.25, -182215.78, 420943.5, 401603.44, 198413.73, -329062.28, -357514.56, 613648.25, -427357.78, -330762.38, 9312.679, -170551.22, 387937.25, -900629.0, 193788.3, -477494.8, -188713.9, 602528.2, 364454.53, -716616.75, 175580.23, -148701.2, 504635.2, 1089794.9, 77736.28, -105431.875, -1225278.0, 117813.71, 86322.43, -17800.861, 133032.33, -704975.06, -439162.34, -105647.05, -61349.234, 376302.0, -162888.64, -820437.2, 332989.5, -65912.06, 64663.215, 810.4529, 275380.25, -25325.14, -573588.56, -606322.2, -111683.81, -463904.56, 763940.94, -155286.38, -338724.44, 111042.2, -809095.75, 99687.555, -900645.56, 752234.94, -618807.06, 15664.281, 31692.611, -381360.03, 254704.95, -32249.102, 597029.2, -353932.56, -331065.28, -94619.68, 371960.44, 87744.03, 805516.44, -498893.53, -459445.12, 697861.44, 299521.84, -232080.27, 415294.4, 376640.25, 338144.6, 723188.7, 255819.58, 112846.98, -950371.56, -170541.38, 214223.16, -226145.55, -110193.016, -329846.0, -413391.88, 448570.25, -459841.06, 166117.45, -397900.84, -319240.12, -815406.5, -338041.12, 750362.8, -245619.11, -80147.87, 377941.38, 305349.84, -217464.55, -108069.5, -319313.06, -149857.61, 757880.7, -164789.52, 426309.38, 216166.62, -278778.62, 710504.9, -164475.02, 500805.16, -107301.055, 11207.833, 144439.1, 8526.483, 14283.452, 487593.06, 627399.5, -687724.94, 497265.22, -584969.3, 939404.75, -1123246.9, 154198.88, 83486.734, -148870.58, 92711.31, 262462.5, 592902.4, 462761.2, 512831.5, -685266.1, -675331.1, 1075917.5, -276893.03, 564480.25, 282241.0, -495857.25, -383803.25, -453111.62, 554207.5, -53344.3, 340747.28, 129824.945, 240774.89, -567510.3, 816375.5, -344331.4, 136309.67, 225962.34, -672105.94, 142422.86, -320673.44, -154302.11, -494993.53, 127286.805, -324779.06, 82599.08, 70761.664, -355317.6, 569238.06, -547035.56, 1346416.6, -543686.3, 405388.12, -482489.0, 416449.94, -118507.44, 746278.94, -529881.06, 458000.4, 555809.9, -667457.94, 901328.94, -394680.03, 589902.75, -734405.44, -11698.436, 614697.2, -149475.03, 600050.2, -907836.3, 540588.56, 94119.57, 271220.78, -300335.0, 262496.12, 5445.7793, 663025.7, -283596.97, 559433.1, -370034.16, -60350.023, -572036.6, 425305.34, -287849.0, 56170.203, 173995.3, 450298.4, -603958.3, 644733.75, -92807.34, -741238.4, 620670.1, -390094.2, 135953.0, -862582.9, -179321.1, -42062.47, 141421.38, 597997.3, -339558.6, -386765.56, -259166.77, 52899.855, 56511.11, 349029.06, -139893.86, 445389.72, 376969.34, 345687.16, 186982.61, -311946.66, 119804.09, -808360.4, 240898.53, 404947.12, -950566.4, -344335.38, 200510.2, -96556.336, 19993.549, 188499.8, -282313.66, 58272.027, -513074.56, 1022225.44, 413826.22, -401052.22, 332042.56, -474157.1, -137976.77, -160890.92, -150381.42, 976700.6, -334676.0, 134173.0, -226066.45, 1260868.5, 120175.72, 143760.92, -212133.42, -167950.06, -23408.262, 286206.7, -156822.0, -150333.67, -348677.84, 109391.41, 39241.96, 792779.75, -308658.84 });
    Tensor *actual = NN_zeros(4, (size_t[]){ 1, 14, 14, 6 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Conv2d(actual, x, w, b, (size_t[]){1, 1}, (size_t[]){0, 0}, (size_t[]){1, 1}, 1);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-4) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

}