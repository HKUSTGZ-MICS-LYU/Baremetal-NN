
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <rv.h>

#include "nn.h"
#include "unittest.h"

int main() {
  enableAcceleratorFeatures();

  size_t cycles;

  
  {
    printf("abs:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.374341, 26.82218, -41.152256, -36.79695, -19.257719, 13.407868, -0.990659, 39.644474, -4.4372025, 13.230628, -15.110654, -9.82827, -47.767426, -33.114105, -20.611155, 1.8521786, 19.76676, 30.00114, -33.897053, -21.773142, 18.160856, 41.519398, -10.290009, 37.41559, -8.059168, 5.2907047, 45.27381, -46.38352, -31.476896, -12.658262, -19.489998, 43.20004, -32.40898, -23.016644, -34.932022, -46.82805, -29.187023, 42.9799, 22.310919, 24.233627, 2.629578, -25.634176, 8.459234, -46.684734, -36.12831, -25.776499, 31.546896, 29.316061, -22.174751 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.374341, 26.82218, 41.152256, 36.79695, 19.257719, 13.407868, 0.990659, 39.644474, 4.4372025, 13.230628, 15.110654, 9.82827, 47.767426, 33.114105, 20.611155, 1.8521786, 19.76676, 30.00114, 33.897053, 21.773142, 18.160856, 41.519398, 10.290009, 37.41559, 8.059168, 5.2907047, 45.27381, 46.38352, 31.476896, 12.658262, 19.489998, 43.20004, 32.40898, 23.016644, 34.932022, 46.82805, 29.187023, 42.9799, 22.310919, 24.233627, 2.629578, 25.634176, 8.459234, 46.684734, 36.12831, 25.776499, 31.546896, 29.316061, 22.174751 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_abs(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -1.8041193, 31.978035, 49.706657, 19.844109, 6.7546425, 33.524315, -29.440117, 9.317202, -38.765274, -34.65431, -25.829178, 22.623652, 20.10802, -29.617626, 15.105354, 27.4486, -6.3108683, 1.9090772, 11.585236, 31.01883, 48.009705, -38.531178, -18.323486, 19.650496, 41.427467, 43.510365, 44.11784, 9.950727, -43.479134, 4.5996246, -31.280268, -46.597706, 44.42462, 38.01799, -49.876396, 9.358603, -8.423, -8.228058, -22.887844, 19.227808, -29.615175, 18.329567, 25.285404, 35.79358, 18.695557, -49.486763, -32.434845, 24.965752, 10.465068 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -39.0042, -28.790974, 47.037464, 33.690895, -21.801258, -12.584239, -47.629906, -0.8987069, -37.652946, -38.567837, -2.7549803, 7.5072527, -20.476515, 29.66888, -30.426956, 45.368504, 34.26499, -42.164146, -12.444216, 2.2561312, 7.2950544, 11.858713, 19.621414, 2.9950082, -24.396437, 23.65945, -47.962444, -29.635334, -12.516493, -24.355667, -17.491669, -40.981083, -10.635757, 10.687822, -32.573288, -2.565968, 35.79254, -5.1400127, 1.3896108, -4.313445, 10.119068, 31.791973, 47.36231, 31.752794, 47.470676, -3.6160827, -44.916077, -23.703861, 34.04526 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -40.80832, 3.1870613, 96.744125, 53.535004, -15.046616, 20.940075, -77.07002, 8.418495, -76.41822, -73.222145, -28.584158, 30.130905, -0.36849403, 0.051254272, -15.321602, 72.81711, 27.954124, -40.25507, -0.8589802, 33.27496, 55.30476, -26.672464, 1.2979279, 22.645504, 17.03103, 67.169815, -3.8446045, -19.684607, -55.99563, -19.756042, -48.771935, -87.57879, 33.788864, 48.70581, -82.449684, 6.7926345, 27.369541, -13.368071, -21.498234, 14.914363, -19.496107, 50.12154, 72.64771, 67.54637, 66.16623, -53.102844, -77.35092, 1.2618904, 44.51033 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("addInplace:             ");

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.3241241, -24.852318, -38.31559, -46.792603, -42.20041, -10.141838, 27.4203, 27.032053, -48.221596, 31.189102, -39.125473, -10.570515, -20.273632, -9.630764, -9.817135, -44.867496, -43.171894, -7.8239737, 0.64660907, -22.713745, 18.83496, -45.00292, -3.374362, 43.970974, -20.3946, 45.150154, 18.107689, -45.123047, 31.634867, -5.769724, -22.320343, 39.982666, -40.404762, 5.365247, -10.468435, 35.70563, 13.957226, 24.025267, 17.657948, -12.023735, -10.515272, -41.20407, 27.092207, 39.698906, 34.211243, -35.268913, 2.2299945, -35.246704, -27.524208 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.3241241, -24.852318, -38.31559, -46.792603, -42.20041, -10.141838, 27.4203, 27.032053, -48.221596, 31.189102, -39.125473, -10.570515, -20.273632, -9.630764, -9.817135, -44.867496, -43.171894, -7.8239737, 0.64660907, -22.713745, 18.83496, -45.00292, -3.374362, 43.970974, -20.3946, 45.150154, 18.107689, -45.123047, 31.634867, -5.769724, -22.320343, 39.982666, -40.404762, 5.365247, -10.468435, 35.70563, 13.957226, 24.025267, 17.657948, -12.023735, -10.515272, -41.20407, 27.092207, 39.698906, 34.211243, -35.268913, 2.2299945, -35.246704, -27.524208 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_addInplace(actual, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("add1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -29.135275, 17.087252, -29.795658, -1.0908604, 2.1034062, 32.23115, -37.796, -34.32561, -29.033077, 34.99667, -17.97325, 42.174435, 18.080378, 6.3313007, -0.3722012, -9.884077, 6.2733173, -11.417234, -0.3513217, 6.379652, -39.110256, -26.206572, 40.374638, -40.577335, -3.5903096, 49.461937, 18.061852, 1.415652, -43.330498, 24.768894, -35.614037, -14.1932125, -16.775816, -7.4043694, 0.54691434, 41.240376, 6.2419415, 44.78464, 30.585623, -31.610697, 22.425205, -35.344803, -21.191257, 14.706135, 16.509605, 37.511402, -16.095793, 0.08004308, 25.741179 });

    float v = 0.8444218515250481;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -28.290854, 17.931673, -28.951237, -0.2464385, 2.947828, 33.075573, -36.95158, -33.48119, -28.188656, 35.84109, -17.128828, 43.018856, 18.924799, 7.1757226, 0.47222066, -9.039656, 7.117739, -10.572813, 0.49310017, 7.224074, -38.265835, -25.36215, 41.21906, -39.732914, -2.7458878, 50.30636, 18.906273, 2.260074, -42.486076, 25.613316, -34.769615, -13.348791, -15.931395, -6.5599475, 1.3913362, 42.084797, 7.0863633, 45.629063, 31.430044, -30.766275, 23.269627, -34.50038, -20.346836, 15.550556, 17.354027, 38.355824, -15.251371, 0.92446494, 26.5856 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_add1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("clip:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -48.354607, 36.149033, -41.346123, 0.68912506, -8.500838, -26.333649, 6.608552, 41.345936, -14.615976, -29.684704, -18.491941, -49.55742, 22.569698, -24.013186, -33.367012, -28.80507, 28.747803, 26.478683, 38.37609, 18.136156, -16.697985, -13.972407, 14.771498, 41.101734, 13.594609, -23.657269, -23.50387, -47.273453, 10.802401, -28.059124, -44.57879, 43.843822, -32.47056, -5.688077, 14.3246765, 1.5929163, -33.644085, -40.416084, 39.854122, 8.141935, 41.481228, -16.76203, 14.727772, -11.43381, -2.2235572, -30.45221, 16.910046, 15.808296, -1.0314286 });

    float v_min = -0.24204559705969753;
    float v_max = 0.420571580830845;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.2420456, 0.4205716, -0.2420456, 0.4205716, -0.2420456, -0.2420456, 0.4205716, 0.4205716, -0.2420456, -0.2420456, -0.2420456, -0.2420456, 0.4205716, -0.2420456, -0.2420456, -0.2420456, 0.4205716, 0.4205716, 0.4205716, 0.4205716, -0.2420456, -0.2420456, 0.4205716, 0.4205716, 0.4205716, -0.2420456, -0.2420456, -0.2420456, 0.4205716, -0.2420456, -0.2420456, 0.4205716, -0.2420456, -0.2420456, 0.4205716, 0.4205716, -0.2420456, -0.2420456, 0.4205716, 0.4205716, 0.4205716, -0.2420456, 0.4205716, -0.2420456, -0.2420456, -0.2420456, 0.4205716, 0.4205716, -0.2420456 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_clip(actual, a, v_min, v_max);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("div:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -11.245108, -30.821491, 34.57724, -37.221207, 20.483273, -16.812675, -24.1234, 8.982253, -25.972849, 11.520243, 9.819042, -37.124474, 8.324927, 21.29646, 19.79155, -6.293935, -40.98938, -7.707703, 17.365383, -18.243855, 18.979055, 33.29813, -26.10758, 0.49309134, 20.67495, 3.9188921, 4.1765747, 6.243271, -39.307384, 3.9294124, 34.623493, 45.055687, 29.387547, 6.7001524, 23.35071, -24.323982, -41.434418, -42.996056, 49.880486, 31.739468, -34.561687, 19.562132, 37.75838, 49.980743, 43.719746, 38.73769, -11.462963, -17.547083, 41.052444 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 28.018982, -30.08895, 44.95086, 24.157928, 27.256775, -31.338818, 14.34499, -17.528122, 39.06783, -8.997029, 19.465626, 8.881092, 21.27341, -16.991377, 24.378569, -34.923546, 11.292749, -33.829594, -49.326878, -40.152786, 39.473503, 27.051783, 46.910786, 40.05606, -44.65227, -34.121555, -8.079129, -32.471615, 34.719826, -37.80039, -24.395073, -48.30457, -28.387278, 41.123875, 40.938004, 35.791885, 38.606365, 44.459324, -12.803149, 22.000105, 44.54652, 16.54094, 49.983818, 25.933147, 31.082417, -17.499607, 23.991377, 5.7453275, -11.940866 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -0.4013389, 1.0243459, 0.7692231, -1.540745, 0.7514929, 0.53648084, -1.6816603, -0.51244813, -0.66481423, -1.2804496, 0.5044298, -4.18017, 0.39133015, -1.2533686, 0.81184214, 0.18022038, -3.6297078, 0.22783907, -0.3520471, 0.45436087, 0.48080495, 1.2309034, -0.55653685, 0.012310031, -0.46302122, -0.11485092, -0.51695853, -0.19226857, -1.1321309, -0.10395164, -1.4192822, -0.9327417, -1.0352365, 0.1629261, 0.570392, -0.6795949, -1.0732535, -0.9670875, -3.8959544, 1.4426962, -0.7758561, 1.1826494, 0.7554121, 1.9272919, 1.4065748, -2.2136319, -0.47779512, -3.0541484, -3.4379787 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_div(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("fill:                   ");

    float v = 0.25891675029296335;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674, 0.25891674 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_fill(actual, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmulT:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -28.185493, -28.055828, -38.47404, 33.566517, 35.54656, -5.6906343, -28.9343, 38.645275, 31.974447, 3.7167013, -23.606766, 45.952393, 20.447033, -37.957268, 47.854145, 37.96869, -18.224543, 28.107727, -28.40945, -7.8357162, 42.45506, 2.0659566, -35.36091, -16.711647, -13.572258, -9.64644, 4.7850313, 46.24148, 2.6770175, -30.872, 2.5627136, 23.97436, 24.802011, -45.696926, -8.947123, -37.157227, -21.334278, 18.01467, -35.50651, 18.586344, 42.438908, 3.2794178 });

    Tensor *b = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ -33.324387, -17.914248, 10.918206, -38.115902, 24.840515, -45.39348, -48.064667, -48.58303, -10.143167, 33.621643, -47.323948, 41.559357, -20.001143, 14.644205, 2.280146, -45.085953, 41.46645, 26.922173, 49.699783, 25.260609, -33.00345, 41.729187, 2.6872218, 23.710823, -40.091454, -14.381325, -49.09388, -19.474625, 10.786557, -39.258087, 15.9382105, 26.840342, 6.9654646, -33.454166, -38.765984 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ 2274.4077, -60.757534, 3086.7974, -3177.8782, 2644.7632, 1117.4672, -14.766062, 2218.1409, 1807.6368, -305.29016, -5935.8247, -5055.164, -4612.768, 506.40118, -2092.002, -1779.9381, 519.2847, -1344.0579, -857.64996, -1240.0193, 2698.4922, 948.40643, 2523.3145, 1189.3425, 3973.5308, 1548.1006, 4279.2334, 2555.782, -2171.8728, -1646.5665 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmulT(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("matmul:                 ");

    Tensor *a = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -15.425831, 21.947908, 49.31982, 28.751451, -5.6304636, 17.530823, -49.053146, -42.705067, 23.330397, -28.320759, 24.054783, -35.296608, -24.765545, -41.18445, 26.092035, -5.0947547, 38.480057, 30.943607, 27.66713, 1.6078055, -15.4588995, -10.871583, 6.64503, 24.785477, -35.029495, 41.963894, -5.436504, -41.897278, -27.05289, 44.240887, 45.72636, -46.313984, 35.264915, 25.05796, 29.595924, 42.32646, -26.947515, 15.788788, 20.46166, -14.774668, 16.732656, -14.385671 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 5 }, DTYPE_F32, (float[]){ 30.913067, -13.87273, -18.639786, 12.587452, 17.734682, -24.428581, 4.419917, 28.976786, -4.9748363, 15.216696, -12.059349, 17.524982, -36.21971, -29.40144, -25.379526, 45.950542, -13.454205, -0.13651848, -24.224775, 49.914505, 48.833508, -37.70933, -40.533493, -37.89965, -0.24113655, -12.745195, -32.727283, -17.933607, 9.446544, -26.124537, 11.079126, -11.465794, -24.228168, 6.869274, 41.11291 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -1328.4912, 989.5255, 235.5387, -2407.8916, -2229.5415, -2307.5159, 2489.3284, 5367.193, 417.2095, 479.3878, 3048.1938, -1045.125, -2807.679, -2666.771, 268.90277, -752.5755, 161.72527, -1086.0978, -1979.6276, -4059.8242, -2865.9749, -493.92615, -2459.4988, -1679.6075, -2725.1838, 1622.4119, -530.415, -1497.1368, 326.1509, -63.79105 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_matmul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("max:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -33.803963, 2.3217201, -18.438387, 49.065315, -47.438164, -47.93306, 49.26925, -31.634499, 9.586167, -4.3153048, -10.53285, -11.167389, 31.77203, 2.3898482, -48.68073, -29.51801, -17.045015, 25.16082, -32.356686, 47.14598, -11.136466, -8.978099, 39.177902, 25.130384, 42.406017, 28.922218, -15.167695, -33.173622, -3.7201524, 41.381878, -16.78099, -46.368496, 20.496422, 48.67357, -14.234161, -41.401176, -45.35298, 12.529969, -3.7859857, -25.249363, 10.106593, 18.987942, 39.76595, 38.81911, -7.4841857, -44.088356, -45.181156, 46.68448, 22.10276 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ 49.26925 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_max(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("maximum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 21.795368, -43.26105, 46.300785, 47.367157, 45.143013, -42.179253, -18.866169, -34.38819, 47.348278, -21.484, -22.827726, 26.195644, -23.129618, -24.626106, -4.3735743, -4.805976, -38.948925, 41.683407, -22.056086, 17.735744, 43.48918, 25.215822, 7.0789933, 42.54285, 6.7213116, -23.132832, 47.299976, 11.834025, -48.784042, -14.234579, -34.058372, 43.83765, -8.257294, -45.576244, -3.1431675, 31.400644, 12.990022, 15.810222, 4.6436605, 18.640936, -12.182599, -19.89001, -46.735424, -37.666847, 21.670128, -29.605669, 7.1733236, 15.959573, 3.540194 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -32.41749, 47.81642, -29.074972, 41.12503, -39.775414, -12.027425, 27.19844, -20.429033, 42.002148, -34.407825, -41.988575, -22.545958, 8.082521, 46.037792, -23.870045, 17.88141, -12.535352, -10.843116, 36.76517, -38.749294, 5.3106666, 47.02046, -6.8706093, 38.821907, -15.3978405, 40.248108, -48.366516, -7.2061834, -8.782321, 16.20425, 19.616371, 38.390846, -7.449299, -1.9827545, 34.240562, -13.528657, 43.83168, -33.290607, -5.4104924, -2.6855469, 22.310495, 34.183807, -7.9251885, -41.42403, 24.77461, 14.956588, 20.084965, -30.843384, 32.17978 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 21.795368, 47.81642, 46.300785, 47.367157, 45.143013, -12.027425, 27.19844, -20.429033, 47.348278, -21.484, -22.827726, 26.195644, 8.082521, 46.037792, -4.3735743, 17.88141, -12.535352, 41.683407, 36.76517, 17.735744, 43.48918, 47.02046, 7.0789933, 42.54285, 6.7213116, 40.248108, 47.299976, 11.834025, -8.782321, 16.20425, 19.616371, 43.83765, -7.449299, -1.9827545, 34.240562, 31.400644, 43.83168, 15.810222, 4.6436605, 18.640936, 22.310495, 34.183807, -7.9251885, -37.666847, 24.77461, 14.956588, 20.084965, 15.959573, 32.17978 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_maximum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("min:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 47.35775, 4.3385687, -46.70242, 35.099495, -37.072563, 11.493606, 7.2658896, -23.401827, 17.409779, -44.721634, 11.387974, -31.697548, -5.406684, 6.4314423, 42.59722, -23.856014, 32.031803, -6.3516912, -23.74639, -43.53998, -45.87592, 48.830532, -12.469977, 2.4974406, 13.555616, 33.98661, 42.673706, 40.550858, -37.044155, -8.01084, -29.586882, -28.567589, 11.8603525, 46.9324, -40.0552, 30.260223, -25.923336, -9.738713, 39.688545, -11.308516, 4.552788, -34.951626, 42.562042, -6.463492, -36.569523, 14.640516, -35.55087, -39.675365, 3.0459583 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -46.70242 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_min(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("minimum:                ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 39.642178, -14.1492, 23.533344, 42.96606, 33.163048, -26.228052, -5.480993, -15.734243, -40.206146, 0.02065897, 37.621754, 42.12578, 4.6650352, 11.356152, -21.646082, 37.74212, -20.805424, -34.73264, 7.6996746, 29.969269, -45.07958, 45.198376, 17.986553, -35.03064, -10.770374, 43.378998, -38.361732, -14.613861, 16.399014, -43.804253, 27.409912, 26.027382, 31.010277, -31.877357, 49.80005, -29.638077, 49.917023, -47.984524, -44.5485, 30.709816, 5.2256465, 2.8844655, -27.68792, -20.973772, -14.619374, -48.70777, 2.5984347, 8.842945, -0.04233122 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 16.146517, 47.44255, 13.294202, -18.303621, -20.577335, -31.990278, -34.660942, -8.052492, -8.843279, 22.243124, -21.371841, 39.860184, -35.084007, 0.1421094, 44.945995, 49.719257, -28.963112, 8.906448, 5.9061346, -23.442585, -17.274744, 13.5427, -34.76826, 8.2497835, 21.636236, -19.703506, 41.53206, -3.290522, 22.685635, 49.51532, -15.283418, 27.170408, -14.301461, -7.303649, -8.473557, -0.3106296, -18.88842, 11.719346, 1.8840194, 31.69449, -10.120267, 5.0140085, -18.599516, -41.872684, 20.233362, 6.397897, -20.024187, -16.905249, 13.076067 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 16.146517, -14.1492, 13.294202, -18.303621, -20.577335, -31.990278, -34.660942, -15.734243, -40.206146, 0.02065897, -21.371841, 39.860184, -35.084007, 0.1421094, -21.646082, 37.74212, -28.963112, -34.73264, 5.9061346, -23.442585, -45.07958, 13.5427, -34.76826, -35.03064, -10.770374, -19.703506, -38.361732, -14.613861, 16.399014, -43.804253, -15.283418, 26.027382, -14.301461, -31.877357, -8.473557, -29.638077, -18.88842, -47.984524, -44.5485, 30.709816, -10.120267, 2.8844655, -27.68792, -41.872684, -14.619374, -48.70777, -20.024187, -16.905249, -0.04233122 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_minimum(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -9.040844, 32.673794, 2.8321564, 18.886835, 21.784813, -12.268316, 21.633244, 36.896664, 2.300918, 9.784645, 1.8167794, 34.61837, -21.109766, -26.578491, 21.78768, -43.515705, 0.80162287, -22.994555, 33.00168, -46.551956, 30.316628, 49.46784, 10.117006, -3.3313334, 49.21749, -21.367615, -4.0066776, -21.895248, -6.902063, 10.866946, 6.6780686, -9.443748, -49.99203, 2.5602043, -1.4810979, 7.521838, 38.31251, 48.60047, -29.664124, -3.1177223, -20.033682, -46.082283, -36.382954, 46.928055, 29.153055, 26.857555, 27.78716, -39.72395, 5.2509604 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 46.53573, -27.904297, 44.479717, 13.141924, 35.177177, -21.419382, 23.050886, -44.324387, -3.1747758, 16.677559, 14.994722, 41.840405, 49.132854, 45.48785, 33.56961, 35.153103, -6.4514875, -38.802345, -18.561357, -5.613226, -27.019327, 25.558544, 17.551363, 8.067596, 12.078035, 43.922615, 18.211567, -43.84697, -36.294037, 22.037483, 6.813961, 24.384583, -49.935997, -46.143467, 30.66132, 31.982285, -45.23555, 18.979263, -39.04221, 37.865387, 15.689522, 49.439346, -49.2996, -48.13381, 33.805103, 44.391155, 30.633999, 33.241493, -42.113567 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -420.72226, -911.73926, 125.97352, 248.20935, 766.32825, 262.77975, 498.66544, -1635.422, -7.304899, 163.18399, 27.242102, 1448.4467, -1037.1831, -1208.9984, 731.40393, -1529.712, -5.17166, 892.2426, -612.55597, 261.30664, -819.1349, 1264.3259, 177.56725, -26.875853, 594.4506, -938.52155, -72.96788, 960.0403, 250.50372, 239.48015, 45.5041, -230.28186, 2496.4019, -118.1367, -45.41242, 240.56557, -1733.0875, 922.4011, 1158.153, -118.05376, -314.31888, -2278.2778, 1793.665, -2258.826, 985.52203, 1192.2379, 851.2319, -1320.4834, -221.13667 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("mul1:                   ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 36.19068, -47.207355, 11.170083, -32.75174, -19.859774, 8.853441, -19.659, -7.9111457, -47.391216, -47.14366, 19.368155, -21.163923, -30.419481, -19.729115, -40.878426, -39.97001, 29.918617, 25.412106, 6.6601753, -27.312983, 16.635048, 2.2462606, -35.73364, 10.759491, 45.527195, -49.180317, -49.71961, 6.4062476, 37.651115, -30.424488, 11.006856, 35.149265, 15.415817, 10.820538, 49.8863, 32.573635, -28.121353, 4.3218255, 25.543617, 44.095474, -49.746643, 27.075268, -14.516592, -48.96106, 11.098701, -27.220684, 7.0856094, -32.462345, -37.62645 });

    float v = 0.5112747213686085;

    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 18.50338, -24.135927, 5.710981, -16.745136, -10.1538, 4.5265403, -10.051149, -4.044769, -24.229929, -24.103361, 9.902448, -10.820579, -15.5527115, -10.086997, -20.900105, -20.435654, 15.296632, 12.992566, 3.405179, -13.964437, 8.505079, 1.1484562, -18.269705, 5.5010552, 23.276903, -25.144651, -25.420378, 3.2753522, 19.250063, -15.555271, 5.6275268, 17.97093, 7.881717, 5.532267, 25.505602, 16.654076, -14.377736, 2.20964, 13.059805, 22.5449, -25.4342, 13.842899, -7.421966, -25.03255, 5.6744847, -13.917247, 3.6226928, -16.597176, -19.237452 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_mul1(actual, a, v);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("neg:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -4.2425513, -16.796286, 29.243237, 4.310906, 39.02793, 9.370148, -16.078068, 33.86668, 2.732253, 9.384584, -16.081131, 0.17943978, -9.613657, -4.250866, -38.993965, -0.3074944, -41.502213, -10.75654, 28.97731, -34.767513, -33.702587, -12.208825, -13.706702, 8.464373, 8.300781, 25.354826, -34.444027, -3.5285592, 27.964561, 43.248577, -3.6472738, -28.93101, 14.37313, 28.473866, -31.237495, -29.014671, 22.099913, -3.5032988, -47.224934, -28.829252, 20.276642, -16.958786, 34.51145, 39.526993, 7.273495, -3.953737, -15.871358, -2.528292, 9.101046 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 4.2425513, 16.796286, -29.243237, -4.310906, -39.02793, -9.370148, 16.078068, -33.86668, -2.732253, -9.384584, 16.081131, -0.17943978, 9.613657, 4.250866, 38.993965, 0.3074944, 41.502213, 10.75654, -28.97731, 34.767513, 33.702587, 12.208825, 13.706702, -8.464373, -8.300781, -25.354826, 34.444027, 3.5285592, -27.964561, -43.248577, 3.6472738, 28.93101, -14.37313, -28.473866, 31.237495, 29.014671, -22.099913, 3.5032988, 47.224934, 28.829252, -20.276642, 16.958786, -34.51145, -39.526993, -7.273495, 3.953737, 15.871358, 2.528292, -9.101046 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_neg(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sub:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -38.19255, -11.949783, -41.590046, 30.687744, -31.841814, 45.677193, -12.88904, -28.643763, 24.022657, 7.453954, 34.6228, 20.873487, -48.166973, 31.62452, -9.415692, -22.098553, 31.752693, 36.466515, -43.946533, -4.5211673, 41.06033, 19.36434, 42.123466, -17.134935, -27.58212, 42.995483, 20.841145, 47.999126, -20.88483, -32.10334, -5.8606443, -47.079, 19.598759, 36.87942, 12.002844, -4.940343, 24.790318, -31.737566, 48.912155, -49.717182, -47.897263, -11.815083, 40.842224, 5.0062895, 19.202286, -36.65034, 18.23429, -5.5871725, 20.04118 });

    Tensor *b = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 35.312126, 21.73401, -4.2532086, -3.0799568, -31.35901, -18.085104, 32.491905, -20.049828, 31.051987, -19.826597, -11.644941, 1.0641098, -45.883274, -0.4992485, -5.0397873, -4.491818, -9.995211, 39.418865, 36.899357, -33.887863, 23.22634, -39.219128, -42.566067, 15.284098, 0.73482394, -23.325317, -48.22519, -19.356806, 16.699976, -46.280075, -48.573273, 6.343627, -36.020206, -43.804012, -19.26431, -8.050042, -45.43526, -33.386387, 3.2783926, -47.148586, -7.0277214, -32.285137, -34.661865, 19.65155, -38.484486, -37.89171, 28.514076, 9.348315, 45.53564 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -73.50468, -33.683792, -37.336838, 33.7677, -0.48280334, 63.7623, -45.380943, -8.593935, -7.0293293, 27.280552, 46.26774, 19.809378, -2.283699, 32.123768, -4.375905, -17.606735, 41.747902, -2.9523506, -80.84589, 29.366695, 17.83399, 58.583466, 84.68953, -32.419033, -28.316944, 66.3208, 69.06633, 67.355934, -37.58481, 14.176735, 42.712627, -53.422626, 55.618965, 80.68343, 31.267155, 3.1096992, 70.22558, 1.6488209, 45.633762, -2.568596, -40.86954, 20.470055, 75.50409, -14.645261, 57.68677, 1.2413673, -10.279787, -14.935488, -25.494461 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sub(actual, a, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("sum:                    ");

    Tensor *a = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ -13.364774, -24.150753, -4.627323, 0.25296807, 38.132214, -49.803997, -3.5600364, 22.117609, -27.534151, -25.40704, 24.16339, -47.90926, 11.847788, -38.709324, 24.853092, -42.75202, 30.740238, -47.33163, -42.02834, 0.73684454, 39.39942, -42.81978, -22.302986, 43.914127, -8.3848715, 20.71423, -48.09991, -15.724045, -25.39161, 42.15306, 20.751995, -36.483784, 8.06135, -0.5746722, -20.543491, -28.553831, -16.59193, 39.411324, -35.842617, -35.61717, -15.425957, 0.86981654, 13.610596, 1.5004039, -12.036282, -30.317509, -8.971632, -20.127666, 40.39644 });


    Tensor *golden = NN_tensor(0, (size_t[]){  }, DTYPE_F32, (float[]){ -367.36148 });
    Tensor *actual = NN_zeros(0, (size_t[]){  }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_sum(actual, a);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(a);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Linear:                 ");

    Tensor *x = NN_tensor(2, (size_t[]){ 6, 7 }, DTYPE_F32, (float[]){ -48.670475, -31.89295, -40.67951, -9.137839, 38.96367, 43.82696, -43.527763, -2.1663427, 29.348309, 22.039873, 40.955193, -1.3869107, -33.59464, 33.076523, -17.14573, 25.889307, -12.321824, 21.254707, 44.9713, 46.492775, -45.503254, -33.074017, -20.67334, -31.885052, 47.975002, -4.415941, -33.16703, -22.249472, -27.618229, 20.39947, -43.612556, -46.620155, -49.28806, 21.526205, 24.72273, -31.053955, 12.398929, 36.909233, 7.265067, -10.57908, 3.694117, -5.3613844 });

    Tensor *w = NN_tensor(2, (size_t[]){ 5, 7 }, DTYPE_F32, (float[]){ 25.174957, -33.95057, 25.355125, 28.181177, -30.293734, 40.82818, 49.109238, -19.711435, -14.004719, 24.917776, -39.17102, 19.7729, 11.665237, 31.516487, -43.43034, -41.539238, 22.456455, 18.010538, -46.53831, -27.882975, -45.748924, -35.821144, -22.559982, 41.376923, -9.952545, 28.71756, 47.484047, 22.786612, -44.76052, 25.161135, 19.071728, 38.753277, -49.321712, 30.7508, 40.92707 });

    Tensor *b = NN_tensor(2, (size_t[]){ 1, 5 }, DTYPE_F32, (float[]){ -46.518238, 5.2313147, 42.683655, -36.365406, 16.405964 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 6, 5 }, DTYPE_F32, (float[]){ -3006.556, 665.3782, 1359.1917, 3042.4956, -2092.9954, 910.3113, -795.0106, -361.7276, -997.86444, 3248.3638, -2769.32, -1161.5157, -1489.5093, 1734.6403, -626.73315, -1946.7694, -2902.4849, 4634.0796, -2390.7148, 515.0203, -267.88278, 1059.0826, -861.7331, -677.759, 3232.1836, 99.33588, 743.7635, 2470.6309, 2000.6261, 3119.786 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 6, 5 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Linear(actual, x, w, b);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU:                   ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 22.093868, 13.104505, 49.71379, 40.93898, 42.897736, -6.232339, 41.935627, -46.595634, -26.981466, -10.6940565, -14.852839, 46.18474, 23.583263, 32.19065, 34.01047, -37.350178, -5.79105, 7.3012295, 13.004625, 25.711632, -19.89534, -15.076721, 41.837067, -13.419217, -34.732067, 33.90199, 33.857773, -15.678347, -9.996003, -36.894, -41.75469, 18.802475, -21.359629, 39.804775, -40.03566, -6.911254, 1.0795891, 25.697357, 40.466534, 33.860226, 22.009802, -22.94969, -35.707386, -44.73064, 2.4802327, 48.49401, -9.497124, -2.104926, -36.334698 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 22.093868, 13.104505, 49.71379, 40.93898, 42.897736, 0.0, 41.935627, 0.0, 0.0, 0.0, 0.0, 46.18474, 23.583263, 32.19065, 34.01047, 0.0, 0.0, 7.3012295, 13.004625, 25.711632, 0.0, 0.0, 41.837067, 0.0, 0.0, 33.90199, 33.857773, 0.0, 0.0, 0.0, 0.0, 18.802475, 0.0, 39.804775, 0.0, 0.0, 1.0795891, 25.697357, 40.466534, 33.860226, 22.009802, 0.0, 0.0, 0.0, 2.4802327, 48.49401, 0.0, 0.0, 0.0 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("ReLU6:                  ");

    Tensor *x = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 15.350485, 31.69917, -49.295795, -35.20611, 37.03539, 11.838227, -3.117305, 8.937913, -7.6020956, -34.948246, -46.721493, 32.885395, -5.9468327, -18.569363, -12.905759, -27.271152, -14.809168, -42.92072, 37.41718, 20.417124, -25.216072, -17.065662, 22.431873, -18.51527, 13.184685, 13.767076, -31.474663, 12.525076, 3.0592084, 43.669193, -18.091, -12.853426, 43.080032, -40.830116, 3.612423, 48.175114, -22.418398, 47.93411, 44.367035, 46.516983, -4.7711554, 45.231663, -21.785969, -17.11526, 18.91163, 10.562361, 27.56378, 47.515965, -31.299454 });


    Tensor *golden = NN_tensor(2, (size_t[]){ 7, 7 }, DTYPE_F32, (float[]){ 6.0, 6.0, 0.0, 0.0, 6.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 6.0, 0.0, 6.0, 6.0, 0.0, 6.0, 3.0592084, 6.0, 0.0, 0.0, 6.0, 0.0, 3.612423, 6.0, 0.0, 6.0, 6.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 6.0, 6.0, 6.0, 0.0 });
    Tensor *actual = NN_zeros(2, (size_t[]){ 7, 7 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_ReLU6(actual, x);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Conv2d:                 ");

    Tensor *x = NN_tensor(4, (size_t[]){ 1, 16, 16, 3 }, DTYPE_F32, (float[]){ 26.536333, 16.728228, 26.378405, 23.708618, -18.703497, -39.517803, 40.019238, -28.51178, 31.966358, -47.632175, -8.650118, 0.5299449, 8.651179, 4.0416, 15.755314, -5.567229, 12.24522, 49.479218, -32.352604, -2.729839, -19.086153, 43.87148, 42.801994, -1.3634622, -17.33163, -30.893309, 35.776978, -3.4431815, 47.090477, 28.513098, 43.76523, 39.54618, -32.49211, 14.63511, -20.732944, 25.08766, -4.4954896, 4.328495, -34.58044, -44.686283, 18.828648, 11.61927, 4.34314, 33.95973, -20.87872, 17.74904, -27.538078, 10.359997, -11.4149275, 35.016335, 43.724125, 43.426186, 2.249211, 29.484653, -49.956917, -29.329712, 8.936161, 0.2788484, -39.253647, -22.130579, -23.352707, -49.538105, 4.7685385, 34.0847, 20.29317, -23.756647, -45.91326, -40.338852, 0.9274602, 34.395664, -20.248627, -27.207249, -26.672823, -4.328436, -47.482735, -44.122227, 49.219532, -23.845804, -9.018183, -13.377637, -43.92531, -8.814657, 15.305835, -20.30288, -2.1309912, -0.23917556, -49.77524, 36.33582, 40.388638, 34.090275, -16.419918, 26.12816, -46.846123, -12.369335, -10.169214, -17.657482, 21.000004, -22.782892, -5.7951927, -14.43767, -46.954147, -8.257031, -42.373814, 29.155207, 26.723146, 46.8396, -16.79014, 2.542609, 9.794533, 49.910927, 45.830673, -25.876976, -42.545135, -45.064415, -24.077988, 42.03933, 16.792482, 48.242657, 37.061043, 0.7248819, -30.988771, 48.82503, 40.108562, 21.64715, -27.313173, 39.388966, 4.5507965, 33.061695, 20.868338, 26.550419, -43.8738, -27.724058, 29.988575, -10.416794, -43.498985, 45.469963, -1.0812759, 40.334194, -39.08084, 17.214691, -18.833435, -21.040768, -10.428488, -18.507296, 27.398008, -9.499955, 37.910885, 11.409158, -7.7257633, -28.87997, -45.78365, -14.586115, -46.30158, -9.263534, 0.81721544, -3.2221913, -24.560844, 34.703182, 28.158993, -12.318855, -19.755291, 31.434505, 43.501217, -45.78193, -10.80296, -4.640108, -18.103045, 42.685455, -7.3855696, 42.392426, 0.24718046, -5.423564, -29.165083, -16.62532, 16.11148, 22.116875, -1.7790079, 47.642143, -34.60664, 19.170671, 45.033783, -8.6941185, 39.695454, 0.824219, -37.44224, -27.43082, 18.610775, -21.637445, 12.025553, 49.212765, 16.984022, -4.679489, 12.497747, -28.807186, -42.012657, -37.58498, -41.955124, 10.260975, 9.739161, -21.2484, -48.90753, 27.08524, -28.370464, -8.347386, -41.924095, -28.20791, 20.857996, -46.586346, -28.511984, 37.48651, -25.642437, -20.807796, -14.038688, 21.372955, -32.79848, 5.0132694, 20.420134, -3.6296606, 9.040934, -38.142376, 22.604973, 18.686474, -6.2716064, -41.343517, 19.998777, 32.627075, -8.745396, 23.566883, 18.532955, -19.998377, -3.471017, 49.771923, 0.23605227, -39.805676, -3.6464155, 24.874634, -16.321182, -26.184177, 41.188915, 26.450586, -8.494645, 2.5544465, -5.288136, 11.608278, 1.7769754, -30.256748, 9.263712, 1.3077378, 3.2326758, -19.054396, 12.811131, -40.432304, 14.9461565, 27.094667, -5.502659, -38.840008, -0.1817584, 0.07097721, -43.21024, -35.364758, 46.246933, 37.390934, 27.710152, 34.637936, 19.248146, 28.139437, 33.116085, -11.680383, -6.356102, 35.65232, -0.018006563, -32.534325, -38.769943, 27.96377, 41.41597, 38.830612, 8.320951, 34.514027, -45.906662, -36.023148, -48.111523, 40.284313, -0.45242906, -23.023235, 16.918665, -18.716644, -32.06721, 19.284916, 9.15494, -35.805923, -32.933098, 23.443485, 38.01884, 4.0703535, -25.11425, 24.143719, 8.720273, -43.773968, -32.40225, 10.943842, 30.93872, -16.06319, 24.176676, -30.965637, 47.84668, 35.627205, 9.365362, 22.244627, 17.40784, -29.50486, -0.43599606, 13.333023, -11.28571, 47.94727, -19.281822, -44.65348, -23.803806, -46.404243, 41.202408, -22.445465, -35.17866, -5.4049373, -33.690422, -26.118671, 25.490505, -37.53978, 23.579615, 36.461926, -0.1121521, 22.20183, -28.00793, 38.990837, 48.572075, 11.881834, 45.563793, -49.65829, -5.490041, 9.934652, -43.459343, 24.331587, -19.055725, -18.084127, -39.67072, 20.440887, -36.38135, -10.610283, 22.211569, 37.66731, 11.306262, -18.652136, -21.748268, 28.064138, 9.276885, 42.090202, 18.829298, 40.27911, -40.290432, 40.1964, -22.97271, -13.384229, 0.29926896, -9.376592, 9.890288, 44.55484, -29.87426, 15.449357, -40.18521, 7.850772, 41.19057, 33.714165, 42.81813, 27.066214, -4.1367474, 13.05483, -20.892733, 42.441143, 25.035238, -36.596, 43.232822, -0.7419586, -2.2226095, -13.684261, -13.192016, 2.502519, -24.40948, -46.510345, -25.755299, -9.949863, 37.757225, 36.782764, -29.957617, -1.9198656, -14.43082, -26.748425, -8.792371, -17.348783, 27.947527, -24.796904, 7.6926413, -28.215717, -15.605253, 39.36119, -24.546808, -3.0065298, 47.75244, 17.113363, -25.449944, -30.020153, -17.533707, -15.657461, 21.769344, -11.116242, 42.16958, -27.43408, -15.635186, 18.204016, 39.932735, 47.82965, 8.002895, 2.1075547, -22.401773, 28.250938, -28.982454, -13.142288, -41.789837, -48.067158, 27.947594, 3.3968568, 39.858734, 39.78654, 26.237661, 20.009714, -12.975865, 26.555586, 24.043386, 17.308903, -1.4433444, 7.468486, 0.22184253, -36.286278, 11.606932, -36.757267, 24.260067, -29.79048, -16.332525, -23.712658, 39.465557, -35.21093, 25.530684, 25.076515, 35.35372, 12.527704, 27.257437, 39.525, 9.848809, 17.000883, -39.096703, -13.411492, 4.533595, 6.057918, -17.665058, -49.566887, -13.0030155, 19.14205, 43.053524, -45.15146, 23.871725, -47.443695, -47.81509, -31.312227, -6.604165, 13.964695, -38.02556, 38.522, 45.215202, 3.076315, 40.699196, -22.635769, -19.779736, -6.4522505, 5.4632664, -34.879314, -40.036877, 19.751667, 14.416337, 48.913445, -20.385647, 17.657017, -20.176924, 24.682474, -2.7697563, 37.0654, 27.778435, 41.617382, 25.694775, 1.878494, 43.08862, -29.369091, 47.15931, 48.859352, 47.76339, -23.356045, -26.492912, 3.1634152, 15.569889, 25.081354, 20.335144, 42.57447, -12.527007, -16.403675, 16.76001, 13.933361, -29.166382, 4.836231, -37.96249, -14.668459, -19.623655, 43.829166, -45.008682, -29.521252, -48.931496, 12.610269, -38.484447, 16.177034, -34.730553, -32.029045, -25.54378, 7.50345, 45.944042, 46.835613, -3.777486, -48.974842, -16.518753, -19.055552, -10.634786, 19.104427, 25.161749, 22.168737, 14.283413, -20.241398, -0.5304098, 6.3633738, -25.539516, -4.472816, -6.2414465, -47.24064, 33.89613, -5.0551233, -43.22299, 39.558678, -26.903702, 17.702198, 49.58563, 2.3146272, 14.385181, 19.866436, 37.789555, -15.341139, -28.13595, -3.9128423, 39.102554, 4.2990923, 34.740566, -0.37174225, 15.341007, 1.7386138, 1.3572991, -47.580975, -43.711708, 4.156506, 24.746687, 33.587627, 2.16946, 21.076084, 20.911854, -43.162613, -43.94667, -38.767303, 0.85963607, -31.615824, -16.000652, -7.480705, 19.508087, 11.592949, 46.383793, 45.099537, -31.897837, -0.1575172, 8.256727, 43.649925, -15.496052, -19.650108, -31.672812, 36.843056, -14.165383, -18.72626, 33.818478, 46.008183, -2.107066, -35.245304, 40.739258, -17.100239, -23.041243, -35.151196, -24.046755, -39.158257, -28.860712, -45.5479, -10.077638, 20.103758, -37.956272, -0.06982684, -18.43809, 24.184912, 43.306072, -6.62815, -25.164986, -38.41821, -29.37609, 14.436155, 11.472166, 26.926476, -7.429475, 25.691677, -44.546146, 13.440954, 48.53968, -49.48492, -25.956375, 32.008465, -7.8174353, -26.652168, 30.503231, 3.3516765, 1.9583523, -15.186709, 37.671978, 27.734858, 8.957082, 7.6305747, 25.85466, 31.150496, -20.51007, -5.478072, 21.951126, -24.228931, 46.752495, -34.24996, 23.07235, -35.915627, 16.053326, 34.92285, 6.027478, -5.0113974, 31.795681, -35.902054, -33.733284, -42.614822, -30.777454, 1.2977123, -22.672289, 11.13925, 1.6872466, 41.61286, -21.680408, -13.67833, 33.0697, -12.642723, 47.869736, -19.859005, -0.5475998, -11.846405, 23.32734, 19.158375, -26.626413, 32.947083, -3.1771123, -12.64388, -1.0085821, 34.797287, 49.04706, 24.32953, 8.749127, 32.631714, -20.908392, -26.130152, -14.439291, -32.3612, 21.498442, 4.749489, -17.106718, -5.0761166, -0.99139214, 42.87153, 44.633316, -38.4924, 18.32484, 19.30738, 19.118382, -6.816578, 12.504405, 12.581825, 48.66494, -47.92139, -18.973785, -33.6401, -24.253511, 9.816909, 30.494183, -37.8107, 32.52059, 41.765106, -24.645351, 8.726931, -25.668877, 10.709333, -23.18114, -19.477743, -33.47083, -41.695004, 39.900715, -6.3141823, -1.3871074, -24.883478, 34.85015, -28.61867, -20.223104, -39.03073, -42.044025, 44.38967, -38.609783, -6.902921, -14.473009, 18.314384, 13.373452, -38.329548, 44.90372, -49.806618, 4.9452963, -4.1771946, -11.587029, 34.07334, 42.215836, 6.513172, -17.65995, 37.172478, 31.413483, 8.980406, -13.6755705, 2.1079957, 44.5647, 5.422229, -9.853256, -42.332764, -26.79413, 36.111744, -1.7606795, -3.3296525, 19.468033, -32.89635, -3.3776343, -14.06272, 26.161045, 40.691196, 31.395382, 37.277782, -44.685097, -17.750835 });

    Tensor *w = NN_tensor(4, (size_t[]){ 3, 3, 3, 6 }, DTYPE_F32, (float[]){ 5.9207973, -42.467735, 13.563633, -32.774086, 21.425623, 40.467613, -42.772453, 41.897118, 23.330069, -32.996082, 47.858883, -43.30442, -33.660984, -24.872286, -2.5319219, 8.97851, -14.673531, -47.39236, -5.7715774, 37.9358, 38.496864, 25.0296, 7.259446, 12.42373, -38.54548, 20.246977, -49.76179, -20.64849, -13.139856, 36.71661, -1.4575303, -22.775465, 8.735436, -41.488518, -13.237869, 13.847608, -3.3114195, -5.250984, 30.55876, -37.981403, -25.24628, 48.39857, 9.949446, -8.095551, 25.89931, 30.079222, -8.355057, -20.827066, -8.172882, 18.15542, -6.383145, 29.10003, -40.77426, -24.531586, 38.116985, 6.559449, 10.0685835, 16.444767, -11.81466, -19.995386, 14.34421, -13.251549, -20.654892, 6.6058817, 12.094069, -4.5145807, -33.814766, -7.56011, -28.336376, 26.315838, -33.129986, 39.86681, 19.914413, -42.815853, 37.10505, -49.446808, -2.9070616, -31.217855, -43.013763, 4.9539986, -24.242937, 36.14179, -39.30549, 41.50114, 30.16485, 43.79299, -14.641607, -30.647749, -33.218254, 41.578526, -24.868786, -6.156373, -7.706827, 8.601886, -41.028965, 40.316963, -36.996925, 49.177967, -19.56421, -22.321112, -6.8726244, 14.797807, -9.264236, -49.90242, 35.169186, 49.524414, 25.226439, 48.92631, 13.627518, -3.9179862, -39.824764, -43.70025, -34.424847, -12.6861515, 29.115349, -20.629198, -1.941961, -0.7056534, -32.683945, -1.3535082, 48.277683, 39.962727, 38.08096, -4.9313188, 0.8867502, 27.334332, -16.631329, -20.26356, 42.779438, 2.8545678, -33.760334, 42.13026, 8.298862, 26.752876, -43.425507, 9.278584, 30.582523, -7.213253, -28.420227, 40.003014, 23.256052, 14.240283, 11.824846, 1.10358, 28.67334, -10.930389, -29.432238, 19.092405, 13.339782, 19.037432, -5.5535555, -6.6352186, -3.973949, 13.184136, -38.36793, -46.60297, 18.709797, -27.375185, -4.2061386, 13.861429, 7.012969, 32.2331 });

    Tensor *b = NN_tensor(1, (size_t[]){ 6 }, DTYPE_F32, (float[]){ 6.5541744, 12.378764, -4.475546, 7.3804913, 18.333786, 34.110725 });


    Tensor *golden = NN_tensor(4, (size_t[]){ 1, 14, 14, 6 }, DTYPE_F32, (float[]){ -433.45142, -3654.7952, 4014.1177, -2635.2947, -2267.8154, -2270.1797, 5751.659, 4269.453, -3622.3723, 5688.0474, 6894.2007, 600.7275, 3078.1187, -11532.547, 5875.7007, 1939.9585, -1454.1544, 571.26624, -1916.7976, 11198.863, -1841.1157, -2181.054, -1980.1528, -4496.537, 3579.0833, -7630.153, 3209.2761, -3852.3213, -2181.5398, -4892.5796, -519.8545, 842.1113, -4344.1226, 3466.978, 2527.8914, -7664.512, -1448.769, 3939.8926, 1198.101, -1013.11847, -2986.9497, -3697.5054, 2689.0457, 3136.428, -1581.0009, -2686.87, 6064.9233, -7201.1797, -1797.0063, 800.41986, 2104.6133, 1579.8112, -5967.903, 3319.911, -4941.5093, 9064.478, -1494.6901, -2102.2268, 7580.6675, -2466.378, 2831.1492, 288.5475, 5190.911, -7453.725, 1901.1571, -501.2428, -2930.396, -7766.784, -3849.0657, 6204.922, 1140.3031, 606.2127, -3017.7207, 3066.578, -794.73676, -8986.468, -4608.5093, -2673.7305, -1408.6774, 5500.1133, -6852.2466, 1026.2848, -1229.9991, -4139.3022, -1334.153, 5303.8857, 4409.958, -3204.5396, 3949.9563, -7849.2285, -2271.3213, -4941.0527, -5903.2876, -3094.3699, -1816.273, 2559.8574, -4531.593, -3745.5962, -715.432, 4955.6836, 701.20184, -2239.1619, 8259.716, 644.02026, -207.56158, 109.37329, -1981.906, 2068.6663, 1490.3505, 2605.4158, -3402.1313, 8149.673, 4348.1396, 2796.4917, -1821.7874, -709.6643, 5957.857, -4920.862, -1375.5642, 12336.567, -3408.0432, 427.0324, -538.86444, 3678.3633, -451.10352, -1302.2751, 5792.088, 1564.2413, -2517.4836, 8691.904, 2606.3767, 7176.446, 1479.445, -1010.68225, -6246.6934, -3589.6963, -1824.6031, 5986.63, -801.5616, 3970.6545, -2814.7068, 4354.193, 1342.9752, 1520.5135, 4705.644, -4421.762, 86.11322, -2916.8975, -621.2168, 3877.4136, -1994.8164, 787.33246, 9135.905, 1359.2075, -691.18445, 1355.5216, 9314.303, 3364.093, 2668.3738, -10207.918, 1055.7029, 2767.883, -6070.702, 270.5148, -4550.5234, 3750.0662, 2143.7878, -1521.8077, 1610.1198, -2136.521, -1382.6104, 1858.2578, 1350.2759, -11322.596, 1387.1224, -3490.8857, -1253.9069, 32.188435, 1167.3583, 5270.4097, -7518.619, 1957.9645, 6576.076, 2120.4604, 691.9257, -4579.5513, -3184.4478, -2050.9353, -3773.5251, -3932.8882, 2790.2732, 9621.09, -2318.337, 2877.214, 3662.0627, 4505.267, 4172.0205, -6533.2925, 4856.965, -4629.2734, 4788.439, -61.401863, 2081.8997, 8307.709, -3621.548, 8920.2, 3613.3218, 2683.0645, -1163.9707, -2709.2712, -8137.3696, -527.6783, -2617.8474, -5090.716, -5332.407, 5002.727, -1516.9548, 3936.4236, 808.3833, -836.9128, 4569.907, -6584.6445, -822.5549, -6778.036, 3361.3738, -270.81247, -2371.4536, 9737.827, 1457.735, -1909.2408, 10927.974, -1730.9518, 5050.96, 3196.613, 9166.089, 560.7704, 3409.611, -2009.6536, -7870.6987, 3749.431, 2804.4172, -5269.4165, 3787.655, 1162.7388, -910.3693, 2069.3352, -2042.2202, -5131.3047, -5732.2837, -6485.56, -2759.172, -4001.7148, 4508.1855, 100.47034, -1299.8888, -1314.2378, 3757.6736, -5188.9185, -2819.4841, -4733.797, -319.95074, 34.916256, 300.4583, -4393.7163, 9329.991, -1540.7201, 956.3182, 1813.7872, 2486.832, -9356.652, -660.2541, -535.28345, -1792.1228, 1584.4703, 1247.3892, -1208.6349, -844.4783, 2831.6726, -1800.6743, -6689.115, 1539.8591, 986.4723, -1973.7557, -587.12897, 2689.0215, 10307.365, -320.9674, -1236.3534, 4674.813, -3886.2512, 7761.131, 1164.6324, 1459.6686, 5746.6157, 865.99603, 926.5596, -1464.8633, -2993.2976, -1502.2753, 2350.1013, 1518.2618, 4504.742, 3743.8247, 2974.3955, 1037.8933, 352.43204, 3476.351, -3109.3875, 264.42615, -310.93924, -4450.3755, 9641.863, -4629.7437, 2699.95, 5483.179, -1829.6836, -2744.7375, -1247.6261, 6460.2354, -3593.4563, -37.87777, -7034.496, -3446.8547, 7227.5093, -1560.6438, -6288.301, 3351.3728, -2662.211, 217.6434, -5454.9917, 3174.5588, 2362.773, 9558.73, 2328.8345, 2955.7942, 7016.0547, 138.32626, -6006.111, -247.8333, -2170.2173, 2537.8372, 1406.4816, 4977.498, 4566.35, -2092.7168, -2159.558, -1300.3611, -3920.686, 2404.169, 1551.3811, -1171.4452, 6534.4873, 2705.267, 2052.4045, 453.7242, -3875.1448, 3643.363, 2139.6902, 756.74915, -2845.2522, 5395.4233, -1610.6362, -4895.169, 5322.525, 3836.4321, -4052.2214, 146.20099, 3505.2793, 26.88135, 2991.5066, -3687.9397, 5564.8325, -2000.6958, 1851.8959, 1364.2576, 1072.4434, -7619.535, 3669.4998, 1939.3646, 133.43008, -33.890766, 5436.7646, -519.1955, 1843.7291, 4266.101, -2690.2651, -9818.312, -4097.6084, -3422.6997, -229.57541, -8572.132, -4315.407, 5647.3823, 2382.4119, 342.41412, 666.8026, 821.6682, 328.19287, -3268.3003, -6906.6724, -6279.119, 3621.5906, -1701.4042, -11854.446, 6128.432, 5626.084, 2794.5317, 5503.0986, 5924.8228, 2314.3765, 5445.0503, 2513.3193, 1914.798, 1864.3552, 669.8209, 3466.3184, -2103.1333, 827.8249, 652.0021, -948.476, -4420.8887, 477.23135, 3256.7793, -650.73175, -3303.2717, -3454.757, 4686.129, -2353.286, -5340.735, 1989.5647, 4576.849, -825.96436, -3006.7256, 299.91708, -2013.5219, 5448.134, 3731.3738, 2876.1099, 2049.7112, 2261.3914, 1344.4847, -653.0092, 1739.471, 5063.9478, -7382.6865, 5511.984, -5950.8003, 3903.5117, -5038.362, 790.66296, 4758.7993, -2143.5288, -2896.525, -901.4787, -3826.862, 2933.8464, -3824.8726, 857.0007, -3700.6938, 1760.2892, -10797.524, 1505.9032, -5111.282, 245.99518, -5518.023, -2359.6565, 402.8664, -645.0519, -3812.6174, -3914.7878, 3261.8845, -3572.2288, 1728.0344, -321.23193, 3476.6208, -1223.2474, 2778.276, 168.28789, 1285.3854, -12858.677, 5220.871, -235.41905, 7895.3535, 2261.8647, 2921.715, 5086.8345, 1189.6285, 2025.4183, -2584.7832, -3548.535, -777.2708, -4638.2393, 2662.3398, -4101.377, 2187.6738, -3088.5928, 791.2347, 3459.279, -2101.413, 3640.361, -8509.596, 313.81396, -13382.519, 1501.7839, -539.97186, 5345.6826, -735.1896, -1670.3994, 5986.793, -5648.042, -2501.8018, 2104.1958, -1375.4878, 1481.594, 4211.5293, -1519.3477, 935.751, 612.0043, -2442.535, -2298.491, 670.0931, -757.4997, -3294.71, -5027.74, 5124.754, 9901.251, -3090.284, 1518.325, -1405.6768, 2961.7615, -3418.3552, -9018.093, -5529.5415, 1966.8317, -7036.2227, 5054.4824, 456.14285, 5104.4653, 941.69916, -3402.482, 5887.0757, -5942.654, 8320.142, -3055.5623, 4239.6675, -3627.27, -3326.2754, 668.95764, -4049.9717, 1077.2881, -943.95197, -4723.5327, 4085.0874, -1087.367, 3477.53, -4242.7993, 8107.787, -1201.2134, 1470.1987, 8329.406, -3988.4795, 8182.8833, -1925.7734, 7402.141, -126.12792, 949.56396, 2665.1963, -2263.8254, -7073.503, 7923.9126, 2697.372, 2453.3884, -4296.834, -2174.4421, -5743.7886, 1712.7596, 1072.1675, -11017.493, 1104.9902, 5063.854, -5081.204, -1215.4766, -183.30978, -8268.295, 2140.3804, -4024.5518, 3231.9417, -1169.1017, 3444.9573, 6052.936, 3368.1792, 957.1598, 3311.3906, 4079.4656, -1689.1267, 129.09409, -3369.0906, 2195.0269, -4069.8574, -2272.3848, -413.26886, 1518.2504, -3401.3135, -2200.3318, 5384.355, 3532.974, -2684.691, -2665.949, 8474.079, 2598.7668, 1559.8335, -6902.9634, 6246.8145, 2671.898, 2851.6487, 2736.8223, 4598.3687, 8340.726, -2638.8367, 3694.1052, -1094.6238, 324.76236, -3350.6042, 9724.115, -858.6749, 344.0647, 7379.072, -1108.7875, 2964.9512, 2014.356, 4106.3794, 5718.6714, -1483.008, -9254.848, -1925.2872, 1443.4968, -3540.2727, -3730.938, 3225.3948, 10424.471, -830.3779, 1587.7596, -5283.588, -1281.9504, -3057.559, -2951.2698, -6339.305, 1278.4832, -1321.3739, 4444.946, -2628.308, -4929.061, -277.3601, -3106.8376, -1083.5889, -3658.6619, -352.21072, 621.978, 4898.4585, -2183.7969, -3218.6016, -920.5507, 7386.643, 5513.7354, 7264.7827, 5766.0063, -1513.078, 7131.0854, 9005.468, -5461.7153, 2021.8866, 8002.0938, -3133.4146, -2505.692, -3548.587, 1494.6135, -1899.8896, 1649.7578, 5625.6978, 3845.3486, -3929.8533, -4334.2134, 4265.24, -6875.6143, -3325.913, -2757.3562, 840.9908, 8577.051, -1438.1066, 3034.6392, 3209.6084, 8294.791, 658.2212, 1309.2167, 307.0265, -2835.4016, 2372.7107, -4136.0596, -8432.011, 4899.6807, -8787.262, 7541.656, -5373.226, -4018.1345, -1547.5138, -3392.1387, -4848.9346, 6446.597, 7078.5205, -797.5721, 508.41672, 2128.6821, -5009.9546, -6999.4233, 4948.4053, 2080.9302, -1974.0568, 2364.7246, 1734.37, 2051.719, -3573.5933, -3578.452, 347.04532, 4221.497, -2990.232, -1288.9739, 1008.4583, 7429.9805, -2931.6091, -12402.123, -474.07373, 356.85013, -7230.359, -1932.8103, -454.4346, 6068.5166, -1382.8224, -8154.687, -13.630379, -4098.458, -4860.147, -2861.629, 12633.104, 4522.9004, -2855.4695, 493.27853, 5868.7485, -111.58118, -2748.8142, -3023.496, 4891.1846, 1599.325, 2769.8867, -2267.158, -1954.9879, 5649.2905, 2909.9895, 3999.615, -2900.491, -7743.2676, -3565.5303, -6109.9375, -3687.129, -3274.8784, 515.418, 10250.557, 3828.1282, 1177.3441, 826.7443, 333.42325, -3507.8994, -496.93057, -5139.9326, 3468.8364, -1761.6537, 4751.628, -4749.071, -2279.1296, -6573.4614, -4536.0693, -6273.3394, -6708.615, -6326.1426, 3893.3389, -8010.4956, 4501.202, 170.5054, -3421.142, 940.72797, -2097.7454, -2686.2712, 1610.3956, -3239.5576, -3023.5796, -2989.6128, 3038.385, -1336.0337, 3065.426, -2314.7983, -3168.4043, 34.50685, -6447.229, -4187.5977, 4433.9736, 3094.7214, 1334.9637, -2497.8892, 1860.3656, -4759.8228, -6000.3926, 4666.162, -3885.3604, -1527.8549, -434.98907, 24.770714, -4064.2515, 1440.5337, 6526.6553, -4861.3037, -2018.3303, 6210.9, -9828.785, -272.9215, -637.5638, 2577.1453, 2725.009, 439.6115, -1349.1215, 7341.7466, 3591.1528, -35.70829, -2895.759, -1916.8909, -7860.177, -5414.6445, -435.95813, 1302.2242, 6930.9795, 2793.0054, 1188.2074, 3863.689, -1161.3354, -940.50214, 6374.3022, 5474.0312, 4845.92, -7048.4663, 4088.419, -1702.9495, -65.843445, -200.99255, 4277.392, -382.3367, 1261.0698, 5822.4365, -1504.7175, -7928.334, -263.6864, -11.054428, -259.54974, -3141.0925, -4532.643, 1765.667, -1368.586, -4746.995, 496.41907, 1669.9581, -1722.0175, -1998.7915, -3965.757, -2121.0266, 2962.2542, 5804.903, -2113.181, 6885.736, -34.01258, 3424.8218, -4192.7285, 8800.581, -4824.279, 1141.6547, -1306.1097, -3135.276, -601.08026, 330.45444, -8807.125, -9675.412, 3457.381, -1169.8442, -3550.537, 2912.6855, -191.46182, 3110.4138, -930.45667, -196.99141, 2095.158, -3092.0051, -1085.192, 4079.765, 7267.904, -4217.985, -3163.5237, 4924.5454, 4373.526, 944.37854, 4528.572, 1531.373, 2192.767, -6260.2183, 728.8809, 4649.192, -1678.4364, 4713.741, 3444.8972, 3292.2244, -434.16016, 3209.161, -2294.1301, -4527.0444, 1064.1532, -11205.885, 1534.292, -2712.877, -707.2361, -2081.6292, 871.2859, 4971.34, 2696.9321, 7302.3354, 3450.7878, -287.42325, 3201.2742, 4019.004, -350.00558, -3064.5564, 6323.2417, -89.6068, 2449.6316, 112.962746, -1680.6525, 485.2561, -1746.2773, 124.07137, -4723.0415, 2224.5505, 4021.5754, 2448.5066, 3785.9568, 6204.6255, 1245.2582, 1140.9865, -1614.1095, 3691.5415, 3943.1482, 147.97432, 9715.203, 153.97371, -1616.1975, -7426.8696, 3390.3335, 3773.5764, -2606.3242, 2913.0845, -2196.9463, 2036.3312, 6511.9624, 5842.152, -6886.4653, 8055.0728, -1693.6091, -409.0882, -4752.7314, 1774.0135, 542.28436, 479.31024, 1854.7025, 4551.084, -2266.1184, 754.35815, -5029.399, 5603.077, -7494.005, 1136.0804, -804.0323, -5440.5728, -1056.1411, -164.36542, -3482.7993, 863.1654, -4628.009, -270.3922, 8463.682, -3644.4817, 1019.89575, 4583.1577, -926.958, 1754.362, -9353.045, 3819.1934, 2542.888, 1796.2273, 2938.2947, -3830.1396, 2392.173, 1433.8425, 1833.5037, -4613.411, 5889.3965, 776.0196, -5075.8247, -4557.4424, 6843.494, -8553.532, 4008.6255, -1864.8286, 4084.325, -4302.3467, -4594.178, -3217.8599, 6282.04, -3282.0627, 1953.7828, 8645.799, 2210.6584, -1819.9127, 3244.822, 190.88354, -1703.112, -1225.0156, -2047.4537, -4886.3726, 3822.1272, -47.476624, 1941.5808, -383.1796, 194.46944, 3712.716, -2763.3894, 1107.6283, 1827.3577, -3450.7273, -1729.9501, -4509.7407, -736.6585, -4088.9187, -4102.4883, -401.24515, 8868.971, -2416.8547, 7038.925, 3867.0657, -2481.4734, -651.76337, -4952.912, 2874.562, 283.9929, 6523.8403, -2333.837, -3018.4897, -2281.4133, 1061.7737, 2293.5752, 8136.345, -6756.5737, 9138.612, -1813.6139, 336.96265, -2222.2249, 6029.9775, 3027.3523, -1414.0093, 4690.34, 1475.4636, -3577.0398, -3085.5754, -3342.4526, 190.45389, -782.4611, -968.2975, 12415.914, -3086.006, -3272.3838, 7671.9824, 2172.8003, -201.9526, -5397.583, 6862.918, 3614.104, -2536.3381, -8967.134, -2927.2734, -3.6881294, -296.47833, -1829.7427, -2691.2808, -3462.4778, 1388.1166, -8561.885, 3135.583, -4361.884, -1313.4973, 3402.4514, -4874.707, 3843.8965, -2976.8162, -5455.365, 2152.5413, 1999.1805, -6866.6636, 1801.3353, -3801.5974, 6531.895, -1718.0204, 25.445885, -1525.9567, -5384.036, -641.75073, 2419.1045, -5133.5576, -1161.7394, 3340.4814, -315.52704, -5121.3594, -2555.4026, -4503.752, 93.28566, -1800.9291, -4003.0378, -8202.586, -2688.8347, -3779.939, 1436.6854, -4375.9155, 1720.4581, 5597.042, 5269.1484, 2649.2375, -2997.2776, 2527.7532, -1925.91, 4397.7563, -3043.216, 649.31165, 1457.9038, -4938.685, 9140.088, 3813.584, -5451.515, 7263.192, -1247.7075, 6940.7217, -2973.6042, 7363.401, -4621.4253, 38.78105, 2229.0032, -449.65717, 1018.46924, 176.26897, 1243.2329, 4680.4033, -2986.9658, -2114.631, 4892.8887, 4309.4756, 3869.3818, 2408.0073, -383.33533, -2779.3184, -5545.993, 2175.4446, 530.9694, 1030.3314, 2652.133, 4205.078, 2941.8125 });
    Tensor *actual = NN_zeros(4, (size_t[]){ 1, 14, 14, 6 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Conv2d(actual, x, w, b, (size_t[]){1, 1}, (size_t[]){0, 0}, (size_t[]){1, 1}, 1);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

  {
    printf("Conv2d:                 ");

    Tensor *x = NN_tensor(4, (size_t[]){ 1, 16, 16, 3 }, DTYPE_F32, (float[]){ -47.375603, -20.828157, -44.86692, -19.934713, 30.478977, -47.375095, -44.800907, 28.95115, -29.526854, 36.543304, 15.579456, 12.550825, 39.720623, -46.31476, 36.614758, 16.214884, -33.50548, 12.1656, -13.934976, -20.069515, -5.4151716, -23.57325, 43.721836, 43.035107, -5.3338823, -44.338833, -3.0587733, 3.3035219, 33.42105, 1.6087055, 14.552301, 13.26676, -28.370077, -31.014336, -44.688503, -0.39263964, 15.486473, -3.5552382, 48.53331, -9.538126, -32.62635, 8.333391, -14.080554, -6.8544683, 48.447495, -1.4346242, 43.677086, 6.6772757, -18.60109, 36.657967, -28.481441, 1.6543448, 11.2387, 22.44171, -46.132977, 2.4527848, -12.945986, 32.418316, 16.822195, 20.03985, 30.062992, -11.19405, -3.2034755, 40.11268, -40.299458, -34.560986, 3.6577523, -19.80638, 2.8635502, 44.168003, -5.796182, -42.63173, -22.728878, 45.91834, -10.984468, -21.923893, 22.506327, 6.189811, -44.083977, 41.639336, 28.156239, 43.459255, 21.879965, -16.857697, -16.322363, 24.231106, -9.692693, 9.802675, -48.44941, -24.716114, 18.572378, -2.4649441, -24.037535, -43.613373, 31.777996, -10.052943, -49.126648, 48.23922, 24.331331, -29.906952, -36.491566, 48.31564, 0.20876527, -30.071121, 28.772337, -10.414952, 3.425151, -26.04668, -42.34974, -33.206135, -5.490148, -36.197384, 49.28044, 0.54115653, -19.14159, 19.761007, -44.328438, -25.574606, 18.780052, -42.48313, 24.920147, 4.2027593, -41.69036, -49.621613, 15.802532, 23.633415, -9.995317, -44.21277, -28.81732, 5.3141713, 1.8190503, 12.798845, 8.841008, -2.6208162, 26.386326, 48.50068, 41.640686, 45.433796, -16.875166, -17.065739, -5.5300655, 14.777941, 20.238935, -4.456806, -32.29631, -37.725002, 48.13593, -13.442791, -6.7584395, -30.64301, -24.787992, 10.981983, 21.059322, -19.766176, -18.403614, 39.60796, -25.750834, -37.30424, -7.8007817, 47.57721, 10.879445, 6.908661, -6.2256217, 31.244438, -24.782545, 33.900547, 11.812204, 5.5591583, 6.883317, -30.83626, 37.135338, 26.260393, -39.105873, -46.55408, -12.871456, 33.21761, -24.616581, 46.34185, -25.13879, -45.165123, 21.994377, -30.217201, -7.8819156, -15.595198, -3.9729595, -43.568653, -45.860065, 21.49384, -5.6657734, -30.161524, -1.2737334, -45.636623, 13.272119, 23.74515, 48.49083, -40.733654, -6.0628595, 27.134747, 45.823036, -35.5736, 21.248114, 20.643204, 30.143541, -34.47081, 35.680824, -21.778185, -30.777437, 9.927856, 42.35701, -33.111076, 26.6954, -5.726284, 15.961867, 39.00352, 13.576013, -41.507824, -15.053797, 9.923858, -42.17952, 8.312488, -26.848448, -9.93886, 17.88705, -40.240986, -32.10072, 22.805214, -49.45203, 34.409416, -38.55396, -0.80509186, 10.264188, 19.72962, -31.033384, 6.7286434, 21.529366, 42.885475, -37.627472, -24.8586, 14.565813, -1.6051352, -33.741356, -42.082535, -44.396465, -34.987408, -21.288431, -34.719975, -43.862354, 3.902948, 29.322815, -23.574347, 4.999888, -0.61638355, 23.371666, -34.675343, 2.3738265, 46.66975, 35.695927, -49.55584, -7.5269756, 0.46608448, -16.509808, -32.8493, -34.791313, 33.223366, -16.187323, -3.217709, 14.67154, -30.689508, 4.4565916, 29.740625, -29.23441, 14.546865, -1.7078042, 27.491796, 33.22401, 13.265282, 1.510787, -43.041534, 19.907713, 30.4833, -18.161266, -49.64713, 40.51824, -11.736404, 10.003614, -14.055419, 31.88646, 48.763966, 31.341934, -15.912188, 35.039497, 24.396593, 4.87811, -40.274036, -21.469658, -49.469334, 33.44168, 49.42454, 29.125696, 15.97597, 11.817068, 48.132145, -25.34895, -16.786272, -44.89392, -4.951179, 3.4297764, 13.687002, -34.78421, -5.785966, -41.200047, -40.671986, 6.517184, -48.807613, 13.313908, -46.05993, -34.79129, -10.374803, -47.714066, 40.381615, 40.967815, -26.11645, 10.474003, 25.578749, 15.888655, -6.697792, -47.16056, 36.356945, -43.85484, -9.259987, 3.1015754, -16.4671, -18.287737, -43.213524, 2.7549624, -5.677253, 43.590122, -16.461056, 38.645752, 2.3670018, -22.464108, -11.89093, -5.674058, 0.5179107, -8.23763, 14.838654, 41.175808, 7.8591766, 18.11064, 30.876017, 10.777593, 23.048538, 26.227533, 46.80066, -45.63269, 17.109568, -2.2655725, -8.979517, -19.277102, 30.060028, 45.739372, -40.804493, 27.014, 34.477486, 8.738697, 0.58898926, 38.476295, 1.4824271, -12.471217, -3.6922276, 16.04175, 12.516957, -2.6976585, 15.783328, 13.466036, -40.50295, 12.4588375, 30.592209, 5.7340918, -4.563838, 38.30157, -43.68406, -22.821825, -22.599537, 43.20261, -48.361088, 4.958886, -48.434456, -1.6441882, 18.636871, -11.692726, 48.536766, 0.15916824, -25.491507, 12.89329, 26.0032, -0.0993371, 42.773693, -31.645805, 21.333921, 28.391785, 24.83456, -0.01834035, 14.273209, -39.225567, -39.237785, -3.107828, -6.2666535, 37.126286, 36.30634, 33.90238, -22.901648, -39.251854, -46.899944, 18.095541, -45.054115, -49.91292, -25.269009, -42.21519, -19.70439, -31.477325, -25.651735, 47.536217, -9.4223385, 41.47693, 1.1093736, -6.429684, -14.63911, -35.74136, -40.172398, 34.62109, -15.40798, -48.74898, 45.886482, 0.9274781, -33.457523, -39.302677, -41.989254, -43.84276, 45.246063, 34.474678, 4.0895042, -42.613716, -13.077587, -46.969734, 17.231005, -13.275981, -10.699725, -15.600676, 23.442572, 27.064472, 10.952979, -6.2612476, -4.941201, -0.8736849, -37.233204, 48.788494, -21.564125, 29.09034, -28.029896, 0.3356576, 17.116367, -45.909023, 22.934992, -38.27224, 6.977314, -9.914965, 28.661161, 48.595055, 11.268288, -1.4277041, -24.77224, 18.641806, -24.066126, 20.653349, -21.67138, 33.915703, 38.3518, 30.659246, 0.50085187, 23.187183, -45.56163, 40.548653, -12.990612, 18.227827, -8.466929, -16.789347, -23.480272, 32.251144, -27.202463, -8.817273, 25.222504, 5.03934, -42.069973, -49.71874, -24.308651, 46.11582, -35.551292, 27.556765, 35.790783, -20.724869, -22.080338, -35.971813, 7.7990828, -6.989831, 2.429241, 21.688032, 20.991993, -15.774852, 3.434056, 11.877322, 1.0643125, 10.00551, -20.254486, 40.983685, -5.128515, -6.3972654, -44.875633, -36.24341, 1.5553355, -7.7326717, -25.138992, 26.172531, -4.476285, 17.584408, 42.113316, -22.987349, -24.608612, -10.0473585, -4.2340517, -25.00813, -12.004209, -1.4411986, 22.428053, 46.258144, 37.02544, 5.291748, -3.1508386, 12.807637, -2.0410836, -6.5618396, 17.19352, -40.680008, -42.521835, 0.20253062, -15.154904, -24.73107, -46.54714, 33.492996, -1.9921958, -26.86376, -20.367205, 13.145155, -36.26174, 3.2113016, -0.61659217, 17.033136, 19.834787, -32.668964, 21.589542, 37.7559, 3.2189727, 25.47272, -18.929375, 9.931463, 14.6099205, -23.094112, 30.870872, -47.274864, -18.781805, -29.419386, -29.681856, -30.297571, -47.11454, 8.580839, -9.890837, -42.100536, -0.020563602, -8.329069, 20.626331, -39.164307, -14.066267, 10.291719, 21.19434, 3.7824929, 13.5499115, 49.9817, -17.320602, 34.077244, 43.069416, -44.230812, 12.094712, 28.32247, -7.7993574, 27.594917, 1.7006934, 38.06416, 1.0765731, -32.01112, 37.971924, 14.870214, 42.53847, 12.412167, 26.550358, 31.175571, 8.419334, -11.623293, 10.326725, -34.8625, 1.7081618, -16.070724, 3.1612158, -39.587933, 30.551136, -46.130627, 21.41207, 32.92802, -45.824795, 45.175507, -37.1692, -9.818321, 25.909895, -15.85514, 44.559254, -22.057634, -6.694216, -32.68426, -23.196465, 48.792297, 37.603176, 3.6815286, 4.111123, -42.429764, 37.747383, -7.496423, -20.854694, -39.791126, 41.109062, 23.709375, 30.116446, 5.1772714, -33.92852, 20.481724, 5.7664576, 16.778738, -12.45042, -23.595762, 41.04659, 16.760832, -20.292961, 4.464948, -10.86877, -4.2758346, 28.037966, -39.795918, 45.251656, 33.652794, 0.042963028, -20.4517, 10.194576, -33.09542, 32.47754, -26.443035, 9.553737, -49.191547, 23.943733, 33.84742, 37.529015, 4.081255, 29.52187, 17.048056, 33.5308, 28.215391, -43.746407, 5.2710476, -17.045862, -23.874807, 34.998096, -7.156217, 7.7671585, 31.481468, 33.656113, 26.683605, -8.729452, -44.569736, -47.999237, 15.7164755, -0.5933583, -31.5906, 21.83664, 45.384495, 28.918743, -7.0534286, 6.7562523, -31.893223, 23.599642, -38.747437, 34.51962, -22.83746, -19.830656, -41.880577, -12.091035, -4.836458, -23.046547, 35.592438, 28.69519, -44.128193, -5.001539, 16.810656, 48.239864, -11.955637, 30.696499, -2.8011441, -19.17715, 30.598051, -44.55451, 41.89002, 49.941437, -13.6512165, 19.751095, 49.860214, 15.074242, 19.553328, 18.359684, -20.456272, 12.204915, -26.648682, 42.6957, -21.425713, 11.430252, -14.483934, 25.00488, 0.82416534, 27.49266, -13.5391655, -29.340584, 19.169653, -28.139061, -41.05153, 19.318014, -30.071575, -18.793732, -12.484765, 3.5503745, -17.316961, -17.995094, -12.566924, 35.039593, 14.97137, -24.071896, -34.56151, 1.1585116, 16.01826, -1.0462999, 29.269516, 42.05551, 14.654547, 16.48991, 29.00818, -17.12898, 8.869076, 40.42422, -23.943203, 3.8914561, -19.547956, -38.44619, 26.483553, 39.952713 });

    Tensor *w = NN_tensor(4, (size_t[]){ 3, 3, 3, 6 }, DTYPE_F32, (float[]){ -27.01177, 18.73935, 15.332186, 19.523233, 27.523201, 46.67956, 37.95002, -43.75052, -19.601362, 26.55514, -28.543568, 9.817839, -21.435202, 9.930521, 24.397028, 15.715593, 36.32179, -6.016755, 27.143557, 16.16444, -15.757597, -35.313313, 45.743965, -14.90758, 37.66126, 31.516827, -2.013415, -41.300415, 4.0252266, -24.171019, 13.010752, -19.874413, 38.537632, -45.111805, -13.460225, 7.884926, 4.76985, 41.076817, -15.798217, -39.91273, 33.104164, 13.971501, 32.937153, -29.592777, -29.367273, -20.19735, 3.5548687, 16.94296, -28.732735, -4.707551, -8.641678, 45.62183, -18.03202, 48.45352, -30.666506, -20.603067, -37.60715, 36.835014, -34.38393, 20.696657, -18.37313, 49.825466, 7.0528326, -43.420837, 8.605183, 6.078964, -48.360413, 10.034532, 47.704792, 14.388811, -0.26590228, -10.36511, 13.287008, -22.275776, 49.23827, 43.22291, 23.35834, -18.62393, -46.947742, -28.783644, 48.614735, -45.893925, -47.74064, -3.603685, 15.907515, -49.76461, -46.42108, 0.2718389, -16.771704, 34.833996, 14.355546, -43.401127, -45.065464, 34.337585, -8.866054, -21.87286, 15.749043, -9.826756, 23.91237, 12.679505, -21.648682, -40.074474, 27.067106, -30.040539, -5.5302024, 6.8364143, -29.098343, 27.236229, -35.16938, 12.280321, 5.3475437, 18.345547, -49.070858, 2.8882742, 24.375301, -32.010853, 12.37256, 0.1959145, 42.417496, -10.58734, 0.34159422, -21.746868, -12.322646, 14.313852, -48.222244, 37.93037, 35.955055, 21.174782, 37.42987, -15.564328, 11.388761, 2.5437355, -34.57473, -19.222282, -17.750513, -12.362671, -44.39693, -35.164494, -4.7481356, -7.6061544, -45.387314, 10.68337, 27.224726, 41.640686, 42.08019, -34.938305, -16.024107, -23.719847, 9.1705265, 13.398409, 11.124319, 29.21852, 26.378881, -26.837343, 34.324097, 33.72843, 6.6167536, -43.501205, -30.666273, 13.933807, 17.287111, 46.6225 });

    Tensor *b = NN_tensor(1, (size_t[]){ 6 }, DTYPE_F32, (float[]){ 25.447643, 18.122173, -1.7053485, 34.093494, -18.1993, 20.358372 });


    Tensor *golden = NN_tensor(4, (size_t[]){ 1, 16, 16, 6 }, DTYPE_F32, (float[]){ -2886.2637, 4307.046, 152.51665, -2187.9697, -308.3831, -3735.7202, -302.35364, 5089.9434, 5816.482, -4917.2607, 4356.253, -5112.645, 1278.6606, -2275.916, -4070.2002, -4478.2905, -2470.0405, 834.1769, 6366.9736, -3559.313, -1377.516, -3390.1072, 4259.721, 811.14557, 3101.44, -2721.947, -3304.1562, 5121.388, -1095.8799, 1342.5295, 827.8638, 74.99802, 1885.6016, 5999.765, -389.60507, 1063.8151, 1651.2881, 1707.5554, 1138.957, 1583.3568, -3676.6821, -1429.6865, -593.4009, 1736.2212, 3629.1812, -5278.9995, -2354.0798, 2858.7764, -4249.8716, 5670.227, 1889.1451, 108.18939, 125.48531, -4667.0825, -1584.5066, -4059.2417, 1293.5712, 686.60876, 2672.4846, -1507.8441, -2684.156, 916.13055, 11.783134, -4584.0645, 2597.5535, 1490.2666, 6846.7847, -162.60242, -3407.6162, -808.11945, 1696.948, 1832.5004, -133.3744, -4967.802, -1796.413, 2122.4907, -2987.8657, -2428.9038, 3708.945, 855.1758, 2521.38, 1344.9907, 3020.4531, 1377.0234, 52.490204, 1926.9525, 1753.943, 831.4195, -3075.2686, -1268.7637, -7063.715, -1732.8389, 3158.1863, -1379.8213, -3874.6042, -3192.0005, -6866.17, -6365.735, -4619.05, 3258.7966, -6710.7563, -2021.4807, 5940.207, -3681.736, -5789.2095, -3384.515, 2809.99, 716.13226, 2066.1062, 1485.5328, -6242.422, 80.606445, -6550.282, 3374.2324, 1157.6458, -79.121124, -693.0197, -433.9195, -5072.921, -3719.8757, -5476.649, 2870.7664, 1845.0005, 3987.2566, 8296.123, 3578.0693, -6902.146, 5009.5205, 2512.7336, 4551.1704, 4444.837, -2798.337, -1298.6228, -3912.08, -2719.9712, 6632.217, 1234.5896, -2211.7207, 910.7942, 3549.2207, 11631.011, -2430.2905, 752.8809, -12046.318, -461.22275, -3603.808, 2073.768, -293.99512, -1544.7216, -884.5933, -3170.6887, 5932.7393, 853.9726, -9056.539, -1311.6329, -6128.95, 2239.0203, -3136.9897, -699.55475, -669.3241, -450.1987, -849.29266, -4982.66, 1673.7188, 6242.924, 2029.9055, -192.95963, 2832.1125, -2035.6244, -625.07574, -1863.1533, -5969.7295, 1646.5125, 6099.4453, -3733.3115, 2618.0852, -440.63303, 7049.9595, 1832.4418, 2071.913, 1615.2639, -3011.4849, 4852.6245, 49.093315, -1821.2097, 1824.9269, -764.6959, 1983.4677, -544.7861, -5536.7773, -1931.4417, -1948.7896, -2891.928, 1049.09, -4172.5503, -2740.7896, -3124.8723, 6921.1714, 4705.581, -1681.326, -3328.0198, -2832.1072, -4444.472, 3793.21, -2794.2295, -1727.3071, -2764.9392, 5495.786, 3328.4646, 1713.6603, -221.25389, 2368.9846, -602.8391, -3357.8237, 2161.9917, -892.58856, 5094.3716, 4726.424, -1992.7625, -3564.3464, 4982.8896, 3090.431, -3296.607, 6321.379, 4936.911, -4696.6167, 3037.004, -929.89166, -5138.7827, 9686.772, 6379.6245, -10593.233, 1791.3251, -3209.6453, 2973.533, 480.3289, -3727.7979, -3745.1848, 6376.931, -4286.5913, 3692.034, 4440.146, 3494.6873, -1508.1818, -985.26843, 682.73883, 3033.6587, -566.48804, -3040.0571, -2123.268, -8475.362, 5689.755, 3498.1238, 5758.4854, 1674.3367, -6088.824, -1921.8076, -8294.794, 13018.141, -6395.84, -748.69, -794.55035, 2300.449, -5894.559, 600.75214, 2935.643, 2898.1086, 4000.9983, -3731.9915, -3571.8982, -5793.3677, -931.03925, 4388.7485, 1914.513, -4105.246, -1020.3894, -7386.2456, 4602.9277, -1387.5684, 729.883, -539.4486, -6439.1304, 1412.5579, -1911.4829, 3205.1636, -537.3877, -247.08113, -2595.7524, -3104.6602, 386.3432, -4770.4214, 3930.573, -2688.7903, 4960.7925, -900.15784, -9147.872, 1665.423, 5432.4697, -5854.609, 2407.4702, 5525.277, 536.19354, 2728.8499, -6703.7295, 3711.2449, 3893.2224, -5317.8115, 4151.4253, 1900.0957, 92.107025, -5461.5396, -1815.4722, 4162.6274, -1833.7844, 2640.8872, 3600.4412, 19.827223, -2381.1355, 2974.8706, -2339.7349, 4866.6836, -3147.9988, -4056.9463, -10899.699, 4384.9517, -3793.7244, -664.8502, -96.55907, -2093.0847, -6468.789, 3831.0498, 3121.6924, 1586.3768, -3365.8918, -5637.5273, -3683.3853, -411.68314, -3367.0068, -7835.9087, 5728.7437, -3296.7656, -4105.271, 1085.1085, 3448.5435, 8442.902, 4269.3936, 1838.7533, -8196.278, -171.68896, -6219.4517, -5457.491, 5688.89, -3369.9517, -1455.8344, -326.836, 9130.274, 1598.6309, 1031.6237, 6422.851, 1413.3041, -1069.9868, -1269.5247, -8538.274, 3968.708, -2470.9219, 5729.873, 5412.9077, 6563.1484, 7386.0664, -6598.059, 6328.9146, -1099.0859, -4597.1055, 4319.2764, 1665.8854, -2852.4841, -3259.996, 1229.4713, 161.60597, 5213.2114, 1664.4896, -5899.351, 4109.684, -5890.793, -2650.9956, -2694.5435, 6774.2686, -468.23846, -5522.2446, -24.762115, -7105.581, 1329.6812, -3866.3157, 3489.3145, 742.3161, 268.1999, -623.50433, -794.11505, 636.75977, 5398.7246, 2363.9102, -3028.7646, -4069.912, -8671.82, 1671.6322, 5369.409, -4358.366, -3464.48, 3605.553, 5526.45, 3778.381, -184.64833, 7639.731, -1668.1296, 703.06665, 516.80945, 2395.433, -5594.8896, -6157.6714, -7192.919, -1418.3722, 1817.2158, -3378.9407, 3033.243, 3836.2156, -2160.681, -2653.5525, 1877.9144, 1965.0204, 3889.7305, 3379.2368, -45.566883, -3492.1545, 2358.9595, -2203.7363, -1583.1958, 783.47516, 4130.501, -1448.8306, 2777.5813, -6456.027, 2253.7827, 8524.43, 887.9351, 4183.626, 2539.337, -5067.984, -1339.5293, 5352.907, 2038.6705, 6723.3667, -4472.7397, -8856.021, 5176.9824, 2812.7432, 80.79987, -550.9253, -1933.4945, -2530.971, 1783.6144, 316.7579, 2099.5186, 2963.4514, 561.9944, 2481.433, 4439.606, -114.34347, -3435.6826, -641.48505, 130.9366, 7264.569, -858.8913, -2749.1733, -2329.0684, -3474.2627, -554.30884, -8646.007, 672.80884, -7697.25, 1190.4498, 2106.1318, 7083.882, 2648.5857, -3051.9348, 3631.6548, 892.21356, -664.1439, 2124.3105, 2579.4482, 2660.2197, -5027.2256, 2647.0715, 7679.774, -1494.8324, -4496.7676, -8846.221, 8086.653, 2956.515, -1162.4484, 10981.402, 2161.8174, -7530.787, 5817.37, 1263.8566, 2640.0427, -2908.3704, -4261.6104, 3810.9644, -1689.8456, -8236.235, -989.63794, 5204.052, 6814.396, 935.00195, 6016.2603, -2726.9495, 2760.3691, 3597.3154, -3788.8562, -6861.2217, -4741.012, -1038.8462, 5532.049, 1589.3804, -4625.4585, -707.48804, 5904.9717, -2065.4207, -1471.9625, 5379.091, 1522.7781, 3551.5725, 404.38953, 836.56445, -3160.2815, 3208.33, -1248.9469, -1404.9641, -2361.2048, 3570.5928, -8713.095, 1480.3162, -3800.8997, 2467.8833, 676.96094, 952.4947, -1450.9943, -5264.083, 2584.828, -2490.4026, 790.1742, 2697.7117, -3009.1665, 3041.6335, 133.93636, 2475.1567, 2802.9827, -1021.61, 5739.8057, 151.45448, 2979.5063, 1526.1344, 5601.5005, -6737.0493, 1547.9937, 2963.5703, -436.55975, 4594.198, -2589.2063, -914.6124, -2826.6033, -6051.7295, -5035.1226, 1808.7483, -7976.4507, 3234.128, -141.6139, -2772.1008, -1331.3744, 8246.5625, 1337.2445, -1454.5587, -7216.1807, 196.98647, 3029.5195, 7753.5293, -8644.141, 3236.7864, 5911.214, -4388.0293, -7720.7524, 1266.4432, -4914.226, 1157.2162, -634.7421, -4208.8877, 6590.3833, 1770.907, -658.8863, -6154.5483, -1776.3309, -2465.875, -102.91776, -7500.837, 2534.938, 2815.6245, -370.0155, 10010.6455, -5232.14, -1473.2695, 7634.166, -1479.5256, -5651.368, -4627.7964, -1756.2351, 8128.063, -4994.6978, 3538.5952, 4318.694, -4908.4556, -6064.026, 2695.3315, 3526.3938, 5329.827, 5992.8516, 401.05902, -1257.679, 2246.4038, 4235.5444, 6935.4155, 1999.6191, -934.67535, 1619.2345, 977.20514, -9111.422, 1725.3824, 2618.1216, -2052.6428, 1360.3301, -5738.947, -4142.043, 2705.197, -3171.255, 4677.47, 1189.864, -5438.6035, 377.78778, -2539.516, -2905.3206, 1294.9509, 2761.0676, 1092.4696, 5577.568, 87.894165, -561.5319, 1193.4979, -9124.665, 5244.485, 8980.767, 2800.0989, -442.50046, -267.61865, -2718.3503, 4025.6792, 782.0375, 4928.25, -951.135, 365.93307, -407.3514, -2406.2334, -3086.326, 3578.3914, 4760.879, 1069.2179, 2091.8032, -1109.5355, 6993.9307, 1985.8762, -11270.076, 6421.2915, -414.65652, 9475.935, -105.521355, 3725.9934, -287.99084, -5659.509, -3031.7231, 755.6546, -2887.9749, 3439.0876, 3388.3076, -624.33295, 2179.094, -9225.649, 5898.5044, -4762.101, 487.39597, -2835.943, 2292.3518, -83.07222, -2601.5173, 220.45647, -338.13507, -3090.8389, 3058.1865, -2057.404, -1023.0167, -15.265018, -7780.03, 5973.5024, 3173.747, -3111.19, -4421.5493, -4286.746, 1456.6383, -3201.5781, -6622.4355, 2918.4226, 4147.343, 4444.2544, -778.04846, -3187.5107, 1179.8927, 7003.652, -369.77686, -6330.3257, -6445.1655, -8232.543, 2986.339, 13351.6455, -7762.2383, -1487.8727, 565.86127, 1967.1903, 7281.512, 968.2869, -4735.25, -6474.244, 161.95525, -2593.836, -1163.6017, 395.48352, -3908.3196, -2555.7793, -2311.4502, 6222.7427, -515.62775, -1767.009, 4691.3384, 2945.6577, -2832.1594, -1378.0721, -4956.967, -2968.3135, -6946.678, 1380.7324, -3933.215, 5284.7314, 8140.6333, -1269.9799, 5966.8506, 633.8033, -5958.278, 2677.6418, -1446.8468, 552.10034, -2810.7202, -2731.6177, -2055.4758, 1920.9366, 1251.0009, 1244.308, -189.14386, -5105.757, -1584.9547, -2096.7002, 740.56305, 4232.793, 5236.9272, 3529.2197, -4441.5674, -592.5019, -712.3603, -5796.1274, -2372.2263, -2665.8015, 4435.2007, 4057.1494, 1574.7126, -7037.909, 3855.475, -235.16528, -3234.628, -1229.6804, 788.68317, -758.2057, -5006.4814, -616.54083, 5696.236, -3958.9417, 1177.2941, -5498.9136, 4451.078, 465.5698, -7059.083, 6396.8945, 8611.645, 1991.0115, -3585.3523, 691.6528, 4005.8171, -4679.0957, -4430.328, -1297.0532, -5869.177, -686.62036, -502.25482, 3130.9778, 5338.057, -5824.0273, 10766.1, 1906.2192, -11190.031, 15725.663, -603.7316, -822.6088, 5039.4497, 928.76013, 3305.376, 416.2032, -3635.1301, 2223.0652, 6130.2383, 542.0234, 9325.709, -1715.227, -5784.4785, -941.8927, 7385.7485, 6817.1, 4986.76, -2297.274, -536.96893, 2216.9297, -4990.2095, 1210.9094, -7257.717, -4227.0474, 4697.8667, 771.207, -6312.1396, 262.47852, 4772.4546, 3426.5417, 7076.0967, -5519.088, 6815.247, -3036.1067, -4599.0615, -132.37247, 120.27354, 576.05725, -6832.0215, 1888.3279, -4585.8696, 2296.9355, 1630.8489, -2711.7356, 2526.7144, 6116.474, -4046.5146, 6356.892, 2727.4268, -1661.1715, -4299.053, 3302.5427, 2471.9155, -5056.305, -6063.0625, -3125.7686, -476.0668, 2464.4436, 3211.3745, 3594.8918, 1769.7186, -3183.9204, -1014.0802, -2933.983, 3923.7874, 4351.4375, 664.9805, -3142.313, -579.3439, 1275.6946, 6920.106, 801.45905, -2029.5798, -8938.748, -1107.7484, -6680.169, -1413.1758, -1992.7261, 4955.279, 4528.4336, 3357.6558, -7708.772, 531.77234, -2999.151, -5658.606, 4263.3354, -805.82935, 5309.5005, 8215.845, -1653.947, -1349.6937, -4117.1167, 990.7465, -3376.5535, -4782.1953, 1257.757, 1021.74176, 5011.3276, 910.3436, 2823.4534, -5399.3945, 5947.0454, 2166.991, -1645.919, -2161.2236, -1401.039, -4825.8623, -2835.5308, -4083.5525, 6169.157, -7225.1646, -2262.3596, 594.57886, -2389.8945, 10201.486, -719.84924, 1439.37, -3481.5417, -894.7905, 2258.1016, -405.75943, -4107.334, -1439.4105, -3593.9658, 8604.245, -6479.096, -5164.7515, 3929.7048, -318.36014, -3170.6035, -972.2931, -392.44925, 6297.3457, 2179.2534, -5540.218, -750.3109, 2689.4468, -479.13138, 1168.6871, 3441.0652, -941.59753, -3136.5361, -169.34029, -9910.883, -3340.9, 6668.976, -4340.915, 5119.0034, 3059.518, 3473.4014, 1009.4979, -7320.1377, -4069.403, 106.28792, -2469.865, -3570.3662, -550.49554, 3376.4775, -2072.8057, -3122.6616, -5118.7056, 8992.205, 8879.209, 3682.6345, 372.9829, -7870.9795, 532.2266, -7190.2075, -3496.4104, -777.313, -4354.6636, -6960.96, 2143.1782, 4632.813, 2431.8613, -7051.9014, 8357.752, -2073.841, 294.95798, 4325.034, -7475.619, 3129.2764, -1541.8575, 6303.474, 3859.0867, -3343.1636, -1165.4884, -146.54755, 1605.83, 3298.1975, -3905.7073, -639.79584, 2510.1995, 3781.6406, 292.07904, 2569.215, -2968.9194, -1434.9785, -1684.2849, 5055.709, -3279.0767, 166.01106, 307.72028, -1189.0815, -384.5326, -9047.073, -3139.3706, -371.7547, 3651.7634, 5087.796, 643.72064, -3802.1157, 7008.7896, -8120.5864, 1900.208, 3108.3423, 1592.1671, 7009.705, 1603.2097, 30.188114, 921.4484, 86.369736, -3291.3013, 73.881454, -1843.5974, -746.86163, -1846.0471, 3789.1123, 1223.761, 1574.0198, 6281.29, -3721.0803, -806.5796, -3511.2585, -256.4548, -559.7159, -2131.0059, -1078.399, 2828.8223, 698.69543, 1239.1886, 2080.1206, 5072.486, 1147.8536, -3497.928, -2286.1082, 8332.354, 822.13245, -5633.7383, 47.347725, -5115.9575, 4419.517, 6883.114, -6027.914, -1697.1465, -6654.7197, -929.5703, 2266.9438, 6528.47, -4142.4272, 2382.887, -6695.6714, 3495.077, 3403.0615, -5837.2017, -9403.099, 2293.8762, 1945.012, 7881.3823, -1732.7108, -8950.444, 842.23505, 2958.3452, 951.32654, 493.89545, -3307.589, -862.2705, 7591.2744, 846.4778, 10000.595, 2739.0005, -314.15613, -1908.6256, -477.31784, -1618.1477, 1514.7937, -75.379196, -2583.7761, 2999.2397, -5.8855247, -2357.7507, -158.8623, -2352.2334, -3093.0063, 256.41504, -2925.1763, -3586.2751, -1162.248, -3317.6636, 9867.859, 11217.71, -4078.576, 4371.4224, -8403.835, -2752.0159, 217.04695, -1245.636, -78.285965, -3554.92, -4381.5317, 2725.7632, 4756.273, -382.7493, -2122.531, 7516.6367, -5216.0146, 5890.862, 3333.7837, 247.75162, -3155.8438, 7242.259, 472.51132, -774.536, 3914.8955, -3509.6917, -439.07666, 1945.8142, 3483.3462, -3464.5679, 1438.8951, -2953.7273, 1359.4592, 534.6447, 4105.455, 3860.929, 2019.4624, -2406.3035, -3388.2834, 3414.6863, -4140.3564, 7057.346, -5687.8438, 1644.1227, -2225.751, -69.28252, -6509.276, -606.48676, 2052.3096, 7669.94, -2134.78, 2694.268, -4140.2754, -4922.289, 531.1548, 1729.2958, 354.9286, -5334.71, -7296.818, 2744.381, -6292.147, -156.3943, 2869.6387, -6194.527, 2399.424, -875.7592, -5911.341, -1369.2573, 1425.6204, -3377.5784, 2263.625, -3615.0303, -1275.7465, -3595.5825, 7195.8555, 715.8564, 1253.8448, -2425.3982, -6328.24, 1718.9061, 3625.5808, -4238.5615, 3298.7917, -7591.164, 2982.8555, 3992.5095, -428.58038, 19.975088, 5051.1997, -4077.7046, -2513.302, -3007.3032, -2215.0671, -4835.591, 743.35425, 6222.869, 4529.7617, 1582.374, -3680.6306, 7212.932, -3115.1533, -4729.0376, 726.0273, -2378.408, -649.669, -5791.247, -7678.0835, 5808.967, -208.05618, 2216.6956, -2697.023, 10854.277, 101.87515, 330.43695, -2345.0278, -4294.2056, 6192.975, -2983.033, 5313.2383, 867.1612, -5881.5913, -4383.5903, 5322.001, -4098.0605, 1619.5797, 691.3182, 3056.9326, 3559.9436, 2338.2905, -590.8077, 826.1102, -1787.618, -3016.3804, -6485.3857, -2478.3777, -2765.6912, 3958.095, -334.97107, 5393.0376, 523.69055, -7089.55, 4483.902, 511.02805, 6925.9575, 1236.0509, 222.40436, -2580.2634, -448.28564, -4399.041, 1830.7115, -5023.8726, -11459.683, 758.71405, -1529.845, 1858.4447, 5404.6025, 3647.3342, 1356.967, -2379.6445, 3705.8708, 5078.3184, 1569.3307, -4343.6055, -2203.8196, 1230.0303, -6364.2393, 5675.6245, -2004.2421, 389.08737, -956.77985, 2504.0266, 3463.0745, 7542.3203, -3206.9368, 1706.884, 351.1781, 46.1449, -2547.0876, -3307.4282, 8224.657, -5545.565, -766.09143, -661.4047, 3807.923, 35.64429, -2978.8606, -1953.441, -4249.9233, 312.10712, -2750.266, 4244.402, 5675.441, 4292.2593, 6095.8774, -5454.1772, 1913.1093, 430.40833, -3171.8784, 2768.6848, -1923.0654, -5186.259, -6049.806, -2556.7678, 12384.3955, -1557.3102, -7557.801, -315.9837, 3202.1946, -5391.421, 2871.8499, -8233.163, -1516.9818, 6608.448, -322.91968, 6539.5938, -3482.604, 1884.079, 2744.493, -1562.1841, -2776.3315, 7193.2563, 3808.9617, -3334.9678, -3766.8926, 6329.793, 530.16364, 5212.5103, 5285.313, -372.16995, -591.68604, -2212.1135, -4754.6294, 1322.9518, -1077.6896, -5371.0767, -4838.2856, 3096.5427, -4744.73, -4508.9727, 1599.5276, -521.7574, 4058.286, -2111.383, 6066.46, 3648.5115, -680.6509, 6553.6704, -4692.5625, -4151.0967, -3812.5442, 3406.6453, 4096.8457, -1940.8372, -2635.9717, 4563.859, 1839.7332, -8079.352, -3397.4504, -4568.2686, 3764.9275, 3611.4968, -660.49384, -967.1918, -1696.7434, 1852.5996, 1207.2772, 1409.2664, 4138.327, 610.3885, -5297.0083, 1892.2772, 3226.0002, -2439.973, 1199.1962, 1786.6223, 2336.274, 2988.149, 732.49133, -1487.0149, 1181.082, 3193.7964, 1104.6029, -3847.2075, -4386.483, 2028.9197, 1827.7407, 3594.9473, 6024.9043, -9078.522, -2292.518, 5848.751, 2078.2515, -2680.2917, -5204.657, -3964.817, -26.681225, 5872.872, -2773.3767, 2014.8254, 687.72986, -3775.741, -5487.1577, 568.2755, -2563.2651, 4482.9185, 2621.1309, -1716.135, -7863.1465, 3540.013, 4475.8833, 5264.414, 243.21071, -6353.901, -1475.6809, 4930.8184, 2755.2263, 874.55896, -2123.3313, -4647.8076, 1409.0244, 5288.997, -212.81552, 2200.623, -5742.414, 990.6997, 3542.6428, 3759.1877, -379.08896, 2906.5396, -2236.248, -720.86926, 1635.102, -5148.6694, -1515.4839, 182.90121, 1775.3839, 2411.0942, 1236.0815, 470.13544, 2161.5547, -3164.9297, -7837.4116, -1255.0249, 6534.063, 4990.9507, -4066.3997, 2779.4255, -3191.3076, 6255.782, 2837.1755, -9124.471, 1884.2477, -1772.6528, -1485.2357, 8465.312, 1460.717, -7267.3833, 3770.552, -726.098, 2824.8257, -923.4841, -413.83554, -2532.0583, 1856.1488, 3114.2651, -1912.598, 3556.7644, 1167.4813, 2951.889, 1290.71, -4702.7656, -401.2, -3201.4634, 3538.937, 4814.096, -3929.6592, 430.30118, -1338.1364, 571.24603, -1634.7727, -3246.1633, -3766.533, 1335.5122, 383.16553, -3870.0454, 173.93893, -2828.2544, 1681.1388, 739.8762, -1263.9845, 4999.781, 3310.584, -5765.4077, 2454.4087, 416.74478, -3356.3066, 1784.6107, -1794.8517, 1140.2859, -790.8438, 4145.2363, -3038.1047, 3948.497, 5416.8916, -4053.4229, 957.45245, 3814.8354, -1801.9088, 1538.2098, -100.39138, -6182.6826, 3610.4277, 2243.4067 });
    Tensor *actual = NN_zeros(4, (size_t[]){ 1, 16, 16, 6 }, DTYPE_F32);
    cycles = READ_CSR("mcycle");
    NN_Conv2d(actual, x, w, b, (size_t[]){1, 1}, (size_t[]){1, 1}, (size_t[]){1, 1}, 1);
    cycles = READ_CSR("mcycle") - cycles;
    printf("%s  (%lu cycles)\n", compareTensor(golden, actual, 1e-3) ? "PASS" : "FAIL", cycles);


    NN_deleteTensor(x);
    NN_deleteTensor(w);
    NN_deleteTensor(b);
    NN_deleteTensor(golden);
    NN_freeTensorData(actual);
    NN_deleteTensor(actual);
  }

}